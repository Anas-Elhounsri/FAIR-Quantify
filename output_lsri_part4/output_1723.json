{
  "code_repository": [
    {
      "confidence": 1,
      "result": {
        "type": "Url",
        "value": "https://github.com/alek0991/iSAFE"
      },
      "technique": "GitHub_API"
    }
  ],
  "date_created": [
    {
      "confidence": 1,
      "result": {
        "type": "Date",
        "value": "2017-03-29T01:59:35Z"
      },
      "technique": "GitHub_API"
    }
  ],
  "date_updated": [
    {
      "confidence": 1,
      "result": {
        "type": "Date",
        "value": "2024-05-05T05:04:14Z"
      },
      "technique": "GitHub_API"
    }
  ],
  "description": [
    {
      "confidence": 1,
      "result": {
        "type": "String",
        "value": "Pinpoints the mutation favored by selection"
      },
      "technique": "GitHub_API"
    },
    {
      "confidence": 0.984290001574362,
      "result": {
        "original_header": "iSAFE: **i**ntegrated **S**election of **A**llele **F**avored by **E**volution",
        "type": "Text_excerpt",
        "value": "Most approaches that capture signatures of selective sweeps in population genomics data do not identify the specific mutation favored by selection. The iSAFE enables researchers to accurately pinpoint the favored mutation in a large region (\u223c5 Mbp) by using a statistic derived solely from population genetics signals. iSAFE does not require knowledge of demography, the phenotype under selection, or functional annotations of mutations. \n- Akbari, Ali, Joseph J. Vitti, Arya Iranmehr, Mehrdad Bakhtiari, Pardis C. Sabeti, Siavash Mirarab, and Vineet Bafna. \"Identifying the favored mutation in a positive selective sweep.\" [Nature Methods (2018)](https://doi.org/10.1038/nmeth.4606).\n- Contact: Ali Akbari (Ali_Akbari@hms.harvard.edu). If I can be of assistance, please do not hesitate to contact me. \n"
      },
      "source": "https://raw.githubusercontent.com/alek0991/iSAFE/master/ReadMe.md",
      "technique": "supervised_classification"
    },
    {
      "confidence": 0.893541397658468,
      "result": {
        "original_header": "Output:",
        "type": "Text_excerpt",
        "value": "The output is a non-negative iSAFE-score for each mutation, according to its \nlikelihood of being the favored variant of the selective sweep. \nResult (```<output>.iSAFE.out```) is a TAB separated file in the following format. \n   - POS: Position (bp) sorted in ascending order\n   - iSAFE: Non-negative iSAFE score\n   - DAF: Derived allele frequency\n \n"
      },
      "source": "https://raw.githubusercontent.com/alek0991/iSAFE/master/ReadMe.md",
      "technique": "supervised_classification"
    }
  ],
  "download_url": [
    {
      "confidence": 1,
      "result": {
        "type": "Url",
        "value": "https://github.com/alek0991/iSAFE/releases"
      },
      "technique": "GitHub_API"
    }
  ],
  "faq": [
    {
      "confidence": 1,
      "result": {
        "original_header": "FAQ \u2013 frequently asked questions",
        "type": "Text_excerpt",
        "value": "Please read the [FAQ](https://github.com/alek0991/iSAFE/blob/master/FAQ.md) for answers to the most common queries.\n"
      },
      "source": "https://raw.githubusercontent.com/alek0991/iSAFE/master/ReadMe.md",
      "technique": "header_analysis"
    }
  ],
  "forks_count": [
    {
      "confidence": 1,
      "result": {
        "type": "Number",
        "value": 11
      },
      "technique": "GitHub_API"
    }
  ],
  "forks_url": [
    {
      "confidence": 1,
      "result": {
        "type": "Url",
        "value": "https://api.github.com/repos/alek0991/iSAFE/forks"
      },
      "technique": "GitHub_API"
    }
  ],
  "full_name": [
    {
      "confidence": 1,
      "result": {
        "type": "String",
        "value": "alek0991/iSAFE"
      },
      "technique": "GitHub_API"
    }
  ],
  "full_title": [
    {
      "confidence": 1,
      "result": {
        "type": "String",
        "value": "iSAFE: integrated Selection of Allele Favored by Evolution"
      },
      "source": "https://raw.githubusercontent.com/alek0991/iSAFE/master/ReadMe.md",
      "technique": "regular_expression"
    }
  ],
  "installation": [
    {
      "confidence": 1,
      "result": {
        "original_header": "Conda Installation (recommended)",
        "type": "Text_excerpt",
        "value": "**On 64-bit Linux and Mac OSX**, you can install iSAFE from [bioconda channel](https://bioconda.github.io/user/install.html) using conda package manager. iSAFE v1.1.0 and later is compatible with both python 2 and python 3.\n1. Install [Miniconda](https://bioconda.github.io/user/install.html) (you can skip this if you already have either of Miniconda or Anaconda installed). \n2. Add the bioconda channel by running the following commands in your terminal (order matters):\n```sh\n    conda config --add channels defaults\n    conda config --add channels bioconda\n    conda config --add channels conda-forge\n```\n3. Run the following command to install iSAFE (and all dependencies) \n```sh\n    conda install isafe\n```\n"
      },
      "source": "https://raw.githubusercontent.com/alek0991/iSAFE/master/ReadMe.md",
      "technique": "header_analysis"
    },
    {
      "confidence": 1,
      "result": {
        "original_header": "Manual installation: Software requirements",
        "type": "Text_excerpt",
        "value": "**Alternatively, and for all other OS and architectures**, you can download the github repository and install isafe using the setup script. \n\n1. Following python packages are required:\n    -   ```numpy``` version 1.9 or above \n    -   ```pandas``` version 0.18 or above\n2. Install ```bcftools``` version 1.2 or above (only for ```--format vcf```, not required if you are using ```--format hap```).\n    - Follow the [bcftools installation guideline](http://www.htslib.org/download/).\n    - iSAFE assumes the bcftools binary file is installed to a bin subdirectory that is added \n     to your ```$PATH```; otherwise, you have to change the following \n     [line](https://github.com/alek0991/iSAFE/blob/cc8d6f3c9fcdfe0625ed5aff93c0e940d9418e45/isafe/bcftools.py#L11) in ```./isafe/bcftools.py``` to the bcftools binary file path: \n    ```python\n    bcf_tools = \"bcftools\"\n    ``` \n\n3. Clone the github repository by running (or you can download the repo)\n```sh\n    git clone https://github.com/alek0991/iSAFE.git\n```\n4. Change to the iSAFE directory and run the pip installation\n```sh\n    cd iSAFE\n    pip install .\n```\n"
      },
      "source": "https://raw.githubusercontent.com/alek0991/iSAFE/master/ReadMe.md",
      "technique": "header_analysis"
    },
    {
      "confidence": 0.9999956301550535,
      "result": {
        "original_header": "Execution:",
        "type": "Text_excerpt",
        "value": "Use the following command to see all the available options in iSAFE.\n \n```sh\nisafe --help\n```\nThese detailed instructions are also provided in [./help.txt](https://github.com/alek0991/iSAFE/blob/master/help.txt). \n"
      },
      "source": "https://raw.githubusercontent.com/alek0991/iSAFE/master/ReadMe.md",
      "technique": "supervised_classification"
    },
    {
      "confidence": 0.9119492153200411,
      "result": {
        "original_header": "Output:",
        "type": "Text_excerpt",
        "value": "With following headers: \n"
      },
      "source": "https://raw.githubusercontent.com/alek0991/iSAFE/master/ReadMe.md",
      "technique": "supervised_classification"
    }
  ],
  "issue_tracker": [
    {
      "confidence": 1,
      "result": {
        "type": "Url",
        "value": "https://api.github.com/repos/alek0991/iSAFE/issues"
      },
      "technique": "GitHub_API"
    }
  ],
  "keywords": [
    {
      "confidence": 1,
      "result": {
        "type": "String",
        "value": "evolution, favored-mutation, natural-selection, pinpoint, population-genetics, selective-sweeps"
      },
      "technique": "GitHub_API"
    }
  ],
  "license": [
    {
      "confidence": 1,
      "result": {
        "name": "BSD 3-Clause \"New\" or \"Revised\" License",
        "spdx_id": "BSD-3-Clause",
        "type": "License",
        "url": "https://api.github.com/licenses/bsd-3-clause",
        "value": "https://api.github.com/licenses/bsd-3-clause"
      },
      "technique": "GitHub_API"
    }
  ],
  "name": [
    {
      "confidence": 1,
      "result": {
        "type": "String",
        "value": "iSAFE"
      },
      "technique": "GitHub_API"
    }
  ],
  "owner": [
    {
      "confidence": 1,
      "result": {
        "type": "User",
        "value": "alek0991"
      },
      "technique": "GitHub_API"
    }
  ],
  "programming_languages": [
    {
      "confidence": 1,
      "result": {
        "name": "Python",
        "size": 83964,
        "type": "Programming_language",
        "value": "Python"
      },
      "technique": "GitHub_API"
    }
  ],
  "readme_url": [
    {
      "confidence": 1,
      "result": {
        "type": "Url",
        "value": "https://raw.githubusercontent.com/alek0991/iSAFE/master/ReadMe.md"
      },
      "technique": "file_exploration"
    }
  ],
  "releases": [
    {
      "confidence": 1,
      "result": {
        "author": {
          "name": "alek0991",
          "type": "User"
        },
        "date_created": "2021-11-02T18:45:32Z",
        "date_published": "2021-11-02T18:47:20Z",
        "description": "- remove pysam as requirement\r\n\r\nsha256:\r\n`554eb180c6f099b10de2bc16bf9cc10d24db22b530f92dc4ebd07d521a0c0cf7`",
        "html_url": "https://github.com/alek0991/iSAFE/releases/tag/v1.1.1",
        "name": "v1.1.1",
        "release_id": 52544643,
        "tag": "v1.1.1",
        "tarball_url": "https://api.github.com/repos/alek0991/iSAFE/tarball/v1.1.1",
        "type": "Release",
        "url": "https://api.github.com/repos/alek0991/iSAFE/releases/52544643",
        "value": "https://api.github.com/repos/alek0991/iSAFE/releases/52544643",
        "zipball_url": "https://api.github.com/repos/alek0991/iSAFE/zipball/v1.1.1"
      },
      "technique": "GitHub_API"
    },
    {
      "confidence": 1,
      "result": {
        "author": {
          "name": "alek0991",
          "type": "User"
        },
        "date_created": "2021-10-29T02:12:22Z",
        "date_published": "2021-10-29T02:43:40Z",
        "description": "- Made compatible with both python 2 and 3\r\n- Added Conda installation with all dependecies\r\n- Command changed from ```python ./src/isafe.py [Options]``` to ```isafe [Options]```",
        "html_url": "https://github.com/alek0991/iSAFE/releases/tag/v1.1.0",
        "name": "v1.1.0",
        "release_id": 52284668,
        "tag": "v1.1.0",
        "tarball_url": "https://api.github.com/repos/alek0991/iSAFE/tarball/v1.1.0",
        "type": "Release",
        "url": "https://api.github.com/repos/alek0991/iSAFE/releases/52284668",
        "value": "https://api.github.com/repos/alek0991/iSAFE/releases/52284668",
        "zipball_url": "https://api.github.com/repos/alek0991/iSAFE/zipball/v1.1.0"
      },
      "technique": "GitHub_API"
    },
    {
      "confidence": 1,
      "result": {
        "author": {
          "name": "alek0991",
          "type": "User"
        },
        "date_created": "2021-04-07T07:56:50Z",
        "date_published": "2021-04-07T07:58:58Z",
        "description": "- Fix bug for reading indexed BCF files\r\n- Raise error in create_rolling_indices() in isafeclass.py when total number of variants is smaller than --window\r\n- Raise error when  --window is smaller than --MinRegionSize-ps\r\n- Raise error when  --window is smaller than --step\r\n- Print version (-v, --version)",
        "html_url": "https://github.com/alek0991/iSAFE/releases/tag/v1.0.7",
        "name": "v1.0.7",
        "release_id": 41041708,
        "tag": "v1.0.7",
        "tarball_url": "https://api.github.com/repos/alek0991/iSAFE/tarball/v1.0.7",
        "type": "Release",
        "url": "https://api.github.com/repos/alek0991/iSAFE/releases/41041708",
        "value": "https://api.github.com/repos/alek0991/iSAFE/releases/41041708",
        "zipball_url": "https://api.github.com/repos/alek0991/iSAFE/zipball/v1.0.7"
      },
      "technique": "GitHub_API"
    },
    {
      "confidence": 1,
      "result": {
        "author": {
          "name": "alek0991",
          "type": "User"
        },
        "date_created": "2020-06-25T01:19:58Z",
        "date_published": "2020-06-25T01:27:03Z",
        "description": "Fixed bug with numerical sample names",
        "html_url": "https://github.com/alek0991/iSAFE/releases/tag/v1.0.6",
        "name": "v1.0.6",
        "release_id": 27897676,
        "tag": "v1.0.6",
        "tarball_url": "https://api.github.com/repos/alek0991/iSAFE/tarball/v1.0.6",
        "type": "Release",
        "url": "https://api.github.com/repos/alek0991/iSAFE/releases/27897676",
        "value": "https://api.github.com/repos/alek0991/iSAFE/releases/27897676",
        "zipball_url": "https://api.github.com/repos/alek0991/iSAFE/zipball/v1.0.6"
      },
      "technique": "GitHub_API"
    },
    {
      "confidence": 1,
      "result": {
        "author": {
          "name": "alek0991",
          "type": "User"
        },
        "date_created": "2020-03-28T01:02:26Z",
        "date_published": "2020-03-28T01:18:31Z",
        "description": "If the ancestral allele file (--AA) is not available the program raises a warning and assumes reference allele (REF) is ancestral allele.",
        "html_url": "https://github.com/alek0991/iSAFE/releases/tag/v1.0.5",
        "name": "v1.0.5",
        "release_id": 24953347,
        "tag": "v1.0.5",
        "tarball_url": "https://api.github.com/repos/alek0991/iSAFE/tarball/v1.0.5",
        "type": "Release",
        "url": "https://api.github.com/repos/alek0991/iSAFE/releases/24953347",
        "value": "https://api.github.com/repos/alek0991/iSAFE/releases/24953347",
        "zipball_url": "https://api.github.com/repos/alek0991/iSAFE/zipball/v1.0.5"
      },
      "technique": "GitHub_API"
    },
    {
      "confidence": 1,
      "result": {
        "author": {
          "name": "alek0991",
          "type": "User"
        },
        "date_created": "2018-12-03T04:08:09Z",
        "date_published": "2018-12-03T04:10:36Z",
        "description": "Raise error for inconsistent ploidy, non-biallelic, and empty region.",
        "html_url": "https://github.com/alek0991/iSAFE/releases/tag/v1.0.4",
        "name": "v1.0.4",
        "release_id": 14306689,
        "tag": "v1.0.4",
        "tarball_url": "https://api.github.com/repos/alek0991/iSAFE/tarball/v1.0.4",
        "type": "Release",
        "url": "https://api.github.com/repos/alek0991/iSAFE/releases/14306689",
        "value": "https://api.github.com/repos/alek0991/iSAFE/releases/14306689",
        "zipball_url": "https://api.github.com/repos/alek0991/iSAFE/zipball/v1.0.4"
      },
      "technique": "GitHub_API"
    },
    {
      "confidence": 1,
      "result": {
        "author": {
          "name": "alek0991",
          "type": "User"
        },
        "date_created": "2018-05-01T02:41:15Z",
        "date_published": "2018-05-01T02:43:35Z",
        "description": "Handling male (haploid) samples for chromosome X.",
        "html_url": "https://github.com/alek0991/iSAFE/releases/tag/v1.0.3",
        "name": "v1.0.3",
        "release_id": 10791988,
        "tag": "v1.0.3",
        "tarball_url": "https://api.github.com/repos/alek0991/iSAFE/tarball/v1.0.3",
        "type": "Release",
        "url": "https://api.github.com/repos/alek0991/iSAFE/releases/10791988",
        "value": "https://api.github.com/repos/alek0991/iSAFE/releases/10791988",
        "zipball_url": "https://api.github.com/repos/alek0991/iSAFE/zipball/v1.0.3"
      },
      "technique": "GitHub_API"
    },
    {
      "confidence": 1,
      "result": {
        "author": {
          "name": "alek0991",
          "type": "User"
        },
        "date_created": "2018-04-30T02:57:34Z",
        "date_published": "2018-04-30T02:59:25Z",
        "description": "Track execution progress and fixing minor bugs.",
        "html_url": "https://github.com/alek0991/iSAFE/releases/tag/v1.0.2",
        "name": "v1.0.2",
        "release_id": 10776411,
        "tag": "v1.0.2",
        "tarball_url": "https://api.github.com/repos/alek0991/iSAFE/tarball/v1.0.2",
        "type": "Release",
        "url": "https://api.github.com/repos/alek0991/iSAFE/releases/10776411",
        "value": "https://api.github.com/repos/alek0991/iSAFE/releases/10776411",
        "zipball_url": "https://api.github.com/repos/alek0991/iSAFE/zipball/v1.0.2"
      },
      "technique": "GitHub_API"
    },
    {
      "confidence": 1,
      "result": {
        "author": {
          "name": "alek0991",
          "type": "User"
        },
        "date_created": "2018-04-13T01:00:33Z",
        "date_published": "2018-04-13T01:02:39Z",
        "description": "Keeps not SNPs (indels, MNPs, and etc) as long as they have only one ALT (binary alleles).",
        "html_url": "https://github.com/alek0991/iSAFE/releases/tag/v1.0.1",
        "name": "v1.0.1",
        "release_id": 10527181,
        "tag": "v1.0.1",
        "tarball_url": "https://api.github.com/repos/alek0991/iSAFE/tarball/v1.0.1",
        "type": "Release",
        "url": "https://api.github.com/repos/alek0991/iSAFE/releases/10527181",
        "value": "https://api.github.com/repos/alek0991/iSAFE/releases/10527181",
        "zipball_url": "https://api.github.com/repos/alek0991/iSAFE/zipball/v1.0.1"
      },
      "technique": "GitHub_API"
    },
    {
      "confidence": 1,
      "result": {
        "author": {
          "name": "alek0991",
          "type": "User"
        },
        "date_created": "2018-01-25T01:46:30Z",
        "date_published": "2018-01-25T01:55:00Z",
        "html_url": "https://github.com/alek0991/iSAFE/releases/tag/v1.0",
        "release_id": 9377954,
        "tag": "v1.0",
        "tarball_url": "https://api.github.com/repos/alek0991/iSAFE/tarball/v1.0",
        "type": "Release",
        "url": "https://api.github.com/repos/alek0991/iSAFE/releases/9377954",
        "value": "https://api.github.com/repos/alek0991/iSAFE/releases/9377954",
        "zipball_url": "https://api.github.com/repos/alek0991/iSAFE/zipball/v1.0"
      },
      "technique": "GitHub_API"
    }
  ],
  "requirements": [
    {
      "confidence": 1,
      "result": {
        "original_header": "Manual installation: Software requirements",
        "type": "Text_excerpt",
        "value": "**Alternatively, and for all other OS and architectures**, you can download the github repository and install isafe using the setup script. \n\n1. Following python packages are required:\n    -   ```numpy``` version 1.9 or above \n    -   ```pandas``` version 0.18 or above\n2. Install ```bcftools``` version 1.2 or above (only for ```--format vcf```, not required if you are using ```--format hap```).\n    - Follow the [bcftools installation guideline](http://www.htslib.org/download/).\n    - iSAFE assumes the bcftools binary file is installed to a bin subdirectory that is added \n     to your ```$PATH```; otherwise, you have to change the following \n     [line](https://github.com/alek0991/iSAFE/blob/cc8d6f3c9fcdfe0625ed5aff93c0e940d9418e45/isafe/bcftools.py#L11) in ```./isafe/bcftools.py``` to the bcftools binary file path: \n    ```python\n    bcf_tools = \"bcftools\"\n    ``` \n\n3. Clone the github repository by running (or you can download the repo)\n```sh\n    git clone https://github.com/alek0991/iSAFE.git\n```\n4. Change to the iSAFE directory and run the pip installation\n```sh\n    cd iSAFE\n    pip install .\n```\n"
      },
      "source": "https://raw.githubusercontent.com/alek0991/iSAFE/master/ReadMe.md",
      "technique": "header_analysis"
    }
  ],
  "somef_missing_categories": [
    "citation",
    "acknowledgement",
    "run",
    "download",
    "contact",
    "contributors",
    "documentation",
    "support",
    "identifier",
    "has_build_file",
    "executable_example"
  ],
  "somef_provenance": {
    "date": "2024-11-04 08:05:20",
    "somef_schema_version": "1.0.0",
    "somef_version": "0.9.5"
  },
  "stargazers_count": [
    {
      "confidence": 1,
      "result": {
        "type": "Number",
        "value": 32
      },
      "technique": "GitHub_API"
    }
  ],
  "usage": [
    {
      "confidence": 1,
      "result": {
        "original_header": "Demo 1: input in <a href=\"https://github.com/alek0991/iSAFE/blob/master/hap_format.md\">hap</a> format",
        "type": "Text_excerpt",
        "value": "With ```--format hap```, iSAFE assumes that derived allele is 1 and ancestral allele is 0 in the input file, and the selection is ongoing (the favored mutation is not fixed).\n```sh\nisafe --input ./example/hap/demo.hap --output ./example/hap/demo --format hap\n```\n* 5Mbp region simulated by [msms](http://www.mabs.at/ewing/msms/index.shtml).\n* Position of the favored mutation is 2,500,000.\n"
      },
      "source": "https://raw.githubusercontent.com/alek0991/iSAFE/master/ReadMe.md",
      "technique": "header_analysis"
    },
    {
      "confidence": 1,
      "result": {
        "original_header": "Demo 2: input in <a href=\"https://samtools.github.io/hts-specs/VCFv4.2.pdf\">vcf</a> format",
        "type": "Text_excerpt",
        "value": "Follow the instructions in the [Data Requirements section](https://github.com/alek0991/iSAFE#data-requirements) and download Homo-Sapiens Ancestral Allele files and phased vcf files of Chromosome 2 of 1000GP populations (GRCh37/hg19), and replace the text in each ```< >``` with the proper file path.\n\n\n<h4>Scenario 1: All samples</h4> \n\nAll the samples of the ```--input``` vcf file as the case population:\n- The following command apply iSAFE on 5Mbp region around LCT/MCM6 locus in all 2504 samples (5008 haplotypes) of 1000GP as the case population.\n    \n```sh\nisafe --input <chr2 vcf file> --output ./example/vcf/LCT --region 2:134108646-139108646 --AA <chr2 Ancestral Allele file>\n```\n\n<h4>Scenario 2: A subset of samples</h4>\n \nA subset of samples (```--sample-case```) of the ```--input``` vcf file as the case population:\n- The following command apply iSAFE on 5Mbp region around LCT/MCM6 locus in FIN population of 1000GP as the case population.\n\n```sh\nisafe --input <chr2 vcf file> --output ./example/vcf/LCT --region 2:134108646-139108646 --AA <chr2 Ancestral Allele file> --sample-case ./example/vcf/case.sample\n```\n\n<h4>Scenario 3: Adding outgroup samples</h4>\n \n A subset of samples (```--sample-case```) of the ```--input``` vcf file as the case population and a subset of samples (```--sample-cont```) of the ```--vcf-cont``` vcf file as the control population:\n- The following command apply iSAFE on 5Mbp region around LCT/MCM6 locus in FIN population of 1000GP as the case population and YRI, CHB, PEL, and GIH as the control populations.\n\n```sh\nisafe --input <chr2 vcf file> --output ./example/vcf/LCT --region 2:134108646-139108646 --AA <chr2 Ancestral Allele file> --vcf-cont <chr2 vcf file> --sample-case ./example/vcf/case.sample --sample-cont ./example/vcf/cont.sample\n```\n\n* ```--input``` and ```--vcf-cont``` can point to the same vcf file or different ones. In case they are the same, ```--sampe-case``` and ```--sample-cont``` are mandatory.\n* Position of the [putative favored mutation in the FIN population](http://www.nature.com/ng/journal/v30/n2/full/ng826.html) for the selective sweep around LCT/MCM6 locus is 136,608,646 (GRCh37/hg19) of chromosome 2.\n"
      },
      "source": "https://raw.githubusercontent.com/alek0991/iSAFE/master/ReadMe.md",
      "technique": "header_analysis"
    },
    {
      "confidence": 1,
      "result": {
        "original_header": "Scenario 1: All samples",
        "parent_header": [
          "Demo 2: input in <a href=\"https://samtools.github.io/hts-specs/VCFv4.2.pdf\">vcf</a> format"
        ],
        "type": "Text_excerpt",
        "value": "==========\n[![release](https://img.shields.io/github/v/release/alek0991/iSAFE)](ChangeLog.md)\n[![Anaconda-Server Badge](https://anaconda.org/bioconda/isafe/badges/version.svg)](https://anaconda.org/bioconda/isafe)\n[![Anaconda-Server Badge](https://anaconda.org/bioconda/isafe/badges/downloads.svg)](https://anaconda.org/bioconda/isafe)\n[![Anaconda-Server Badge](https://anaconda.org/bioconda/isafe/badges/latest_release_date.svg)](https://anaconda.org/bioconda/isafe)\n\nMost approaches that capture signatures of selective sweeps in population genomics data do not identify the specific mutation favored by selection. The iSAFE enables researchers to accurately pinpoint the favored mutation in a large region (\u223c5 Mbp) by using a statistic derived solely from population genetics signals. iSAFE does not require knowledge of demography, the phenotype under selection, or functional annotations of mutations. \n- Akbari, Ali, Joseph J. Vitti, Arya Iranmehr, Mehrdad Bakhtiari, Pardis C. Sabeti, Siavash Mirarab, and Vineet Bafna. \"Identifying the favored mutation in a positive selective sweep.\" [Nature Methods (2018)](https://doi.org/10.1038/nmeth.4606).\n- Contact: Ali Akbari (Ali_Akbari@hms.harvard.edu). If I can be of assistance, please do not hesitate to contact me.\n\n\nFAQ \u2013 frequently asked questions\n==========\nPlease read the [FAQ](https://github.com/alek0991/iSAFE/blob/master/FAQ.md) for answers to the most common queries.\n\nConda Installation (recommended)\n==========\n**On 64-bit Linux and Mac OSX**, you can install iSAFE from [bioconda channel](https://bioconda.github.io/user/install.html) using conda package manager. iSAFE v1.1.0 and later is compatible with both python 2 and python 3.\n1. Install [Miniconda](https://bioconda.github.io/user/install.html) (you can skip this if you already have either of Miniconda or Anaconda installed). \n2. Add the bioconda channel by running the following commands in your terminal (order matters):\n```sh\n    conda config --add channels defaults\n    conda config --add channels bioconda\n    conda config --add channels conda-forge\n```\n3. Run the following command to install iSAFE (and all dependencies) \n```sh\n    conda install isafe\n```\n\nManual installation: Software requirements\n==========   \n\n**Alternatively, and for all other OS and architectures**, you can download the github repository and install isafe using the setup script. \n\n1. Following python packages are required:\n    -   ```numpy``` version 1.9 or above \n    -   ```pandas``` version 0.18 or above\n2. Install ```bcftools``` version 1.2 or above (only for ```--format vcf```, not required if you are using ```--format hap```).\n    - Follow the [bcftools installation guideline](http://www.htslib.org/download/).\n    - iSAFE assumes the bcftools binary file is installed to a bin subdirectory that is added \n     to your ```$PATH```; otherwise, you have to change the following \n     [line](https://github.com/alek0991/iSAFE/blob/cc8d6f3c9fcdfe0625ed5aff93c0e940d9418e45/isafe/bcftools.py#L11) in ```./isafe/bcftools.py``` to the bcftools binary file path: \n    ```python\n    bcf_tools = \"bcftools\"\n    ``` \n\n3. Clone the github repository by running (or you can download the repo)\n```sh\n    git clone https://github.com/alek0991/iSAFE.git\n```\n4. Change to the iSAFE directory and run the pip installation\n```sh\n    cd iSAFE\n    pip install .\n```\n\nExecution:\n===========\n\nUse the following command to see all the available options in iSAFE.\n \n```sh\nisafe --help\n```\nThese detailed instructions are also provided in [./help.txt](https://github.com/alek0991/iSAFE/blob/master/help.txt).\n\n**Note:** If you have a script for iSAFE<v1.1.0 and want to update to the latest version you should change the commands from \n```sh\npython ./src/isafe.py [Options]\n```\nto\n```sh\nisafe [Options]\n```\n\nInput:\n==========\nConsider a sample of phased haplotypes in a genomic region. We assume that all \nsites are biallelic and  polymorphic in the sample. \nThus, our input is in the form of a binary \nSNP matrix with each column corresponding to a haplotype and each row to a \nmutation, and entries corresponding to the allelic state, with 0 denoting the\nancestral allele, and 1 denoting the derived allele. Not surprisingly, iSAFE performance deteriorated when the favored mutation is fixed or near fixation (favored allele frequency (\u03bd) > 0.9 in [Supplementary Fig. 3e](https://www.nature.com/articles/nmeth.4606/figures/6)). To handle this special case, we included individuals from non-target populations, using a specific protocol (See online [Methods](https://www.nature.com/articles/nmeth.4606#methods), section *Adding outgroup samples*). iSAFE can take input in [hap](https://github.com/alek0991/iSAFE/blob/master/hap_format.md) or [vcf](https://samtools.github.io/hts-specs/VCFv4.2.pdf) formats.\n* [hap](https://github.com/alek0991/iSAFE/blob/master/hap_format.md) format: ```--format hap``` or ```-f hap```. With hap format, iSAFE assumes:\n    - Derived allele is 1 and ancestral allele is 0 in the input file.\n    - The selection is ongoing (the favored mutation is not fixed). In the current implementation of iSAFE with ```--format hap```, user is required to add outgroup samples to the input hap file if needed, based on this simple protocol mentioned above.\n    - Consequently, input with hap format is not allowed with any of these: ```--vcf-cont```, ```--sample-case```, ```--sample-cont```, ```--AA```.\n* [vcf](https://samtools.github.io/hts-specs/VCFv4.2.pdf) format (Default): ```--format vcf``` or ```-f vcf```\n    - Only phased vcf files are accepted.\n    - In v1.0.1 or above it keeps not SNPs (indels, MNPs, and etc) as long as they have only one ALT (binary alleles).\n    - vcf format only accepts indexed bgzipped VCF (vcf.gz with index file) or indexed bcf files (.bcf with index file).\n    - The Ancestral Allele file (```--AA```) must be provided with ```--format vcf```. From version 1.0.5, if the ancestral allele file (--AA) is not available the program raises a warning and assumes reference allele (REF) is ancestral allele.\n    - You can choose a subset of samples in the input vcf file by using ```--sample-case```. Otherwise all the samples in the input vcf file are considered as the case samples. See [sample ID file format](https://github.com/alek0991/iSAFE/blob/master/sample_ID_format.md).\n    - ```--vcf-cont``` is optional but recommended for capturing fixed sweeps. You can choose a subset of samples in this file by using ```--sample-cont``` option, otherwise all the samples in this file are cosidered as control population. See [sample ID file format](https://github.com/alek0991/iSAFE/blob/master/sample_ID_format.md).  \n    - You must use ```--sample-case``` and ```--sample-cont``` when the ```--input``` and ```--vcf-cont``` are the same (all samples are provided in a single vcf file).\n\n**Note:** The software in vcf mode is more flexible and has more options. But if you don't have out-group samples (```--vcf-cont``` is not set), and hap file and vcf file contain the _exact_ same information (iSAFE only cares about position, haplotype phase, derived allele (1), and ancestral allele (0) in the vcf mode), then the output of iSAFE must be identical.\n\nOutput:\n==========\nThe output is a non-negative iSAFE-score for each mutation, according to its \nlikelihood of being the favored variant of the selective sweep. \nResult (```<output>.iSAFE.out```) is a TAB separated file in the following format.\n\n| POS | iSAFE | DAF |\n|:----------:|:---------:|:---------:|\n| 291 |    0.02    |    0.05    |\n| 626 |    0.01    |    0.55    |\n| ... |    ...    |    ...    |\n\nWith following headers:\n\n   - POS: Position (bp) sorted in ascending order\n   - iSAFE: Non-negative iSAFE score\n   - DAF: Derived allele frequency\n\nData availability for vcf format\n==========\n*  Download Homo-Sapiens Ancestral Allele files in case you are using ```--format vcf``` and consequently ```--AA```:\n    - Download links: \n        - [GRCh37/hg19](http://ftp.ensembl.org/pub/release-75/fasta/ancestral_alleles/)\n        - [GRCh38/hg38](http://ftp.ensemblorg.ebi.ac.uk/pub/release-88/fasta/ancestral_alleles/)\n    - You need to unzip the files.\n* The 1000 Genome Project phased vcf files can be used as ```--input``` or ```--vcf-cont```:\n    - Download links: \n        - [GRCh37/hg19](http://ftp.1000genomes.ebi.ac.uk/vol1/ftp/release/20130502/)\n        - [GRCh38/hg38](http://ftp.1000genomes.ebi.ac.uk/vol1/ftp/release/20130502/supporting/GRCh38_positions/)\n    - You can use your own data and you don't have to use 1000GP data as ```--input``` (case) or ```--vcf-cont``` (control).\n    - Only accepts indexed bgzipped VCF (vcf.gz with index file) or indexed bcf files (.bcf with index file) for faster pre-processing\n    - The index file is also required by bcftools.\n\n\nDemo 1: input in [hap](https://github.com/alek0991/iSAFE/blob/master/hap_format.md) format\n===========\nWith ```--format hap```, iSAFE assumes that derived allele is 1 and ancestral allele is 0 in the input file, and the selection is ongoing (the favored mutation is not fixed).\n```sh\nisafe --input ./example/hap/demo.hap --output ./example/hap/demo --format hap\n```\n* 5Mbp region simulated by [msms](http://www.mabs.at/ewing/msms/index.shtml).\n* Position of the favored mutation is 2,500,000.\n\nDemo 2: input in [vcf](https://samtools.github.io/hts-specs/VCFv4.2.pdf) format\n===========\nFollow the instructions in the [Data Requirements section](https://github.com/alek0991/iSAFE#data-requirements) and download Homo-Sapiens Ancestral Allele files and phased vcf files of Chromosome 2 of 1000GP populations (GRCh37/hg19), and replace the text in each ```< >``` with the proper file path.\n\n\n<h4>Scenario 1: All samples</h4> \n\nAll the samples of the ```--input``` vcf file as the case population:\n- The following command apply iSAFE on 5Mbp region around LCT/MCM6 locus in all 2504 samples (5008 haplotypes) of 1000GP as the case population.\n    \n```sh\nisafe --input <chr2 vcf file> --output ./example/vcf/LCT --region 2:134108646-139108646 --AA <chr2 Ancestral Allele file>\n```\n\n<h4>Scenario 2: A subset of samples</h4>\n \nA subset of samples (```--sample-case```) of the ```--input``` vcf file as the case population:\n- The following command apply iSAFE on 5Mbp region around LCT/MCM6 locus in FIN population of 1000GP as the case population.\n\n```sh\nisafe --input <chr2 vcf file> --output ./example/vcf/LCT --region 2:134108646-139108646 --AA <chr2 Ancestral Allele file> --sample-case ./example/vcf/case.sample\n```\n\n<h4>Scenario 3: Adding outgroup samples</h4>\n \n A subset of samples (```--sample-case```) of the ```--input``` vcf file as the case population and a subset of samples (```--sample-cont```) of the ```--vcf-cont``` vcf file as the control population:\n- The following command apply iSAFE on 5Mbp region around LCT/MCM6 locus in FIN population of 1000GP as the case population and YRI, CHB, PEL, and GIH as the control populations.\n\n```sh\nisafe --input <chr2 vcf file> --output ./example/vcf/LCT --region 2:134108646-139108646 --AA <chr2 Ancestral Allele file> --vcf-cont <chr2 vcf file> --sample-case ./example/vcf/case.sample --sample-cont ./example/vcf/cont.sample\n```\n\n* ```--input``` and ```--vcf-cont``` can point to the same vcf file or different ones. In case they are the same, ```--sampe-case``` and ```--sample-cont``` are mandatory.\n* Position of the [putative favored mutation in the FIN population](http://www.nature.com/ng/journal/v30/n2/full/ng826.html) for the selective sweep around LCT/MCM6 locus is 136,608,646 (GRCh37/hg19) of chromosome 2.\n"
      },
      "source": "https://raw.githubusercontent.com/alek0991/iSAFE/master/ReadMe.md",
      "technique": "header_analysis"
    },
    {
      "confidence": 1,
      "result": {
        "original_header": "Scenario 2: A subset of samples",
        "parent_header": [
          "Demo 2: input in <a href=\"https://samtools.github.io/hts-specs/VCFv4.2.pdf\">vcf</a> format"
        ],
        "type": "Text_excerpt",
        "value": "==========\n[![release](https://img.shields.io/github/v/release/alek0991/iSAFE)](ChangeLog.md)\n[![Anaconda-Server Badge](https://anaconda.org/bioconda/isafe/badges/version.svg)](https://anaconda.org/bioconda/isafe)\n[![Anaconda-Server Badge](https://anaconda.org/bioconda/isafe/badges/downloads.svg)](https://anaconda.org/bioconda/isafe)\n[![Anaconda-Server Badge](https://anaconda.org/bioconda/isafe/badges/latest_release_date.svg)](https://anaconda.org/bioconda/isafe)\n\nMost approaches that capture signatures of selective sweeps in population genomics data do not identify the specific mutation favored by selection. The iSAFE enables researchers to accurately pinpoint the favored mutation in a large region (\u223c5 Mbp) by using a statistic derived solely from population genetics signals. iSAFE does not require knowledge of demography, the phenotype under selection, or functional annotations of mutations. \n- Akbari, Ali, Joseph J. Vitti, Arya Iranmehr, Mehrdad Bakhtiari, Pardis C. Sabeti, Siavash Mirarab, and Vineet Bafna. \"Identifying the favored mutation in a positive selective sweep.\" [Nature Methods (2018)](https://doi.org/10.1038/nmeth.4606).\n- Contact: Ali Akbari (Ali_Akbari@hms.harvard.edu). If I can be of assistance, please do not hesitate to contact me.\n\n\nFAQ \u2013 frequently asked questions\n==========\nPlease read the [FAQ](https://github.com/alek0991/iSAFE/blob/master/FAQ.md) for answers to the most common queries.\n\nConda Installation (recommended)\n==========\n**On 64-bit Linux and Mac OSX**, you can install iSAFE from [bioconda channel](https://bioconda.github.io/user/install.html) using conda package manager. iSAFE v1.1.0 and later is compatible with both python 2 and python 3.\n1. Install [Miniconda](https://bioconda.github.io/user/install.html) (you can skip this if you already have either of Miniconda or Anaconda installed). \n2. Add the bioconda channel by running the following commands in your terminal (order matters):\n```sh\n    conda config --add channels defaults\n    conda config --add channels bioconda\n    conda config --add channels conda-forge\n```\n3. Run the following command to install iSAFE (and all dependencies) \n```sh\n    conda install isafe\n```\n\nManual installation: Software requirements\n==========   \n\n**Alternatively, and for all other OS and architectures**, you can download the github repository and install isafe using the setup script. \n\n1. Following python packages are required:\n    -   ```numpy``` version 1.9 or above \n    -   ```pandas``` version 0.18 or above\n2. Install ```bcftools``` version 1.2 or above (only for ```--format vcf```, not required if you are using ```--format hap```).\n    - Follow the [bcftools installation guideline](http://www.htslib.org/download/).\n    - iSAFE assumes the bcftools binary file is installed to a bin subdirectory that is added \n     to your ```$PATH```; otherwise, you have to change the following \n     [line](https://github.com/alek0991/iSAFE/blob/cc8d6f3c9fcdfe0625ed5aff93c0e940d9418e45/isafe/bcftools.py#L11) in ```./isafe/bcftools.py``` to the bcftools binary file path: \n    ```python\n    bcf_tools = \"bcftools\"\n    ``` \n\n3. Clone the github repository by running (or you can download the repo)\n```sh\n    git clone https://github.com/alek0991/iSAFE.git\n```\n4. Change to the iSAFE directory and run the pip installation\n```sh\n    cd iSAFE\n    pip install .\n```\n\nExecution:\n===========\n\nUse the following command to see all the available options in iSAFE.\n \n```sh\nisafe --help\n```\nThese detailed instructions are also provided in [./help.txt](https://github.com/alek0991/iSAFE/blob/master/help.txt).\n\n**Note:** If you have a script for iSAFE<v1.1.0 and want to update to the latest version you should change the commands from \n```sh\npython ./src/isafe.py [Options]\n```\nto\n```sh\nisafe [Options]\n```\n\nInput:\n==========\nConsider a sample of phased haplotypes in a genomic region. We assume that all \nsites are biallelic and  polymorphic in the sample. \nThus, our input is in the form of a binary \nSNP matrix with each column corresponding to a haplotype and each row to a \nmutation, and entries corresponding to the allelic state, with 0 denoting the\nancestral allele, and 1 denoting the derived allele. Not surprisingly, iSAFE performance deteriorated when the favored mutation is fixed or near fixation (favored allele frequency (\u03bd) > 0.9 in [Supplementary Fig. 3e](https://www.nature.com/articles/nmeth.4606/figures/6)). To handle this special case, we included individuals from non-target populations, using a specific protocol (See online [Methods](https://www.nature.com/articles/nmeth.4606#methods), section *Adding outgroup samples*). iSAFE can take input in [hap](https://github.com/alek0991/iSAFE/blob/master/hap_format.md) or [vcf](https://samtools.github.io/hts-specs/VCFv4.2.pdf) formats.\n* [hap](https://github.com/alek0991/iSAFE/blob/master/hap_format.md) format: ```--format hap``` or ```-f hap```. With hap format, iSAFE assumes:\n    - Derived allele is 1 and ancestral allele is 0 in the input file.\n    - The selection is ongoing (the favored mutation is not fixed). In the current implementation of iSAFE with ```--format hap```, user is required to add outgroup samples to the input hap file if needed, based on this simple protocol mentioned above.\n    - Consequently, input with hap format is not allowed with any of these: ```--vcf-cont```, ```--sample-case```, ```--sample-cont```, ```--AA```.\n* [vcf](https://samtools.github.io/hts-specs/VCFv4.2.pdf) format (Default): ```--format vcf``` or ```-f vcf```\n    - Only phased vcf files are accepted.\n    - In v1.0.1 or above it keeps not SNPs (indels, MNPs, and etc) as long as they have only one ALT (binary alleles).\n    - vcf format only accepts indexed bgzipped VCF (vcf.gz with index file) or indexed bcf files (.bcf with index file).\n    - The Ancestral Allele file (```--AA```) must be provided with ```--format vcf```. From version 1.0.5, if the ancestral allele file (--AA) is not available the program raises a warning and assumes reference allele (REF) is ancestral allele.\n    - You can choose a subset of samples in the input vcf file by using ```--sample-case```. Otherwise all the samples in the input vcf file are considered as the case samples. See [sample ID file format](https://github.com/alek0991/iSAFE/blob/master/sample_ID_format.md).\n    - ```--vcf-cont``` is optional but recommended for capturing fixed sweeps. You can choose a subset of samples in this file by using ```--sample-cont``` option, otherwise all the samples in this file are cosidered as control population. See [sample ID file format](https://github.com/alek0991/iSAFE/blob/master/sample_ID_format.md).  \n    - You must use ```--sample-case``` and ```--sample-cont``` when the ```--input``` and ```--vcf-cont``` are the same (all samples are provided in a single vcf file).\n\n**Note:** The software in vcf mode is more flexible and has more options. But if you don't have out-group samples (```--vcf-cont``` is not set), and hap file and vcf file contain the _exact_ same information (iSAFE only cares about position, haplotype phase, derived allele (1), and ancestral allele (0) in the vcf mode), then the output of iSAFE must be identical.\n\nOutput:\n==========\nThe output is a non-negative iSAFE-score for each mutation, according to its \nlikelihood of being the favored variant of the selective sweep. \nResult (```<output>.iSAFE.out```) is a TAB separated file in the following format.\n\n| POS | iSAFE | DAF |\n|:----------:|:---------:|:---------:|\n| 291 |    0.02    |    0.05    |\n| 626 |    0.01    |    0.55    |\n| ... |    ...    |    ...    |\n\nWith following headers:\n\n   - POS: Position (bp) sorted in ascending order\n   - iSAFE: Non-negative iSAFE score\n   - DAF: Derived allele frequency\n\nData availability for vcf format\n==========\n*  Download Homo-Sapiens Ancestral Allele files in case you are using ```--format vcf``` and consequently ```--AA```:\n    - Download links: \n        - [GRCh37/hg19](http://ftp.ensembl.org/pub/release-75/fasta/ancestral_alleles/)\n        - [GRCh38/hg38](http://ftp.ensemblorg.ebi.ac.uk/pub/release-88/fasta/ancestral_alleles/)\n    - You need to unzip the files.\n* The 1000 Genome Project phased vcf files can be used as ```--input``` or ```--vcf-cont```:\n    - Download links: \n        - [GRCh37/hg19](http://ftp.1000genomes.ebi.ac.uk/vol1/ftp/release/20130502/)\n        - [GRCh38/hg38](http://ftp.1000genomes.ebi.ac.uk/vol1/ftp/release/20130502/supporting/GRCh38_positions/)\n    - You can use your own data and you don't have to use 1000GP data as ```--input``` (case) or ```--vcf-cont``` (control).\n    - Only accepts indexed bgzipped VCF (vcf.gz with index file) or indexed bcf files (.bcf with index file) for faster pre-processing\n    - The index file is also required by bcftools.\n\n\nDemo 1: input in [hap](https://github.com/alek0991/iSAFE/blob/master/hap_format.md) format\n===========\nWith ```--format hap```, iSAFE assumes that derived allele is 1 and ancestral allele is 0 in the input file, and the selection is ongoing (the favored mutation is not fixed).\n```sh\nisafe --input ./example/hap/demo.hap --output ./example/hap/demo --format hap\n```\n* 5Mbp region simulated by [msms](http://www.mabs.at/ewing/msms/index.shtml).\n* Position of the favored mutation is 2,500,000.\n\nDemo 2: input in [vcf](https://samtools.github.io/hts-specs/VCFv4.2.pdf) format\n===========\nFollow the instructions in the [Data Requirements section](https://github.com/alek0991/iSAFE#data-requirements) and download Homo-Sapiens Ancestral Allele files and phased vcf files of Chromosome 2 of 1000GP populations (GRCh37/hg19), and replace the text in each ```< >``` with the proper file path.\n\n\n<h4>Scenario 1: All samples</h4> \n\nAll the samples of the ```--input``` vcf file as the case population:\n- The following command apply iSAFE on 5Mbp region around LCT/MCM6 locus in all 2504 samples (5008 haplotypes) of 1000GP as the case population.\n    \n```sh\nisafe --input <chr2 vcf file> --output ./example/vcf/LCT --region 2:134108646-139108646 --AA <chr2 Ancestral Allele file>\n```\n\n<h4>Scenario 2: A subset of samples</h4>\n \nA subset of samples (```--sample-case```) of the ```--input``` vcf file as the case population:\n- The following command apply iSAFE on 5Mbp region around LCT/MCM6 locus in FIN population of 1000GP as the case population.\n\n```sh\nisafe --input <chr2 vcf file> --output ./example/vcf/LCT --region 2:134108646-139108646 --AA <chr2 Ancestral Allele file> --sample-case ./example/vcf/case.sample\n```\n\n<h4>Scenario 3: Adding outgroup samples</h4>\n \n A subset of samples (```--sample-case```) of the ```--input``` vcf file as the case population and a subset of samples (```--sample-cont```) of the ```--vcf-cont``` vcf file as the control population:\n- The following command apply iSAFE on 5Mbp region around LCT/MCM6 locus in FIN population of 1000GP as the case population and YRI, CHB, PEL, and GIH as the control populations.\n\n```sh\nisafe --input <chr2 vcf file> --output ./example/vcf/LCT --region 2:134108646-139108646 --AA <chr2 Ancestral Allele file> --vcf-cont <chr2 vcf file> --sample-case ./example/vcf/case.sample --sample-cont ./example/vcf/cont.sample\n```\n\n* ```--input``` and ```--vcf-cont``` can point to the same vcf file or different ones. In case they are the same, ```--sampe-case``` and ```--sample-cont``` are mandatory.\n* Position of the [putative favored mutation in the FIN population](http://www.nature.com/ng/journal/v30/n2/full/ng826.html) for the selective sweep around LCT/MCM6 locus is 136,608,646 (GRCh37/hg19) of chromosome 2.\n"
      },
      "source": "https://raw.githubusercontent.com/alek0991/iSAFE/master/ReadMe.md",
      "technique": "header_analysis"
    },
    {
      "confidence": 1,
      "result": {
        "original_header": "Scenario 3: Adding outgroup samples",
        "parent_header": [
          "Demo 2: input in <a href=\"https://samtools.github.io/hts-specs/VCFv4.2.pdf\">vcf</a> format"
        ],
        "type": "Text_excerpt",
        "value": "==========\n[![release](https://img.shields.io/github/v/release/alek0991/iSAFE)](ChangeLog.md)\n[![Anaconda-Server Badge](https://anaconda.org/bioconda/isafe/badges/version.svg)](https://anaconda.org/bioconda/isafe)\n[![Anaconda-Server Badge](https://anaconda.org/bioconda/isafe/badges/downloads.svg)](https://anaconda.org/bioconda/isafe)\n[![Anaconda-Server Badge](https://anaconda.org/bioconda/isafe/badges/latest_release_date.svg)](https://anaconda.org/bioconda/isafe)\n\nMost approaches that capture signatures of selective sweeps in population genomics data do not identify the specific mutation favored by selection. The iSAFE enables researchers to accurately pinpoint the favored mutation in a large region (\u223c5 Mbp) by using a statistic derived solely from population genetics signals. iSAFE does not require knowledge of demography, the phenotype under selection, or functional annotations of mutations. \n- Akbari, Ali, Joseph J. Vitti, Arya Iranmehr, Mehrdad Bakhtiari, Pardis C. Sabeti, Siavash Mirarab, and Vineet Bafna. \"Identifying the favored mutation in a positive selective sweep.\" [Nature Methods (2018)](https://doi.org/10.1038/nmeth.4606).\n- Contact: Ali Akbari (Ali_Akbari@hms.harvard.edu). If I can be of assistance, please do not hesitate to contact me.\n\n\nFAQ \u2013 frequently asked questions\n==========\nPlease read the [FAQ](https://github.com/alek0991/iSAFE/blob/master/FAQ.md) for answers to the most common queries.\n\nConda Installation (recommended)\n==========\n**On 64-bit Linux and Mac OSX**, you can install iSAFE from [bioconda channel](https://bioconda.github.io/user/install.html) using conda package manager. iSAFE v1.1.0 and later is compatible with both python 2 and python 3.\n1. Install [Miniconda](https://bioconda.github.io/user/install.html) (you can skip this if you already have either of Miniconda or Anaconda installed). \n2. Add the bioconda channel by running the following commands in your terminal (order matters):\n```sh\n    conda config --add channels defaults\n    conda config --add channels bioconda\n    conda config --add channels conda-forge\n```\n3. Run the following command to install iSAFE (and all dependencies) \n```sh\n    conda install isafe\n```\n\nManual installation: Software requirements\n==========   \n\n**Alternatively, and for all other OS and architectures**, you can download the github repository and install isafe using the setup script. \n\n1. Following python packages are required:\n    -   ```numpy``` version 1.9 or above \n    -   ```pandas``` version 0.18 or above\n2. Install ```bcftools``` version 1.2 or above (only for ```--format vcf```, not required if you are using ```--format hap```).\n    - Follow the [bcftools installation guideline](http://www.htslib.org/download/).\n    - iSAFE assumes the bcftools binary file is installed to a bin subdirectory that is added \n     to your ```$PATH```; otherwise, you have to change the following \n     [line](https://github.com/alek0991/iSAFE/blob/cc8d6f3c9fcdfe0625ed5aff93c0e940d9418e45/isafe/bcftools.py#L11) in ```./isafe/bcftools.py``` to the bcftools binary file path: \n    ```python\n    bcf_tools = \"bcftools\"\n    ``` \n\n3. Clone the github repository by running (or you can download the repo)\n```sh\n    git clone https://github.com/alek0991/iSAFE.git\n```\n4. Change to the iSAFE directory and run the pip installation\n```sh\n    cd iSAFE\n    pip install .\n```\n\nExecution:\n===========\n\nUse the following command to see all the available options in iSAFE.\n \n```sh\nisafe --help\n```\nThese detailed instructions are also provided in [./help.txt](https://github.com/alek0991/iSAFE/blob/master/help.txt).\n\n**Note:** If you have a script for iSAFE<v1.1.0 and want to update to the latest version you should change the commands from \n```sh\npython ./src/isafe.py [Options]\n```\nto\n```sh\nisafe [Options]\n```\n\nInput:\n==========\nConsider a sample of phased haplotypes in a genomic region. We assume that all \nsites are biallelic and  polymorphic in the sample. \nThus, our input is in the form of a binary \nSNP matrix with each column corresponding to a haplotype and each row to a \nmutation, and entries corresponding to the allelic state, with 0 denoting the\nancestral allele, and 1 denoting the derived allele. Not surprisingly, iSAFE performance deteriorated when the favored mutation is fixed or near fixation (favored allele frequency (\u03bd) > 0.9 in [Supplementary Fig. 3e](https://www.nature.com/articles/nmeth.4606/figures/6)). To handle this special case, we included individuals from non-target populations, using a specific protocol (See online [Methods](https://www.nature.com/articles/nmeth.4606#methods), section *Adding outgroup samples*). iSAFE can take input in [hap](https://github.com/alek0991/iSAFE/blob/master/hap_format.md) or [vcf](https://samtools.github.io/hts-specs/VCFv4.2.pdf) formats.\n* [hap](https://github.com/alek0991/iSAFE/blob/master/hap_format.md) format: ```--format hap``` or ```-f hap```. With hap format, iSAFE assumes:\n    - Derived allele is 1 and ancestral allele is 0 in the input file.\n    - The selection is ongoing (the favored mutation is not fixed). In the current implementation of iSAFE with ```--format hap```, user is required to add outgroup samples to the input hap file if needed, based on this simple protocol mentioned above.\n    - Consequently, input with hap format is not allowed with any of these: ```--vcf-cont```, ```--sample-case```, ```--sample-cont```, ```--AA```.\n* [vcf](https://samtools.github.io/hts-specs/VCFv4.2.pdf) format (Default): ```--format vcf``` or ```-f vcf```\n    - Only phased vcf files are accepted.\n    - In v1.0.1 or above it keeps not SNPs (indels, MNPs, and etc) as long as they have only one ALT (binary alleles).\n    - vcf format only accepts indexed bgzipped VCF (vcf.gz with index file) or indexed bcf files (.bcf with index file).\n    - The Ancestral Allele file (```--AA```) must be provided with ```--format vcf```. From version 1.0.5, if the ancestral allele file (--AA) is not available the program raises a warning and assumes reference allele (REF) is ancestral allele.\n    - You can choose a subset of samples in the input vcf file by using ```--sample-case```. Otherwise all the samples in the input vcf file are considered as the case samples. See [sample ID file format](https://github.com/alek0991/iSAFE/blob/master/sample_ID_format.md).\n    - ```--vcf-cont``` is optional but recommended for capturing fixed sweeps. You can choose a subset of samples in this file by using ```--sample-cont``` option, otherwise all the samples in this file are cosidered as control population. See [sample ID file format](https://github.com/alek0991/iSAFE/blob/master/sample_ID_format.md).  \n    - You must use ```--sample-case``` and ```--sample-cont``` when the ```--input``` and ```--vcf-cont``` are the same (all samples are provided in a single vcf file).\n\n**Note:** The software in vcf mode is more flexible and has more options. But if you don't have out-group samples (```--vcf-cont``` is not set), and hap file and vcf file contain the _exact_ same information (iSAFE only cares about position, haplotype phase, derived allele (1), and ancestral allele (0) in the vcf mode), then the output of iSAFE must be identical.\n\nOutput:\n==========\nThe output is a non-negative iSAFE-score for each mutation, according to its \nlikelihood of being the favored variant of the selective sweep. \nResult (```<output>.iSAFE.out```) is a TAB separated file in the following format.\n\n| POS | iSAFE | DAF |\n|:----------:|:---------:|:---------:|\n| 291 |    0.02    |    0.05    |\n| 626 |    0.01    |    0.55    |\n| ... |    ...    |    ...    |\n\nWith following headers:\n\n   - POS: Position (bp) sorted in ascending order\n   - iSAFE: Non-negative iSAFE score\n   - DAF: Derived allele frequency\n\nData availability for vcf format\n==========\n*  Download Homo-Sapiens Ancestral Allele files in case you are using ```--format vcf``` and consequently ```--AA```:\n    - Download links: \n        - [GRCh37/hg19](http://ftp.ensembl.org/pub/release-75/fasta/ancestral_alleles/)\n        - [GRCh38/hg38](http://ftp.ensemblorg.ebi.ac.uk/pub/release-88/fasta/ancestral_alleles/)\n    - You need to unzip the files.\n* The 1000 Genome Project phased vcf files can be used as ```--input``` or ```--vcf-cont```:\n    - Download links: \n        - [GRCh37/hg19](http://ftp.1000genomes.ebi.ac.uk/vol1/ftp/release/20130502/)\n        - [GRCh38/hg38](http://ftp.1000genomes.ebi.ac.uk/vol1/ftp/release/20130502/supporting/GRCh38_positions/)\n    - You can use your own data and you don't have to use 1000GP data as ```--input``` (case) or ```--vcf-cont``` (control).\n    - Only accepts indexed bgzipped VCF (vcf.gz with index file) or indexed bcf files (.bcf with index file) for faster pre-processing\n    - The index file is also required by bcftools.\n\n\nDemo 1: input in [hap](https://github.com/alek0991/iSAFE/blob/master/hap_format.md) format\n===========\nWith ```--format hap```, iSAFE assumes that derived allele is 1 and ancestral allele is 0 in the input file, and the selection is ongoing (the favored mutation is not fixed).\n```sh\nisafe --input ./example/hap/demo.hap --output ./example/hap/demo --format hap\n```\n* 5Mbp region simulated by [msms](http://www.mabs.at/ewing/msms/index.shtml).\n* Position of the favored mutation is 2,500,000.\n\nDemo 2: input in [vcf](https://samtools.github.io/hts-specs/VCFv4.2.pdf) format\n===========\nFollow the instructions in the [Data Requirements section](https://github.com/alek0991/iSAFE#data-requirements) and download Homo-Sapiens Ancestral Allele files and phased vcf files of Chromosome 2 of 1000GP populations (GRCh37/hg19), and replace the text in each ```< >``` with the proper file path.\n\n\n<h4>Scenario 1: All samples</h4> \n\nAll the samples of the ```--input``` vcf file as the case population:\n- The following command apply iSAFE on 5Mbp region around LCT/MCM6 locus in all 2504 samples (5008 haplotypes) of 1000GP as the case population.\n    \n```sh\nisafe --input <chr2 vcf file> --output ./example/vcf/LCT --region 2:134108646-139108646 --AA <chr2 Ancestral Allele file>\n```\n\n<h4>Scenario 2: A subset of samples</h4>\n \nA subset of samples (```--sample-case```) of the ```--input``` vcf file as the case population:\n- The following command apply iSAFE on 5Mbp region around LCT/MCM6 locus in FIN population of 1000GP as the case population.\n\n```sh\nisafe --input <chr2 vcf file> --output ./example/vcf/LCT --region 2:134108646-139108646 --AA <chr2 Ancestral Allele file> --sample-case ./example/vcf/case.sample\n```\n\n<h4>Scenario 3: Adding outgroup samples</h4>\n \n A subset of samples (```--sample-case```) of the ```--input``` vcf file as the case population and a subset of samples (```--sample-cont```) of the ```--vcf-cont``` vcf file as the control population:\n- The following command apply iSAFE on 5Mbp region around LCT/MCM6 locus in FIN population of 1000GP as the case population and YRI, CHB, PEL, and GIH as the control populations.\n\n```sh\nisafe --input <chr2 vcf file> --output ./example/vcf/LCT --region 2:134108646-139108646 --AA <chr2 Ancestral Allele file> --vcf-cont <chr2 vcf file> --sample-case ./example/vcf/case.sample --sample-cont ./example/vcf/cont.sample\n```\n\n* ```--input``` and ```--vcf-cont``` can point to the same vcf file or different ones. In case they are the same, ```--sampe-case``` and ```--sample-cont``` are mandatory.\n* Position of the [putative favored mutation in the FIN population](http://www.nature.com/ng/journal/v30/n2/full/ng826.html) for the selective sweep around LCT/MCM6 locus is 136,608,646 (GRCh37/hg19) of chromosome 2.\n"
      },
      "source": "https://raw.githubusercontent.com/alek0991/iSAFE/master/ReadMe.md",
      "technique": "header_analysis"
    }
  ]
}