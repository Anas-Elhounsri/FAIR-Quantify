{
  "citation": [
    {
      "confidence": 1,
      "result": {
        "format": "bibtex",
        "type": "File_dump",
        "value": "citHeader(\"The best way to cite fastbaps in publications is to use:\")\n\ncitEntry(entry = \"Article\",\ntitle        = \"Fast hierarchical Bayesian analysis of population structure\",\nauthor       = personList(as.person(\"Gerry Tonkin-Hill\"),\n                 as.person(\"John A Lees\"),\n                 as.person(\"Stephen D Bentley\"),\n                 as.person(\"Simon D W Frost\"),\n                 as.person(\"Jukka Corander\")),\njournal      = \"Nucleic Acids Res.\",\nyear         = \"2019\",\npages        = \"1362--4962\",\nurl          = \"http://dx.doi.org/10.1093/nar/gkz361\",\n\ntextVersion  = \"Tonkin-Hill,G., Lees,J.A., Bentley,S.D., Frost,S.D.W. and Corander,J. (2019) Fast hierarchical Bayesian analysis of population structure. Nucleic Acids Res., 10.1093/nar/gkz361.\"\n)\n"
      },
      "source": "https://raw.githubusercontent.com/gtonkinhill/fastbaps/master/inst/CITATION",
      "technique": "file_exploration"
    },
    {
      "confidence": 1,
      "result": {
        "original_header": "Citation",
        "parent_header": [
          "fastbaps"
        ],
        "type": "Text_excerpt",
        "value": "To cite fastbaps please use\n\n> Tonkin-Hill,G., Lees,J.A., Bentley,S.D., Frost,S.D.W. and Corander,J.\n> (2019) Fast hierarchical Bayesian analysis of population structure.\n> Nucleic Acids Res., 10.1093/nar/gkz361.\n"
      },
      "source": "https://raw.githubusercontent.com/gtonkinhill/fastbaps/master/README.Rmd",
      "technique": "header_analysis"
    },
    {
      "confidence": 1,
      "result": {
        "original_header": "References",
        "parent_header": [
          "fastbaps"
        ],
        "type": "Text_excerpt",
        "value": "<div id=\"refs\" class=\"references csl-bib-body hanging-indent\">\n\n<div id=\"ref-Cheng2013-mp\" class=\"csl-entry\">\n\nCheng, Lu, Thomas R Connor, Jukka Sir\u00e9n, David M Aanensen, and Jukka\nCorander. 2013. \u201cHierarchical and Spatially Explicit Clustering of DNA\nSequences with BAPS Software.\u201d *Mol. Biol. Evol.* 30 (5): 1224\u201328.\n<https://doi.org/10.1093/molbev/mst028>.\n\n</div>\n\n<div id=\"ref-Heller2005-kp\" class=\"csl-entry\">\n\nHeller, Katherine A, and Zoubin Ghahramani. 2005. \u201cBayesian Hierarchical\nClustering.\u201d In *Proceedings of the 22Nd International Conference on\nMachine Learning*, 297\u2013304. ICML \u201905. New York, NY, USA: ACM.\n<https://doi.org/10.1145/1102351.1102389>.\n\n</div>\n\n<div id=\"ref-Kalyaanamoorthy2017-go\" class=\"csl-entry\">\n\nKalyaanamoorthy, Subha, Bui Quang Minh, Thomas K F Wong, Arndt von\nHaeseler, and Lars S Jermiin. 2017. \u201cModelFinder: Fast Model Selection\nfor Accurate Phylogenetic Estimates.\u201d *Nat. Methods* 14 (6): 587\u201389.\n<https://doi.org/10.1038/nmeth.4285>.\n\n</div>\n\n<div id=\"ref-Paradis2004-ck\" class=\"csl-entry\">\n\nParadis, Emmanuel, Julien Claude, and Korbinian Strimmer. 2004. \u201cAPE:\nAnalyses of Phylogenetics and Evolution in R Language.\u201d *Bioinformatics*\n20 (2): 289\u201390. <https://doi.org/10.1093/bioinformatics/btg412>.\n\n</div>\n\n<div id=\"ref-Revell2012-ik\" class=\"csl-entry\">\n\nRevell, Liam J. 2012. \u201cPhytools: An R Package for Phylogenetic\nComparative Biology (and Other Things).\u201d *Methods Ecol. Evol.* 3 (2):\n217\u201323. <https://doi.org/10.1111/j.2041-210X.2011.00169.x>.\n\n</div>\n\n<div id=\"ref-Tonkin-Hill2019-lc\" class=\"csl-entry\">\n\nTonkin-Hill, Gerry, John A Lees, Stephen D Bentley, Simon D W Frost, and\nJukka Corander. 2019. \u201cFast Hierarchical Bayesian Analysis of Population\nStructure.\u201d *Nucleic Acids Res.*, May.\n<https://doi.org/10.1093/nar/gkz361>.\n\n</div>\n\n<div id=\"ref-Yu2017-bf\" class=\"csl-entry\">\n\nYu, Guangchuang, David K Smith, Huachen Zhu, Yi Guan, and Tommy Tsan-Yuk\nLam. 2017. \u201cGgtree: An r Package for Visualization and Annotation of\nPhylogenetic Trees with Their Covariates and Other Associated Data.\u201d\n*Methods Ecol. Evol.* 8 (1): 28\u201336.\n<https://doi.org/10.1111/2041-210X.12628>.\n\n</div>\n\n</div>\n"
      },
      "source": "https://raw.githubusercontent.com/gtonkinhill/fastbaps/master/README.Rmd",
      "technique": "header_analysis"
    }
  ],
  "code_repository": [
    {
      "confidence": 1,
      "result": {
        "type": "Url",
        "value": "https://github.com/gtonkinhill/fastbaps"
      },
      "technique": "GitHub_API"
    }
  ],
  "date_created": [
    {
      "confidence": 1,
      "result": {
        "type": "Date",
        "value": "2018-06-12T14:25:30Z"
      },
      "technique": "GitHub_API"
    }
  ],
  "date_updated": [
    {
      "confidence": 1,
      "result": {
        "type": "Date",
        "value": "2024-10-27T02:48:03Z"
      },
      "technique": "GitHub_API"
    }
  ],
  "description": [
    {
      "confidence": 1,
      "result": {
        "type": "String",
        "value": "A fast approximation to a Dirichlet Process Mixture model (DPM) for clustering genetic data"
      },
      "technique": "GitHub_API"
    },
    {
      "confidence": 1,
      "result": {
        "original_header": "Introduction",
        "parent_header": [
          "fastbaps"
        ],
        "type": "Text_excerpt",
        "value": "The fast BAPS algorithm is based on applying the hierarchical Bayesian\nclustering (BHC) algorithm of (Heller and Ghahramani 2005) to the\nproblem of clustering genetic sequences using the same likelihood as\nBAPS (Cheng et al. 2013). The Bayesian hierarchical clustering can be\ninitiated with sequences as individual clusters or by running a faster\nconventional hierarchical clustering initially followed by BHC of the\nresulting clusters.\n\nThe algorithm has been written to take advantage of fast sparse matrix\nlibraries and is able to handle 1000\u2019s of sequences and 100,000\u2019s of\nSNPs in under an hour on a laptop using a single core.\n\nAlternatively, we can condition on an initial phylogentic or\nhierarchical tree and provide the partition of the hierarchy that\nmaximises the BAPS likelihood. This is useful if the user is mainly\ninterested in partitioning an already calculated phylogeny. We have also\nnoticed that partitioning a hierarchy built using ward.D2 distance gives\nvery reasonable results, very quickly.\n\n------------------------------------------------------------------------\n"
      },
      "source": "https://raw.githubusercontent.com/gtonkinhill/fastbaps/master/README.Rmd",
      "technique": "header_analysis"
    },
    {
      "confidence": 0.9840091287517693,
      "result": {
        "original_header": "Choice of Prior",
        "type": "Text_excerpt",
        "value": "Fastbaps includes a number of options for the Dirichlet prior\nhyperparamters. These range in order from most conservative to least as\n`symmetric`, `baps`, `optimised.symmetric` and `optimised.baps`. The\nchoice of prior can be set using the `optimise_prior` function. \nIt is also possible to condition on a pre-existing phylogeny, which\nallows a user to partition the phylogeny using the fastbaps algorithm.\nThis is described in more detail further down in the introduction.\n \n"
      },
      "source": "https://raw.githubusercontent.com/gtonkinhill/fastbaps/master/README.Rmd",
      "technique": "supervised_classification"
    },
    {
      "confidence": 0.8976757753395047,
      "result": {
        "original_header": "Loading data",
        "type": "Text_excerpt",
        "value": "We first need to load a multiple sequence alignment into sparse format.\nWe can choose between the original BAPS prior or a prior proportional to\nthe mean frequency of each allele in the population.\n``` r\nfasta.file.name <- system.file(\"extdata\", \"seqs.fa\", package = \"fastbaps\")\nsparse.data <- import_fasta_sparse_nt(fasta.file.name)\n```\nHere we make use of the \u2018optimised symmetric\u2019 prior, which empirically\nchooses the variance of the Dirichlet prior on the component mixtures.\n``` r\nsparse.data <- optimise_prior(sparse.data, type = \"optimise.symmetric\")\n#> [1] \"Optimised hyperparameter: 0.02\"\n```\n \n"
      },
      "source": "https://raw.githubusercontent.com/gtonkinhill/fastbaps/master/README.Rmd",
      "technique": "supervised_classification"
    }
  ],
  "download_url": [
    {
      "confidence": 1,
      "result": {
        "type": "Url",
        "value": "https://github.com/gtonkinhill/fastbaps/releases"
      },
      "technique": "GitHub_API"
    }
  ],
  "forks_count": [
    {
      "confidence": 1,
      "result": {
        "type": "Number",
        "value": 8
      },
      "technique": "GitHub_API"
    }
  ],
  "forks_url": [
    {
      "confidence": 1,
      "result": {
        "type": "Url",
        "value": "https://api.github.com/repos/gtonkinhill/fastbaps/forks"
      },
      "technique": "GitHub_API"
    }
  ],
  "full_name": [
    {
      "confidence": 1,
      "result": {
        "type": "String",
        "value": "gtonkinhill/fastbaps"
      },
      "technique": "GitHub_API"
    }
  ],
  "full_title": [
    {
      "confidence": 1,
      "result": {
        "type": "String",
        "value": "fastbaps"
      },
      "source": "https://raw.githubusercontent.com/gtonkinhill/fastbaps/master/README.Rmd",
      "technique": "regular_expression"
    }
  ],
  "identifier": [
    {
      "confidence": 1,
      "result": {
        "type": "Url",
        "value": "https://zenodo.org/badge/latestdoi/137083307"
      },
      "source": "https://raw.githubusercontent.com/gtonkinhill/fastbaps/master/README.Rmd",
      "technique": "regular_expression"
    }
  ],
  "images": [
    {
      "confidence": 1,
      "result": {
        "type": "Url",
        "value": "https://raw.githubusercontent.com/gtonkinhill/fastbaps/master/inst/vignette-supp/unnamed-chunk-14-1.png"
      },
      "source": "https://raw.githubusercontent.com/gtonkinhill/fastbaps/master/README.Rmd",
      "technique": "regular_expression"
    },
    {
      "confidence": 1,
      "result": {
        "type": "Url",
        "value": "https://raw.githubusercontent.com/gtonkinhill/fastbaps/master/inst/vignette-supp/unnamed-chunk-15-1.png"
      },
      "source": "https://raw.githubusercontent.com/gtonkinhill/fastbaps/master/README.Rmd",
      "technique": "regular_expression"
    },
    {
      "confidence": 1,
      "result": {
        "type": "Url",
        "value": "https://raw.githubusercontent.com/gtonkinhill/fastbaps/master/inst/vignette-supp/unnamed-chunk-16-1.png"
      },
      "source": "https://raw.githubusercontent.com/gtonkinhill/fastbaps/master/README.Rmd",
      "technique": "regular_expression"
    },
    {
      "confidence": 1,
      "result": {
        "type": "Url",
        "value": "https://raw.githubusercontent.com/gtonkinhill/fastbaps/master/inst/vignette-supp/unnamed-chunk-17-1.png"
      },
      "source": "https://raw.githubusercontent.com/gtonkinhill/fastbaps/master/README.Rmd",
      "technique": "regular_expression"
    },
    {
      "confidence": 1,
      "result": {
        "type": "Url",
        "value": "https://raw.githubusercontent.com/gtonkinhill/fastbaps/master/inst/vignette-supp/unnamed-chunk-18-1.png"
      },
      "source": "https://raw.githubusercontent.com/gtonkinhill/fastbaps/master/README.Rmd",
      "technique": "regular_expression"
    },
    {
      "confidence": 1,
      "result": {
        "type": "Url",
        "value": "https://raw.githubusercontent.com/gtonkinhill/fastbaps/master/inst/vignette-supp/unnamed-chunk-19-1.png"
      },
      "source": "https://raw.githubusercontent.com/gtonkinhill/fastbaps/master/README.Rmd",
      "technique": "regular_expression"
    }
  ],
  "installation": [
    {
      "confidence": 1,
      "result": {
        "original_header": "Installation",
        "parent_header": [
          "fastbaps"
        ],
        "type": "Text_excerpt",
        "value": "`fastbaps` is currently available on github. It can be installed with\n`devtools`\n\n``` r\ninstall.packages(\"devtools\")\n\ndevtools::install_github(\"gtonkinhill/fastbaps\")\n```\n\nIf you would like to also build the vignette with your installation run:\n\n``` r\ndevtools::install_github(\"gtonkinhill/fastbaps\", build_vignettes = TRUE)\n```\n"
      },
      "source": "https://raw.githubusercontent.com/gtonkinhill/fastbaps/master/README.Rmd",
      "technique": "header_analysis"
    },
    {
      "confidence": 1,
      "result": {
        "original_header": "Conda",
        "parent_header": [
          "fastbaps",
          "Installation"
        ],
        "type": "Text_excerpt",
        "value": "`fastbaps` can also be installed using Conda\n\n    conda install -c conda-forge -c bioconda -c defaults r-fastbaps\n"
      },
      "source": "https://raw.githubusercontent.com/gtonkinhill/fastbaps/master/README.Rmd",
      "technique": "header_analysis"
    },
    {
      "confidence": 0.9999055826470635,
      "result": {
        "original_header": "Command Line Script",
        "type": "Text_excerpt",
        "value": "The fastbaps package now includes a command line script. The location of\nthis script can be found by running\n``` r\nsystem.file(\"run_fastbaps\", package = \"fastbaps\")\n```\n \nThis script can then be copied to a location on the users path. If you\nhave installed fastbaps using conda, this will already have been done\nfor you.\n \n"
      },
      "source": "https://raw.githubusercontent.com/gtonkinhill/fastbaps/master/README.Rmd",
      "technique": "supervised_classification"
    }
  ],
  "issue_tracker": [
    {
      "confidence": 1,
      "result": {
        "type": "Url",
        "value": "https://api.github.com/repos/gtonkinhill/fastbaps/issues"
      },
      "technique": "GitHub_API"
    }
  ],
  "keywords": [
    {
      "confidence": 1,
      "result": {
        "type": "String",
        "value": "bayesian, genetics, hierarchical-clustering"
      },
      "technique": "GitHub_API"
    }
  ],
  "license": [
    {
      "confidence": 1,
      "result": {
        "name": "MIT License",
        "spdx_id": "MIT",
        "type": "License",
        "url": "https://api.github.com/licenses/mit",
        "value": "https://api.github.com/licenses/mit"
      },
      "technique": "GitHub_API"
    },
    {
      "confidence": 1,
      "result": {
        "type": "File_dump",
        "value": "# MIT License\n\nCopyright (c) 2018 Gerry Tonkin-Hill\n\nPermission is hereby granted, free of charge, to any person obtaining a copy\nof this software and associated documentation files (the \"Software\"), to deal\nin the Software without restriction, including without limitation the rights\nto use, copy, modify, merge, publish, distribute, sublicense, and/or sell\ncopies of the Software, and to permit persons to whom the Software is\nfurnished to do so, subject to the following conditions:\n\nThe above copyright notice and this permission notice shall be included in all\ncopies or substantial portions of the Software.\n\nTHE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\nIMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\nFITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\nAUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\nLIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\nOUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE\nSOFTWARE.\n"
      },
      "source": "https://raw.githubusercontent.com/gtonkinhill/fastbaps/master/LICENSE.md",
      "technique": "file_exploration"
    }
  ],
  "name": [
    {
      "confidence": 1,
      "result": {
        "type": "String",
        "value": "fastbaps"
      },
      "technique": "GitHub_API"
    }
  ],
  "owner": [
    {
      "confidence": 1,
      "result": {
        "type": "User",
        "value": "gtonkinhill"
      },
      "technique": "GitHub_API"
    }
  ],
  "programming_languages": [
    {
      "confidence": 1,
      "result": {
        "name": "R",
        "size": 47410,
        "type": "Programming_language",
        "value": "R"
      },
      "technique": "GitHub_API"
    },
    {
      "confidence": 1,
      "result": {
        "name": "C++",
        "size": 37674,
        "type": "Programming_language",
        "value": "C++"
      },
      "technique": "GitHub_API"
    },
    {
      "confidence": 1,
      "result": {
        "name": "C",
        "size": 8284,
        "type": "Programming_language",
        "value": "C"
      },
      "technique": "GitHub_API"
    }
  ],
  "readme_url": [
    {
      "confidence": 1,
      "result": {
        "type": "Url",
        "value": "https://raw.githubusercontent.com/gtonkinhill/fastbaps/master/README.Rmd"
      },
      "technique": "file_exploration"
    },
    {
      "confidence": 1,
      "result": {
        "type": "Url",
        "value": "https://raw.githubusercontent.com/gtonkinhill/fastbaps/master/README.md"
      },
      "technique": "file_exploration"
    }
  ],
  "releases": [
    {
      "confidence": 1,
      "result": {
        "author": {
          "name": "gtonkinhill",
          "type": "User"
        },
        "date_created": "2022-09-18T13:09:50Z",
        "date_published": "2022-09-19T01:21:43Z",
        "description": "- fixes inconsistencies between loading directly via the `import_fasta_sparse_nt` function or loading an MSA initially using `ape`. The latter could lead to the program crashing when gaps or Ns were included in the alignment.",
        "html_url": "https://github.com/gtonkinhill/fastbaps/releases/tag/v1.0.8",
        "name": "v1.0.8",
        "release_id": 77496431,
        "tag": "v1.0.8",
        "tarball_url": "https://api.github.com/repos/gtonkinhill/fastbaps/tarball/v1.0.8",
        "type": "Release",
        "url": "https://api.github.com/repos/gtonkinhill/fastbaps/releases/77496431",
        "value": "https://api.github.com/repos/gtonkinhill/fastbaps/releases/77496431",
        "zipball_url": "https://api.github.com/repos/gtonkinhill/fastbaps/zipball/v1.0.8"
      },
      "technique": "GitHub_API"
    },
    {
      "confidence": 1,
      "result": {
        "author": {
          "name": "gtonkinhill",
          "type": "User"
        },
        "date_created": "2022-08-23T15:02:43Z",
        "date_published": "2022-08-23T15:21:21Z",
        "description": "- Fixes a bug in very small alignments loaded from FASTA files. The initial sequence was not counted in the definition of the consensus variant. This led to problems when a variant was only present twice and one of these examples was in the first sequence.\r\n- Adds a better error message when there is less than two variants from which to perform the clustering.",
        "html_url": "https://github.com/gtonkinhill/fastbaps/releases/tag/v1.0.7",
        "name": "v1.0.7",
        "release_id": 75109383,
        "tag": "v1.0.7",
        "tarball_url": "https://api.github.com/repos/gtonkinhill/fastbaps/tarball/v1.0.7",
        "type": "Release",
        "url": "https://api.github.com/repos/gtonkinhill/fastbaps/releases/75109383",
        "value": "https://api.github.com/repos/gtonkinhill/fastbaps/releases/75109383",
        "zipball_url": "https://api.github.com/repos/gtonkinhill/fastbaps/zipball/v1.0.7"
      },
      "technique": "GitHub_API"
    },
    {
      "confidence": 1,
      "result": {
        "author": {
          "name": "gtonkinhill",
          "type": "User"
        },
        "date_created": "2021-08-10T03:46:20Z",
        "date_published": "2021-08-10T04:12:17Z",
        "description": "Fixes bugs in the `import_fasta_sparse_nt.R` script.\r\n\r\n- Resolves an issue that caused a stack overflow on very large alignments when loading directly from file\r\n- Resolves an issue that caused an error when an alignment generated using `ape` was loaded directly and included a column that was mostly gaps.",
        "html_url": "https://github.com/gtonkinhill/fastbaps/releases/tag/v1.0.6",
        "name": "v1.0.6",
        "release_id": 47577940,
        "tag": "v1.0.6",
        "tarball_url": "https://api.github.com/repos/gtonkinhill/fastbaps/tarball/v1.0.6",
        "type": "Release",
        "url": "https://api.github.com/repos/gtonkinhill/fastbaps/releases/47577940",
        "value": "https://api.github.com/repos/gtonkinhill/fastbaps/releases/47577940",
        "zipball_url": "https://api.github.com/repos/gtonkinhill/fastbaps/zipball/v1.0.6"
      },
      "technique": "GitHub_API"
    },
    {
      "confidence": 1,
      "result": {
        "author": {
          "name": "gtonkinhill",
          "type": "User"
        },
        "date_created": "2020-07-13T23:30:57Z",
        "date_published": "2020-07-13T23:55:42Z",
        "description": "- update dependencies\r\n- fix spelling error",
        "html_url": "https://github.com/gtonkinhill/fastbaps/releases/tag/v1.0.4",
        "name": "v1.0.4",
        "release_id": 28523204,
        "tag": "v1.0.4",
        "tarball_url": "https://api.github.com/repos/gtonkinhill/fastbaps/tarball/v1.0.4",
        "type": "Release",
        "url": "https://api.github.com/repos/gtonkinhill/fastbaps/releases/28523204",
        "value": "https://api.github.com/repos/gtonkinhill/fastbaps/releases/28523204",
        "zipball_url": "https://api.github.com/repos/gtonkinhill/fastbaps/zipball/v1.0.4"
      },
      "technique": "GitHub_API"
    },
    {
      "confidence": 1,
      "result": {
        "author": {
          "name": "gtonkinhill",
          "type": "User"
        },
        "date_created": "2020-03-26T11:13:56Z",
        "date_published": "2020-03-26T12:08:02Z",
        "description": "- added command line script\r\n- updated documentation",
        "html_url": "https://github.com/gtonkinhill/fastbaps/releases/tag/v1.0.3",
        "name": "v1.0.3",
        "release_id": 24887535,
        "tag": "v1.0.3",
        "tarball_url": "https://api.github.com/repos/gtonkinhill/fastbaps/tarball/v1.0.3",
        "type": "Release",
        "url": "https://api.github.com/repos/gtonkinhill/fastbaps/releases/24887535",
        "value": "https://api.github.com/repos/gtonkinhill/fastbaps/releases/24887535",
        "zipball_url": "https://api.github.com/repos/gtonkinhill/fastbaps/zipball/v1.0.3"
      },
      "technique": "GitHub_API"
    },
    {
      "confidence": 1,
      "result": {
        "author": {
          "name": "gtonkinhill",
          "type": "User"
        },
        "date_created": "2019-11-08T10:24:09Z",
        "date_published": "2020-03-02T13:00:47Z",
        "description": "Release with latest minor changes for conda",
        "html_url": "https://github.com/gtonkinhill/fastbaps/releases/tag/v1.0.2",
        "name": "v1.0.2",
        "release_id": 24129897,
        "tag": "v1.0.2",
        "tarball_url": "https://api.github.com/repos/gtonkinhill/fastbaps/tarball/v1.0.2",
        "type": "Release",
        "url": "https://api.github.com/repos/gtonkinhill/fastbaps/releases/24129897",
        "value": "https://api.github.com/repos/gtonkinhill/fastbaps/releases/24129897",
        "zipball_url": "https://api.github.com/repos/gtonkinhill/fastbaps/zipball/v1.0.2"
      },
      "technique": "GitHub_API"
    },
    {
      "confidence": 1,
      "result": {
        "author": {
          "name": "gtonkinhill",
          "type": "User"
        },
        "date_created": "2018-10-26T13:29:29Z",
        "date_published": "2018-10-26T14:10:10Z",
        "html_url": "https://github.com/gtonkinhill/fastbaps/releases/tag/v1.0.1",
        "name": "zenodo release",
        "release_id": 13678294,
        "tag": "v1.0.1",
        "tarball_url": "https://api.github.com/repos/gtonkinhill/fastbaps/tarball/v1.0.1",
        "type": "Release",
        "url": "https://api.github.com/repos/gtonkinhill/fastbaps/releases/13678294",
        "value": "https://api.github.com/repos/gtonkinhill/fastbaps/releases/13678294",
        "zipball_url": "https://api.github.com/repos/gtonkinhill/fastbaps/zipball/v1.0.1"
      },
      "technique": "GitHub_API"
    },
    {
      "confidence": 1,
      "result": {
        "author": {
          "name": "gtonkinhill",
          "type": "User"
        },
        "date_created": "2018-10-26T13:29:29Z",
        "date_published": "2018-10-26T14:07:49Z",
        "description": "Release for publication on biorxiv",
        "html_url": "https://github.com/gtonkinhill/fastbaps/releases/tag/v1.0.0",
        "name": "initial release",
        "release_id": 13678241,
        "tag": "v1.0.0",
        "tarball_url": "https://api.github.com/repos/gtonkinhill/fastbaps/tarball/v1.0.0",
        "type": "Release",
        "url": "https://api.github.com/repos/gtonkinhill/fastbaps/releases/13678241",
        "value": "https://api.github.com/repos/gtonkinhill/fastbaps/releases/13678241",
        "zipball_url": "https://api.github.com/repos/gtonkinhill/fastbaps/zipball/v1.0.0"
      },
      "technique": "GitHub_API"
    }
  ],
  "run": [
    {
      "confidence": 1,
      "result": {
        "original_header": "Running fastbaps",
        "parent_header": [
          "fastbaps"
        ],
        "type": "Text_excerpt",
        "value": "It is a good idea to choose `k.init` to be significantly larger than the\nnumber of clusters you expect. By default it is set to the number of\nsequences / 4.\n\n``` r\nbaps.hc <- fast_baps(sparse.data)\n#> [1] \"Calculating initial clustering...\"\n#> [1] \"Calculating initial dk values...\"\n#> [1] \"Clustering using hierarchical Bayesian clustering...\"\n```\n\nThis provides a Bayesian hierarchical clustering of the data. To obtain\nthe partition of this hierarchy under Dirichlet Process Mixture model\nrun\n\n``` r\nbest.partition <- best_baps_partition(sparse.data, baps.hc)\n#> [1] \"Calculating node marginal llks...\"\n#> [1] \"Finding best partition...\"\n```\n\nWe can plot the output of the algorithm along with a pre-calculated tree\nusing ggtree (Yu et al. 2017).\n\n``` r\nnewick.file.name <- system.file(\"extdata\", \"seqs.fa.treefile\", package = \"fastbaps\")\niqtree <- phytools::read.newick(newick.file.name)\nplot.df <- data.frame(id = colnames(sparse.data$snp.matrix), fastbaps = best.partition, \n    stringsAsFactors = FALSE)\n\ngg <- ggtree(iqtree)\n\nf2 <- facet_plot(gg, panel = \"fastbaps\", data = plot.df, geom = geom_tile, aes(x = fastbaps), \n    color = \"blue\")\nf2\n```\n\n![](inst/vignette-supp/unnamed-chunk-14-1.png)\n\nWe can compare this result to other priors, the un-optimised symmetric\nor BAPS prior similar to STRUCTURE and hierBAPS, an optimised BAPS prior\nor the population mean based prior of Heller et al.\n\n``` r\nsparse.data <- optimise_prior(sparse.data, type = \"baps\")\n\nbaps.hc <- fast_baps(sparse.data)\n#> [1] \"Calculating initial clustering...\"\n#> [1] \"Calculating initial dk values...\"\n#> [1] \"Clustering using hierarchical Bayesian clustering...\"\nbest.partition <- best_baps_partition(sparse.data, baps.hc)\n#> [1] \"Calculating node marginal llks...\"\n#> [1] \"Finding best partition...\"\n\nplot.df <- data.frame(id = colnames(sparse.data$snp.matrix), fastbaps = best.partition, \n    stringsAsFactors = FALSE)\n\ngg <- ggtree(iqtree)\nf2 <- facet_plot(gg, panel = \"fastbaps\", data = plot.df, geom = geom_tile, aes(x = fastbaps), \n    color = \"blue\")\nf2\n```\n\n![](inst/vignette-supp/unnamed-chunk-15-1.png)\n\nwe can also use the same prior as used in the BHC algorithm of Heller et\nal.\u00a0However this tends to overpartition population genetic data.\n\n``` r\nsparse.data <- optimise_prior(sparse.data, type = \"hc\")\n#> [1] \"Optimised hyperparameter: 0.286\"\n\nbaps.hc <- fast_baps(sparse.data)\n#> [1] \"Calculating initial clustering...\"\n#> [1] \"Calculating initial dk values...\"\n#> [1] \"Clustering using hierarchical Bayesian clustering...\"\nbest.partition <- best_baps_partition(sparse.data, baps.hc)\n#> [1] \"Calculating node marginal llks...\"\n#> [1] \"Finding best partition...\"\n\nplot.df <- data.frame(id = colnames(sparse.data$snp.matrix), fastbaps = best.partition, \n    stringsAsFactors = FALSE)\n\ngg <- ggtree(iqtree)\nf2 <- facet_plot(gg, panel = \"fastbaps\", data = plot.df, geom = geom_tile, aes(x = fastbaps), \n    color = \"blue\")\nf2\n```\n\n![](inst/vignette-supp/unnamed-chunk-16-1.png)\n\nwe can also investigate multiple levels\n\n``` r\nsparse.data <- import_fasta_sparse_nt(fasta.file.name)\nmulti <- multi_res_baps(sparse.data)\n\nplot.df <- data.frame(id = colnames(sparse.data$snp.matrix), fastbaps = multi$`Level 1`, \n    fastbaps2 = multi$`Level 2`, stringsAsFactors = FALSE)\n\ngg <- ggtree(iqtree)\n\nf2 <- facet_plot(gg, panel = \"fastbaps level 1\", data = plot.df, geom = geom_tile, \n    aes(x = fastbaps), color = \"blue\")\nf2 <- facet_plot(f2, panel = \"fastbaps level 2\", data = plot.df, geom = geom_tile, \n    aes(x = fastbaps2), color = \"green\")\nf2\n```\n\n![](inst/vignette-supp/unnamed-chunk-17-1.png)\n\nWe can also partition an initial hierarchy or phylogeny.\n\n``` r\nsparse.data <- import_fasta_sparse_nt(fasta.file.name, prior = \"baps\")\n\niqtree.rooted <- phytools::midpoint.root(iqtree)\nbest.partition <- best_baps_partition(sparse.data, iqtree.rooted)\n#> [1] \"Calculating node marginal llks...\"\n#> [1] \"Finding best partition...\"\n\nplot.df <- data.frame(id = iqtree.rooted$tip.label, fastbaps = best.partition, stringsAsFactors = FALSE)\n\ngg <- ggtree(iqtree.rooted)\nf2 <- facet_plot(gg, panel = \"fastbaps\", data = plot.df, geom = geom_tile, aes(x = fastbaps), \n    color = \"blue\")\nf2\n```\n\n![](inst/vignette-supp/unnamed-chunk-18-1.png)\n\nfinally we can also look at the stability of the inferred clusters using\nthe Bootstrap\n\n``` r\nsparse.data <- optimise_prior(sparse.data, type = \"optimise.symmetric\")\n#> [1] \"Optimised hyperparameter: 0.02\"\nboot.result <- boot_fast_baps(sparse.data)\ndendro <- as.dendrogram(fast_baps(sparse.data))\n#> [1] \"Calculating initial clustering...\"\n#> [1] \"Calculating initial dk values...\"\n#> [1] \"Clustering using hierarchical Bayesian clustering...\"\ngplots::heatmap.2(boot.result, dendro, dendro, tracecol = NA)\n```\n\n![](inst/vignette-supp/unnamed-chunk-19-1.png)\n"
      },
      "source": "https://raw.githubusercontent.com/gtonkinhill/fastbaps/master/README.Rmd",
      "technique": "header_analysis"
    }
  ],
  "somef_missing_categories": [
    "acknowledgement",
    "download",
    "requirements",
    "contact",
    "contributors",
    "documentation",
    "faq",
    "support",
    "has_build_file",
    "executable_example"
  ],
  "somef_provenance": {
    "date": "2024-11-04 05:11:59",
    "somef_schema_version": "1.0.0",
    "somef_version": "0.9.5"
  },
  "stargazers_count": [
    {
      "confidence": 1,
      "result": {
        "type": "Number",
        "value": 58
      },
      "technique": "GitHub_API"
    }
  ],
  "type": [
    {
      "confidence": 0.82,
      "result": {
        "type": "String",
        "value": "commandline-application"
      },
      "technique": "software_type_heuristics"
    }
  ],
  "usage": [
    {
      "confidence": 1,
      "result": {
        "original_header": "Quick Start",
        "parent_header": [
          "fastbaps"
        ],
        "type": "Text_excerpt",
        "value": "Run fastbaps.\n\n**NOTE:** You need to replace the variable `fasta.file.name` with the\npath to your fasta file. The system.file function is only used in this\nexample vignette.\n\n``` r\n# devtools::install_github('gtonkinhill/fastbaps')\nlibrary(fastbaps)\nlibrary(ape)\n\nfasta.file.name <- system.file(\"extdata\", \"seqs.fa\", package = \"fastbaps\")\nsparse.data <- import_fasta_sparse_nt(fasta.file.name)\nsparse.data <- optimise_prior(sparse.data, type = \"optimise.symmetric\")\n#> [1] \"Optimised hyperparameter: 0.02\"\nbaps.hc <- fast_baps(sparse.data)\n#> [1] \"Calculating initial clustering...\"\n#> [1] \"Calculating initial dk values...\"\n#> [1] \"Clustering using hierarchical Bayesian clustering...\"\nclusters <- best_baps_partition(sparse.data, as.phylo(baps.hc))\n#> [1] \"Calculating node marginal llks...\"\n#> [1] \"Finding best partition...\"\n```\n\nAll these steps can be combined and the algorithm run over multiple\nlevels by running\n\n``` r\nsparse.data <- optimise_prior(sparse.data, type = \"optimise.symmetric\")\n#> [1] \"Optimised hyperparameter: 0.02\"\nmulti <- multi_res_baps(sparse.data)\n```\n"
      },
      "source": "https://raw.githubusercontent.com/gtonkinhill/fastbaps/master/README.Rmd",
      "technique": "header_analysis"
    }
  ]
}