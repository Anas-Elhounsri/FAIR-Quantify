{
  "citation": [
    {
      "confidence": 1,
      "result": {
        "original_header": "Reference:",
        "parent_header": [
          "TopHap_v1.2.1"
        ],
        "type": "Text_excerpt",
        "value": "[1] Marcos A. Caraballo-Ortiz, Sayaka Miura, Sergei L. K. Pond, Qiqing Tao, and Sudhir Kumar. TopHap: TopHap: Rapid inference of key phylogenetic structures from common haplotypes in large genome collections with limited diversity (2021) Submitted to Bioinformatics\r\n\r\n\r"
      },
      "source": "https://raw.githubusercontent.com/SayakaMiura/TopHap/main/README.md",
      "technique": "header_analysis"
    }
  ],
  "code_repository": [
    {
      "confidence": 1,
      "result": {
        "type": "Url",
        "value": "https://github.com/SayakaMiura/TopHap"
      },
      "technique": "GitHub_API"
    }
  ],
  "date_created": [
    {
      "confidence": 1,
      "result": {
        "type": "Date",
        "value": "2021-01-29T00:23:48Z"
      },
      "technique": "GitHub_API"
    }
  ],
  "date_updated": [
    {
      "confidence": 1,
      "result": {
        "type": "Date",
        "value": "2023-01-09T20:01:54Z"
      },
      "technique": "GitHub_API"
    }
  ],
  "description": [
    {
      "confidence": 1,
      "result": {
        "original_header": "Description",
        "parent_header": [
          "TopHap_v1.2.1"
        ],
        "type": "Text_excerpt",
        "value": "TopHap infers bootstrap-supported phylogenies of common haplotypes in the given data. See Caraballo et al. (ref. 1) for the detail. The TopHap program has been developed by Sudhir Kumar. It is written in Python. You are free to download, modify, and expand this code under a permissive license similar to the BSD 2-Clause License (see below).\r\n\r"
      },
      "source": "https://raw.githubusercontent.com/SayakaMiura/TopHap/main/README.md",
      "technique": "header_analysis"
    },
    {
      "confidence": 0.9960291456189242,
      "result": {
        "original_header": "Copyright 2022, Authors and Temple University",
        "type": "Text_excerpt",
        "value": "BSD 3-Clause \"New\" or \"Revised\" License, which is a permissive license similar to the BSD 2-Clause License except that it prohibits others from using the name of the project or its contributors to promote derived products without written consent. \r\nRedistribution and use in source and binary forms, with or without modification, are permitted provided that the following conditions are met:\r\n1. Redistributions of source code must retain the above copyright notice, this list of conditions, and the following disclaimer.\r\n2. Redistributions in binary form must reproduce the above copyright notice, this list of conditions, and the following disclaimer in the documentation and/or other materials provided with the distribution.\r\n3. Neither the name of the copyright holder nor the names of its contributors may be used to endorse or promote products derived from this software without specific prior written permission.\r\n\r\nTHIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS \"AS IS\" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\r\n \n"
      },
      "source": "https://raw.githubusercontent.com/SayakaMiura/TopHap/main/README.md",
      "technique": "supervised_classification"
    }
  ],
  "download_url": [
    {
      "confidence": 1,
      "result": {
        "type": "Url",
        "value": "https://github.com/SayakaMiura/TopHap/releases"
      },
      "technique": "GitHub_API"
    }
  ],
  "forks_count": [
    {
      "confidence": 1,
      "result": {
        "type": "Number",
        "value": 0
      },
      "technique": "GitHub_API"
    }
  ],
  "forks_url": [
    {
      "confidence": 1,
      "result": {
        "type": "Url",
        "value": "https://api.github.com/repos/SayakaMiura/TopHap/forks"
      },
      "technique": "GitHub_API"
    }
  ],
  "full_name": [
    {
      "confidence": 1,
      "result": {
        "type": "String",
        "value": "SayakaMiura/TopHap"
      },
      "technique": "GitHub_API"
    }
  ],
  "full_title": [
    {
      "confidence": 1,
      "result": {
        "type": "String",
        "value": "TopHap_v1.2.1"
      },
      "source": "https://raw.githubusercontent.com/SayakaMiura/TopHap/main/README.md",
      "technique": "regular_expression"
    }
  ],
  "issue_tracker": [
    {
      "confidence": 1,
      "result": {
        "type": "Url",
        "value": "https://api.github.com/repos/SayakaMiura/TopHap/issues"
      },
      "technique": "GitHub_API"
    }
  ],
  "keywords": [
    {
      "confidence": 1,
      "result": {
        "type": "String",
        "value": ""
      },
      "technique": "GitHub_API"
    }
  ],
  "name": [
    {
      "confidence": 1,
      "result": {
        "type": "String",
        "value": "TopHap"
      },
      "technique": "GitHub_API"
    }
  ],
  "owner": [
    {
      "confidence": 1,
      "result": {
        "type": "User",
        "value": "SayakaMiura"
      },
      "technique": "GitHub_API"
    }
  ],
  "programming_languages": [
    {
      "confidence": 1,
      "result": {
        "name": "Python",
        "size": 74196,
        "type": "Programming_language",
        "value": "Python"
      },
      "technique": "GitHub_API"
    },
    {
      "confidence": 1,
      "result": {
        "name": "Mako",
        "size": 2605,
        "type": "Programming_language",
        "value": "Mako"
      },
      "technique": "GitHub_API"
    }
  ],
  "readme_url": [
    {
      "confidence": 1,
      "result": {
        "type": "Url",
        "value": "https://raw.githubusercontent.com/SayakaMiura/TopHap/main/README.md"
      },
      "technique": "file_exploration"
    }
  ],
  "requirements": [
    {
      "confidence": 1,
      "result": {
        "original_header": "Dependencies",
        "parent_header": [
          "TopHap_v1.2.1"
        ],
        "type": "Text_excerpt",
        "value": "1. python 3 (v3.7.9 and v3.8.3 were tested)\r\n > python packages: \r\n >>   numpy\r\n >>   \r\n >>   biopython\r\n >>   \r\n > Note: If the installation of these python packages is not easy, you may want to use Anaconda for Python 3 (https://www.anaconda.com/distribution/). Or you can try python3 -m pip install [package name].\r\n\r\n2. R (v3.5.3 and v4.0.3 were tested)\r\n > R package: \r\n >>   ape\r\n >>   \r\n >>   phangorn \r\n >>   \r\n> Please make sure \u201cRscript\u201d command is functional.\r\n\r\n3. MEGA\r\n > Please download the latest version from https://www.megasoftware.net/.\r\n\r\n4. RaxML (optional)\r\n > It can be downloaded at https://cme.h-its.org/exelixis/web/software/raxml/.\r\n\r"
      },
      "source": "https://raw.githubusercontent.com/SayakaMiura/TopHap/main/README.md",
      "technique": "header_analysis"
    }
  ],
  "run": [
    {
      "confidence": 1,
      "result": {
        "original_header": "1. Run vcf_json_parse.py. (optional)",
        "parent_header": [
          "TopHap_v1.2.1",
          "How to use TopHap"
        ],
        "type": "Text_excerpt",
        "value": "\r\nGiven the alignment of all genomes (i.e., aligned with Wuhan1 reference genome sequence), common nucleotides (positions with desired minor allele frequency (maf) threshold (e.g., > 5%) are extracted and haplotype alignments that contain only these genomic positions are generated for each spatiotemporal slice of the dataset (country and sampling month). \r\n\r\n`python3 vcf_json_parse.py [input full genome alignment] --reference Wuhan1Gnome.fasta --min_subgroup_size 500 --one_based --skip_mismatches --min_freq 0.05 -o [output directory]`\r\n\r\nIf you have fasta file, you can use the following command to make a json file. In the output json file, the position is counted from 0. The output file is created in the same directory as the input fasta file. \r\n\r\n`python3 Fas2Json.py [input fasta file without outgroup sequence] [Outgroup sequence without sequence ID]`\r\n\r"
      },
      "source": "https://raw.githubusercontent.com/SayakaMiura/TopHap/main/README.md",
      "technique": "header_analysis"
    },
    {
      "confidence": 1,
      "result": {
        "original_header": "input",
        "parent_header": [
          "TopHap_v1.2.1",
          "How to use TopHap",
          "1. Run vcf_json_parse.py. (optional)"
        ],
        "type": "Text_excerpt",
        "value": "- full genome alignment\r\n \r\n Each genome sequence information needs to be saved in a json format. The format should be,\r\n \r\n `{\"variants\":[[genomic position,nucleotide,count,frequency],...],\r\n \"sequences\":[{\"V\":[genomic position,nucleotide,...],\"I\":[sampling time,continent,country,PANGO ID,NextStrain ID]},...]},\r\n }`\r\n \r\n For example,\r\n \r\n `{\"variants\":[[13467,\"-\",1106856,0.9999936758207655],[23403,\"G\",1091067,0.9857290378303367]...],\r\n \"sequences\":[{\"V\":[1059,\"T\",3037,\"T\"],\"I\":[\"20200308\",\"Africa\",\"Algeria\",\"B.1\",\"20C\"]},{\"V\":[10582,\"T\",13467,\"-\",14408,\"T\",23403,\"G\",25563,\"T\"],\"I\":[\"20200302\",\"Africa\",\"Algeria\",\"B.1\",\"20C\"]},...]\r\n }`\r\n \r\n - Please do not use space and symbols for the country name. An example JSON file is provided, \"Example.json.\" \r\n\r"
      },
      "source": "https://raw.githubusercontent.com/SayakaMiura/TopHap/main/README.md",
      "technique": "header_analysis"
    },
    {
      "confidence": 1,
      "result": {
        "original_header": "options",
        "parent_header": [
          "TopHap_v1.2.1",
          "How to use TopHap",
          "2. Run TopHap.py."
        ],
        "type": "Text_excerpt",
        "value": "- --reference [reference genome sequence file]: Reference genome sequence to determine mutant and non-mutant nucleotides.   \r\n\r\n- --min_subgroup_size [number]: The minimum genome count per slice (alignment file). When the count in a monthly slice is smaller than this minimum count, the slice is merged to an adjacent month. When the count is still smaller than the minimum count after merging slices, such slices will be ignored to compute minor allele frequency (maf).  \r\n\r\n- --one_based: If the genomic position in the JSON file is counted from 1, use this option.\r\n\r\n- --skip_mismatches: If gaps (-) are desired to be ignored for the calculation of maf, use this option.\r\n\r\n- --min_freq [a value between 0 and 1]: Minor allele frequency (maf) threshold. \r\n\r\n- -o [output directory]: The directory all output files are stored.\r\n\r"
      },
      "source": "https://raw.githubusercontent.com/SayakaMiura/TopHap/main/README.md",
      "technique": "header_analysis"
    },
    {
      "confidence": 1,
      "result": {
        "original_header": "output files",
        "parent_header": [
          "TopHap_v1.2.1",
          "How to use TopHap",
          "3. Run TopHap_Attach.py (optional)"
        ],
        "type": "Text_excerpt",
        "value": " - fasta files\r\n \r\n An alignment of haplotypes is produced for each spatiotemporal slice.\r\n - Haplotypes.txt\r\n \r\n Genomic positions are used to generate each fasta file. The genomic positions are counted from 0, and the order of the positions is the same as those in the fasta file.\r\n\r"
      },
      "source": "https://raw.githubusercontent.com/SayakaMiura/TopHap/main/README.md",
      "technique": "header_analysis"
    },
    {
      "confidence": 1,
      "result": {
        "original_header": "2. Run TopHap.py.",
        "parent_header": [
          "TopHap_v1.2.1",
          "How to use TopHap"
        ],
        "type": "Text_excerpt",
        "value": "The main program that infers bootstrap-supported phylogenies of common haplotypes in the given data.\r\n\r\n`python3 TopHap.py [haplotype frequency cutoff] [number of bootstrap replicates] \u2013Hap [path to the directory of the haplotype alignments]` \r\n\r\nPlease provide Haplotypes.txt that lists the genomic positions (count from position 0) that are used for the haplotype alignment. Haplotypes.txt should be placed in the same directory of the haplotype alignments. An example Haplotypes.txt can be found in the Alignment directory.\r\n\r\n#### options\r\n- haplotype frequency cutoff: haplotypes with the desired frequency thresholds are selected.   \r\n- the number of bootstrap replicates: The desired number of bootstrap samples are generated.\r\n- The data is assumed to be SARS-CoV-2. If other data is used, please provide outgroup sequence in Outgroup.fasta.\r\n\r\n#### output files\r\n - Bootstrap scored phylogenies (TopHap_bootstrap*.nwk)\r\n \r\n If there is more than one equally parsimonious tree, each tree is scored. Please select the one with the highest support.\r\n - Haplotype alignment (TopHap_prune.fasta)\r\n \r\n It can be used together with a Bootstrap scored phylogeny to infer ancestral states, from which you can find the timing of each mutation. The ancestral reconstruction function in MEGA (https://www.megasoftware.net/) is useful for this purpose. \r\n - Results of each bootstrap replicate dataset are found in the Bootstrap directory.\r\n\r\n#### example\r\n Example datasets can be found in Alignment.\r\n \r\n`python3 TopHap.py 0.05 100 -Hap Alignment`\r\n \r"
      },
      "source": "https://raw.githubusercontent.com/SayakaMiura/TopHap/main/README.md",
      "technique": "header_analysis"
    },
    {
      "confidence": 1,
      "result": {
        "original_header": "3. Run TopHap_Attach.py (optional)",
        "parent_header": [
          "TopHap_v1.2.1",
          "How to use TopHap"
        ],
        "type": "Text_excerpt",
        "value": "Attach minor haplotype sequences into a TopHap phylogeny. For a TopHap phylogeny, haplotype of interest will be attached.\r\n\r\n`python3 TopHap_Attach.py [TopHap alignment] [TopHap tree] [minor haplotype] [path to raxml]`\r\n\r"
      },
      "source": "https://raw.githubusercontent.com/SayakaMiura/TopHap/main/README.md",
      "technique": "header_analysis"
    },
    {
      "confidence": 1,
      "result": {
        "original_header": "inputs",
        "parent_header": [
          "TopHap_v1.2.1",
          "How to use TopHap",
          "3. Run TopHap_Attach.py (optional)"
        ],
        "type": "Text_excerpt",
        "value": " - TopHap alignment: A fasta file that contains TopHap haplotypes\r\n - TopHap tree: A nwk file that contains TopHap tree\r\n - minor haplotype: A fasta file that contains minor haplotypes that are attached to the TopHap tree\r\n\r\n#### output files\r\n - A phylogeny with a minor haplotype attached (RaxMLoutputs\\*.nwk)\r\n \r\n All trees are found at RaxMLoutputs directory.\r\n - RaxML output files\r\n \r\n Direct output files from RaxML are stored in RaxMLoutputsAll. \r\n \r\n#### example\r\n Example datasets can be found in Example_attach. TopHap alignment and tree are TopHap_prune.fasta and TopHap_bootstrap1.nwk, respectively. To attach haplotypes in MinorHap.fasta, run,\r\n \r\n`python3 TopHap_Attach.py Example_attach\\TopHap_prune.fasta Example_attach\\TopHap_bootstrap1.nwk Example_attach\\MinorHap.fasta raxmlHPC-AVX.exe`\r\n\r\n\r"
      },
      "source": "https://raw.githubusercontent.com/SayakaMiura/TopHap/main/README.md",
      "technique": "header_analysis"
    }
  ],
  "somef_missing_categories": [
    "installation",
    "acknowledgement",
    "download",
    "contact",
    "contributors",
    "documentation",
    "license",
    "faq",
    "support",
    "identifier",
    "has_build_file",
    "executable_example"
  ],
  "somef_provenance": {
    "date": "2024-10-06 01:26:11",
    "somef_schema_version": "1.0.0",
    "somef_version": "0.9.5"
  },
  "stargazers_count": [
    {
      "confidence": 1,
      "result": {
        "type": "Number",
        "value": 4
      },
      "technique": "GitHub_API"
    }
  ],
  "usage": [
    {
      "confidence": 1,
      "result": {
        "original_header": "input",
        "parent_header": [
          "TopHap_v1.2.1",
          "How to use TopHap",
          "1. Run vcf_json_parse.py. (optional)"
        ],
        "type": "Text_excerpt",
        "value": "- full genome alignment\r\n \r\n Each genome sequence information needs to be saved in a json format. The format should be,\r\n \r\n `{\"variants\":[[genomic position,nucleotide,count,frequency],...],\r\n \"sequences\":[{\"V\":[genomic position,nucleotide,...],\"I\":[sampling time,continent,country,PANGO ID,NextStrain ID]},...]},\r\n }`\r\n \r\n For example,\r\n \r\n `{\"variants\":[[13467,\"-\",1106856,0.9999936758207655],[23403,\"G\",1091067,0.9857290378303367]...],\r\n \"sequences\":[{\"V\":[1059,\"T\",3037,\"T\"],\"I\":[\"20200308\",\"Africa\",\"Algeria\",\"B.1\",\"20C\"]},{\"V\":[10582,\"T\",13467,\"-\",14408,\"T\",23403,\"G\",25563,\"T\"],\"I\":[\"20200302\",\"Africa\",\"Algeria\",\"B.1\",\"20C\"]},...]\r\n }`\r\n \r\n - Please do not use space and symbols for the country name. An example JSON file is provided, \"Example.json.\" \r\n\r"
      },
      "source": "https://raw.githubusercontent.com/SayakaMiura/TopHap/main/README.md",
      "technique": "header_analysis"
    },
    {
      "confidence": 1,
      "result": {
        "original_header": "options",
        "parent_header": [
          "TopHap_v1.2.1",
          "How to use TopHap",
          "2. Run TopHap.py."
        ],
        "type": "Text_excerpt",
        "value": "- --reference [reference genome sequence file]: Reference genome sequence to determine mutant and non-mutant nucleotides.   \r\n\r\n- --min_subgroup_size [number]: The minimum genome count per slice (alignment file). When the count in a monthly slice is smaller than this minimum count, the slice is merged to an adjacent month. When the count is still smaller than the minimum count after merging slices, such slices will be ignored to compute minor allele frequency (maf).  \r\n\r\n- --one_based: If the genomic position in the JSON file is counted from 1, use this option.\r\n\r\n- --skip_mismatches: If gaps (-) are desired to be ignored for the calculation of maf, use this option.\r\n\r\n- --min_freq [a value between 0 and 1]: Minor allele frequency (maf) threshold. \r\n\r\n- -o [output directory]: The directory all output files are stored.\r\n\r"
      },
      "source": "https://raw.githubusercontent.com/SayakaMiura/TopHap/main/README.md",
      "technique": "header_analysis"
    },
    {
      "confidence": 1,
      "result": {
        "original_header": "output files",
        "parent_header": [
          "TopHap_v1.2.1",
          "How to use TopHap",
          "3. Run TopHap_Attach.py (optional)"
        ],
        "type": "Text_excerpt",
        "value": " - fasta files\r\n \r\n An alignment of haplotypes is produced for each spatiotemporal slice.\r\n - Haplotypes.txt\r\n \r\n Genomic positions are used to generate each fasta file. The genomic positions are counted from 0, and the order of the positions is the same as those in the fasta file.\r\n\r"
      },
      "source": "https://raw.githubusercontent.com/SayakaMiura/TopHap/main/README.md",
      "technique": "header_analysis"
    },
    {
      "confidence": 1,
      "result": {
        "original_header": "example",
        "parent_header": [
          "TopHap_v1.2.1",
          "How to use TopHap",
          "3. Run TopHap_Attach.py (optional)"
        ],
        "type": "Text_excerpt",
        "value": " \"Example.json\" can be processed by,\r\n \r\n`python3 vcf_json_parse.py Example.json --reference Wuhan1Gnome.fasta --min_subgroup_size 500 --one_based --skip_mismatches --min_freq 0.05 -o ExampleHap`\r\n\r\n The output alignment files together with genomic positions extracted (\"Haplotypes.txt\") are stored in \"ExampleHap\" directory.\r\n\r"
      },
      "source": "https://raw.githubusercontent.com/SayakaMiura/TopHap/main/README.md",
      "technique": "header_analysis"
    },
    {
      "confidence": 1,
      "result": {
        "original_header": "inputs",
        "parent_header": [
          "TopHap_v1.2.1",
          "How to use TopHap",
          "3. Run TopHap_Attach.py (optional)"
        ],
        "type": "Text_excerpt",
        "value": " - TopHap alignment: A fasta file that contains TopHap haplotypes\r\n - TopHap tree: A nwk file that contains TopHap tree\r\n - minor haplotype: A fasta file that contains minor haplotypes that are attached to the TopHap tree\r\n\r\n#### output files\r\n - A phylogeny with a minor haplotype attached (RaxMLoutputs\\*.nwk)\r\n \r\n All trees are found at RaxMLoutputs directory.\r\n - RaxML output files\r\n \r\n Direct output files from RaxML are stored in RaxMLoutputsAll. \r\n \r\n#### example\r\n Example datasets can be found in Example_attach. TopHap alignment and tree are TopHap_prune.fasta and TopHap_bootstrap1.nwk, respectively. To attach haplotypes in MinorHap.fasta, run,\r\n \r\n`python3 TopHap_Attach.py Example_attach\\TopHap_prune.fasta Example_attach\\TopHap_bootstrap1.nwk Example_attach\\MinorHap.fasta raxmlHPC-AVX.exe`\r\n\r\n\r"
      },
      "source": "https://raw.githubusercontent.com/SayakaMiura/TopHap/main/README.md",
      "technique": "header_analysis"
    }
  ]
}