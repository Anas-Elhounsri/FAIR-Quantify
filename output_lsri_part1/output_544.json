{
  "application_domain": [
    {
      "confidence": 21.36,
      "result": {
        "type": "String",
        "value": "Natural Language Processing"
      },
      "technique": "supervised_classification"
    }
  ],
  "citation": [
    {
      "confidence": 1,
      "result": {
        "format": "bibtex",
        "type": "File_dump",
        "value": "citHeader(\"To cite SCISSORS in publications use:\")\n\ncitEntry(\n  entry = \"article\",\n  title = \"Sub-cluster identification through semi-supervised optimization of rare cell silhouettes (SCISSORS) in single-cell sequencing\",\n  author = personList(as.person(\"Jack Leary\"),\n                      as.person(\"Yi Xu\"),\n                      as.person(\"Ashley Morrison\"),\n                      as.person(\"Chong Jin\"),\n                      as.person(\"Emily C. Shen\"),\n                      as.person(\"Ye Su\"),\n                      as.person(\"Naim Rashid\"),\n                      as.person(\"Jen Jen Yeh\"),\n                      as.person(\"Xianlu Peng\")),\n  journal = \"BioRxiv\",\n  year = \"2021\",\n  url = \"https://doi.org/10.1101/2021.10.29.466448\",\n  textVersion = \"Leary, J. et al. Sub-cluster identification through semi-supervised optimization of rare cell silhouettes (SCISSORS) in single-cell sequencing. BioRxiv (2021).\"\n)\n"
      },
      "source": "https://raw.githubusercontent.com/jr-leary7/SCISSORS/master/inst/CITATION",
      "technique": "file_exploration"
    },
    {
      "confidence": 1,
      "result": {
        "original_header": "References",
        "type": "Text_excerpt",
        "value": "1.  Leary, J. *et al*. [Sub-cluster identification through\n    semi-supervised optimization of rare cell silhouettes (SCISSORS) in\n    single-cell sequencing](https://doi.org/10.1101/2021.10.29.466448).\n    *BioRxiv* (2021).\n\n2.  10X Genomics. [3k PBMCs from a healthy donor: single cell gene\n    expression dataset by Cell Ranger\n    v1.1.0](https://support.10xgenomics.com/single-cell-gene-expression/datasets/1.1.0/pbmc3k).\n    *10X Genomics Documentation* (2016).\n\n3.  Rousseeuw, P. [Silhouettes: A graphical aid to the interpretation\n    and validation of cluster\n    analysis](https://doi.org/10.1016/0377-0427%2887%2990125-7).\n    *Journal of Computational and Applied Mathematics* (1987).\n"
      },
      "source": "https://raw.githubusercontent.com/jr-leary7/SCISSORS/master/README.Rmd",
      "technique": "header_analysis"
    }
  ],
  "code_repository": [
    {
      "confidence": 1,
      "result": {
        "type": "Url",
        "value": "https://github.com/jr-leary7/SCISSORS"
      },
      "technique": "GitHub_API"
    }
  ],
  "contact": [
    {
      "confidence": 1,
      "result": {
        "original_header": "Contact Information",
        "type": "Text_excerpt",
        "value": "This package is developed and maintained by Jack Leary. Feel free to ask\nfor help via [opening an\nissue](https://github.com/jr-leary7/SCISSORS/issues) or via email\n(<jrleary@live.unc.edu>) if more detailed assistance is needed.\n"
      },
      "source": "https://raw.githubusercontent.com/jr-leary7/SCISSORS/master/README.Rmd",
      "technique": "header_analysis"
    }
  ],
  "date_created": [
    {
      "confidence": 1,
      "result": {
        "type": "Date",
        "value": "2020-06-20T21:24:46Z"
      },
      "technique": "GitHub_API"
    }
  ],
  "date_updated": [
    {
      "confidence": 1,
      "result": {
        "type": "Date",
        "value": "2024-06-21T14:55:21Z"
      },
      "technique": "GitHub_API"
    }
  ],
  "description": [
    {
      "confidence": 1,
      "result": {
        "type": "String",
        "value": "SCISSORS builds upon the Louvain graph-based clustering in Seurat by optimizing parameter selection when reclustering cell groups, with an eye towards identifying rare cell types. "
      },
      "technique": "GitHub_API"
    },
    {
      "confidence": 0.99076885267949,
      "result": {
        "original_header": "`SCISSORS`",
        "type": "Text_excerpt",
        "value": "\nThis package enables researchers to efficiently, accurately, and\nreproducibly uncover rare celltypes and other small subgroups using an\niterative reclustering optimization routine built as an extension to a\ntypical `Seurat` workflow. Tools are included to preprocess data,\nidentify potential targets for subgroup analysis, optimize reclustering,\nand annotate results. A preprint detailing the method & some biological\nresults is available [on\nBioRxiv](https://doi.org/10.1101/2021.10.29.466448).\n \n"
      },
      "source": "https://raw.githubusercontent.com/jr-leary7/SCISSORS/master/README.Rmd",
      "technique": "supervised_classification"
    },
    {
      "confidence": 0.9933487918845746,
      "result": {
        "original_header": "Conclusions &amp; Best Practices",
        "type": "Text_excerpt",
        "value": "There\u2019s certainly more that can be done with this dataset - the monocyte\nclusters have subgroups as well (DCs, intermediate monocytes, even some\nplatelets). A further tutorial exploring those cells can be found\n[here](https://jr-leary7.github.io/quarto-site/tutorials/SCISSORS_Reclustering.html).\nThis introduction should provide a solid start though, and has hopefully\nshown that reclustering analysis can be efficient and easy, while still\nproviding results we can be confident in. In general, it\u2019s best if\nreclustering analyses are semi-supervised; you want to have some idea of\nwhat\u2019s going on / what could be possible biologically, but it\u2019s\nimportant to not have a predefined conclusion that you\u2019re looking for as\nwell. Using biological background information as well as cluster fit\nheuristics to choose reclustering targets is, empirically, a good way to\navoid false positives and ensure that your reclustering results are\nbiologically meaningful & reproducible. For more complex analyses using\n`SCISSORS` see our manuscript, and don\u2019t hesitate to reach out if you\u2019d\nlike help with using the package.\n \n"
      },
      "source": "https://raw.githubusercontent.com/jr-leary7/SCISSORS/master/README.Rmd",
      "technique": "supervised_classification"
    }
  ],
  "download_url": [
    {
      "confidence": 1,
      "result": {
        "type": "Url",
        "value": "https://github.com/jr-leary7/SCISSORS/releases"
      },
      "technique": "GitHub_API"
    }
  ],
  "forks_count": [
    {
      "confidence": 1,
      "result": {
        "type": "Number",
        "value": 4
      },
      "technique": "GitHub_API"
    }
  ],
  "forks_url": [
    {
      "confidence": 1,
      "result": {
        "type": "Url",
        "value": "https://api.github.com/repos/jr-leary7/SCISSORS/forks"
      },
      "technique": "GitHub_API"
    }
  ],
  "full_name": [
    {
      "confidence": 1,
      "result": {
        "type": "String",
        "value": "jr-leary7/SCISSORS"
      },
      "technique": "GitHub_API"
    }
  ],
  "full_title": [
    {
      "confidence": 1,
      "result": {
        "type": "String",
        "value": "SCISSORS"
      },
      "source": "https://raw.githubusercontent.com/jr-leary7/SCISSORS/master/README.Rmd",
      "technique": "regular_expression"
    }
  ],
  "images": [
    {
      "confidence": 1,
      "result": {
        "type": "Url",
        "value": "https://raw.githubusercontent.com/jr-leary7/SCISSORS/master/man/figures/README-umap-broad-cluster-1.png"
      },
      "source": "https://raw.githubusercontent.com/jr-leary7/SCISSORS/master/README.Rmd",
      "technique": "regular_expression"
    },
    {
      "confidence": 1,
      "result": {
        "type": "Url",
        "value": "https://raw.githubusercontent.com/jr-leary7/SCISSORS/master/man/figures/README-silhouette-dist-1.png"
      },
      "source": "https://raw.githubusercontent.com/jr-leary7/SCISSORS/master/README.Rmd",
      "technique": "regular_expression"
    },
    {
      "confidence": 1,
      "result": {
        "type": "Url",
        "value": "https://raw.githubusercontent.com/jr-leary7/SCISSORS/master/man/figures/README-broad-markers-1.png"
      },
      "source": "https://raw.githubusercontent.com/jr-leary7/SCISSORS/master/README.Rmd",
      "technique": "regular_expression"
    },
    {
      "confidence": 1,
      "result": {
        "type": "Url",
        "value": "https://raw.githubusercontent.com/jr-leary7/SCISSORS/master/man/figures/README-broad-celltypes-1.png"
      },
      "source": "https://raw.githubusercontent.com/jr-leary7/SCISSORS/master/README.Rmd",
      "technique": "regular_expression"
    },
    {
      "confidence": 1,
      "result": {
        "type": "Url",
        "value": "https://raw.githubusercontent.com/jr-leary7/SCISSORS/master/man/figures/README-t-reclust-1.png"
      },
      "source": "https://raw.githubusercontent.com/jr-leary7/SCISSORS/master/README.Rmd",
      "technique": "regular_expression"
    },
    {
      "confidence": 1,
      "result": {
        "type": "Url",
        "value": "https://raw.githubusercontent.com/jr-leary7/SCISSORS/master/man/figures/README-reclust-markers-1.png"
      },
      "source": "https://raw.githubusercontent.com/jr-leary7/SCISSORS/master/README.Rmd",
      "technique": "regular_expression"
    },
    {
      "confidence": 1,
      "result": {
        "type": "Url",
        "value": "https://raw.githubusercontent.com/jr-leary7/SCISSORS/master/man/figures/README-integrate-reclust-1.png"
      },
      "source": "https://raw.githubusercontent.com/jr-leary7/SCISSORS/master/README.Rmd",
      "technique": "regular_expression"
    },
    {
      "confidence": 1,
      "result": {
        "type": "Url",
        "value": "https://raw.githubusercontent.com/jr-leary7/SCISSORS/master/man/figures/README-spec-markers-1.png"
      },
      "source": "https://raw.githubusercontent.com/jr-leary7/SCISSORS/master/README.Rmd",
      "technique": "regular_expression"
    }
  ],
  "installation": [
    {
      "confidence": 1,
      "result": {
        "original_header": "Installation",
        "parent_header": [
          "`SCISSORS`"
        ],
        "type": "Text_excerpt",
        "value": "You can install the most recent version of `SCISSORS` with:\n\n``` r\nremotes::install_github(\"jr-leary7/SCISSORS\")\n```\n"
      },
      "source": "https://raw.githubusercontent.com/jr-leary7/SCISSORS/master/README.Rmd",
      "technique": "header_analysis"
    }
  ],
  "issue_tracker": [
    {
      "confidence": 1,
      "result": {
        "type": "Url",
        "value": "https://api.github.com/repos/jr-leary7/SCISSORS/issues"
      },
      "technique": "GitHub_API"
    }
  ],
  "keywords": [
    {
      "confidence": 1,
      "result": {
        "type": "String",
        "value": "cell-type-identification, cluster, rare-cells, seurat, subpopulation"
      },
      "technique": "GitHub_API"
    }
  ],
  "license": [
    {
      "confidence": 1,
      "result": {
        "name": "MIT License",
        "spdx_id": "MIT",
        "type": "License",
        "url": "https://api.github.com/licenses/mit",
        "value": "https://api.github.com/licenses/mit"
      },
      "technique": "GitHub_API"
    },
    {
      "confidence": 1,
      "result": {
        "type": "File_dump",
        "value": "# MIT License\n\nCopyright (c) 2020 SCISSORS authors\n\nPermission is hereby granted, free of charge, to any person obtaining a copy\nof this software and associated documentation files (the \"Software\"), to deal\nin the Software without restriction, including without limitation the rights\nto use, copy, modify, merge, publish, distribute, sublicense, and/or sell\ncopies of the Software, and to permit persons to whom the Software is\nfurnished to do so, subject to the following conditions:\n\nThe above copyright notice and this permission notice shall be included in all\ncopies or substantial portions of the Software.\n\nTHE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\nIMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\nFITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\nAUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\nLIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\nOUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE\nSOFTWARE.\n"
      },
      "source": "https://raw.githubusercontent.com/jr-leary7/SCISSORS/master/LICENSE.md",
      "technique": "file_exploration"
    }
  ],
  "name": [
    {
      "confidence": 1,
      "result": {
        "type": "String",
        "value": "SCISSORS"
      },
      "technique": "GitHub_API"
    }
  ],
  "owner": [
    {
      "confidence": 1,
      "result": {
        "type": "User",
        "value": "jr-leary7"
      },
      "technique": "GitHub_API"
    }
  ],
  "programming_languages": [
    {
      "confidence": 1,
      "result": {
        "name": "R",
        "size": 64796,
        "type": "Programming_language",
        "value": "R"
      },
      "technique": "GitHub_API"
    }
  ],
  "readme_url": [
    {
      "confidence": 1,
      "result": {
        "type": "Url",
        "value": "https://raw.githubusercontent.com/jr-leary7/SCISSORS/master/README.Rmd"
      },
      "technique": "file_exploration"
    },
    {
      "confidence": 1,
      "result": {
        "type": "Url",
        "value": "https://raw.githubusercontent.com/jr-leary7/SCISSORS/master/README.md"
      },
      "technique": "file_exploration"
    }
  ],
  "releases": [
    {
      "confidence": 1,
      "result": {
        "author": {
          "name": "jr-leary7",
          "type": "User"
        },
        "date_created": "2022-11-11T20:51:36Z",
        "date_published": "2022-11-11T20:52:44Z",
        "description": "Adds parallelism to `PrepareData()` and `ReclusterCells()`",
        "html_url": "https://github.com/jr-leary7/SCISSORS/releases/tag/v1.2.0",
        "name": "v1.2.0",
        "release_id": 82854800,
        "tag": "v1.2.0",
        "tarball_url": "https://api.github.com/repos/jr-leary7/SCISSORS/tarball/v1.2.0",
        "type": "Release",
        "url": "https://api.github.com/repos/jr-leary7/SCISSORS/releases/82854800",
        "value": "https://api.github.com/repos/jr-leary7/SCISSORS/releases/82854800",
        "zipball_url": "https://api.github.com/repos/jr-leary7/SCISSORS/zipball/v1.2.0"
      },
      "technique": "GitHub_API"
    },
    {
      "confidence": 1,
      "result": {
        "author": {
          "name": "jr-leary7",
          "type": "User"
        },
        "date_created": "2022-06-04T06:00:18Z",
        "date_published": "2022-06-04T19:13:01Z",
        "description": "Adds support for default `Seurat` log-normalization instead of SCTransform, which in turn allows the package to be used with integrated datasets. Be sure to set `DefaultAssay(obj) <- \"RNA\"` after normalization though! ",
        "html_url": "https://github.com/jr-leary7/SCISSORS/releases/tag/v1.1.0",
        "name": "v1.1.0",
        "release_id": 68647818,
        "tag": "v1.1.0",
        "tarball_url": "https://api.github.com/repos/jr-leary7/SCISSORS/tarball/v1.1.0",
        "type": "Release",
        "url": "https://api.github.com/repos/jr-leary7/SCISSORS/releases/68647818",
        "value": "https://api.github.com/repos/jr-leary7/SCISSORS/releases/68647818",
        "zipball_url": "https://api.github.com/repos/jr-leary7/SCISSORS/zipball/v1.1.0"
      },
      "technique": "GitHub_API"
    },
    {
      "confidence": 1,
      "result": {
        "author": {
          "name": "jr-leary7",
          "type": "User"
        },
        "date_created": "2021-12-30T19:14:31Z",
        "date_published": "2021-12-30T19:15:20Z",
        "description": "First major release!",
        "html_url": "https://github.com/jr-leary7/SCISSORS/releases/tag/v1.0.0",
        "name": "v1.0.0",
        "release_id": 56203230,
        "tag": "v1.0.0",
        "tarball_url": "https://api.github.com/repos/jr-leary7/SCISSORS/tarball/v1.0.0",
        "type": "Release",
        "url": "https://api.github.com/repos/jr-leary7/SCISSORS/releases/56203230",
        "value": "https://api.github.com/repos/jr-leary7/SCISSORS/releases/56203230",
        "zipball_url": "https://api.github.com/repos/jr-leary7/SCISSORS/zipball/v1.0.0"
      },
      "technique": "GitHub_API"
    },
    {
      "confidence": 1,
      "result": {
        "author": {
          "name": "jr-leary7",
          "type": "User"
        },
        "date_created": "2020-09-15T00:49:07Z",
        "date_published": "2020-09-15T22:21:09Z",
        "description": "Added functionality to automatically choose which clusters to run SCISSORS on. ",
        "html_url": "https://github.com/jr-leary7/SCISSORS/releases/tag/v0.0.3.0",
        "release_id": 31360701,
        "tag": "v0.0.3.0",
        "tarball_url": "https://api.github.com/repos/jr-leary7/SCISSORS/tarball/v0.0.3.0",
        "type": "Release",
        "url": "https://api.github.com/repos/jr-leary7/SCISSORS/releases/31360701",
        "value": "https://api.github.com/repos/jr-leary7/SCISSORS/releases/31360701",
        "zipball_url": "https://api.github.com/repos/jr-leary7/SCISSORS/zipball/v0.0.3.0"
      },
      "technique": "GitHub_API"
    },
    {
      "confidence": 1,
      "result": {
        "author": {
          "name": "jr-leary7",
          "type": "User"
        },
        "date_created": "2020-08-29T00:13:04Z",
        "date_published": "2020-08-29T00:14:14Z",
        "description": "This update reflects the improvements made to SCISSORS in the month since the last official release. ",
        "html_url": "https://github.com/jr-leary7/SCISSORS/releases/tag/v0.0.2.0",
        "name": "SCISSORS v0.0.2.0",
        "release_id": 30353998,
        "tag": "v0.0.2.0",
        "tarball_url": "https://api.github.com/repos/jr-leary7/SCISSORS/tarball/v0.0.2.0",
        "type": "Release",
        "url": "https://api.github.com/repos/jr-leary7/SCISSORS/releases/30353998",
        "value": "https://api.github.com/repos/jr-leary7/SCISSORS/releases/30353998",
        "zipball_url": "https://api.github.com/repos/jr-leary7/SCISSORS/zipball/v0.0.2.0"
      },
      "technique": "GitHub_API"
    },
    {
      "confidence": 1,
      "result": {
        "author": {
          "name": "jr-leary7",
          "type": "User"
        },
        "date_created": "2020-08-04T03:00:16Z",
        "date_published": "2020-08-04T03:10:06Z",
        "description": "This is the first pre-release of the Yeh Lab's new SCISSORS method for clustering single cells!",
        "html_url": "https://github.com/jr-leary7/SCISSORS/releases/tag/v0.0.1.0",
        "name": "SCISSORS",
        "release_id": 29254416,
        "tag": "v0.0.1.0",
        "tarball_url": "https://api.github.com/repos/jr-leary7/SCISSORS/tarball/v0.0.1.0",
        "type": "Release",
        "url": "https://api.github.com/repos/jr-leary7/SCISSORS/releases/29254416",
        "value": "https://api.github.com/repos/jr-leary7/SCISSORS/releases/29254416",
        "zipball_url": "https://api.github.com/repos/jr-leary7/SCISSORS/zipball/v0.0.1.0"
      },
      "technique": "GitHub_API"
    }
  ],
  "somef_missing_categories": [
    "acknowledgement",
    "run",
    "download",
    "requirements",
    "contributors",
    "documentation",
    "faq",
    "support",
    "identifier",
    "has_build_file",
    "executable_example"
  ],
  "somef_provenance": {
    "date": "2024-10-04 01:08:43",
    "somef_schema_version": "1.0.0",
    "somef_version": "0.9.5"
  },
  "stargazers_count": [
    {
      "confidence": 1,
      "result": {
        "type": "Number",
        "value": 9
      },
      "technique": "GitHub_API"
    }
  ],
  "usage": [
    {
      "confidence": 1,
      "result": {
        "original_header": "Libraries",
        "parent_header": [
          "Usage"
        ],
        "type": "Text_excerpt",
        "value": "First we\u2019ll need to load our package as well as a couple dependencies.\n\n``` r\nlibrary(dplyr)\nlibrary(Seurat)\nlibrary(ggplot2)\nlibrary(SCISSORS)\n```\n"
      },
      "source": "https://raw.githubusercontent.com/jr-leary7/SCISSORS/master/README.Rmd",
      "technique": "header_analysis"
    },
    {
      "confidence": 1,
      "result": {
        "original_header": "Preprocessing",
        "parent_header": [
          "Usage"
        ],
        "type": "Text_excerpt",
        "value": "Following scRNA-seq tool development tradition, we\u2019ll use the [10X\nGenomics 3,000 PBMCs\ndataset](https://support.10xgenomics.com/single-cell-gene-expression/datasets/1.1.0/pbmc3k)\nas an example of our workflow. The raw reads can be downloaded from\n10X\u2019s site, and processed counts are available in the `SeuratData`\npackage.\n\n``` r\nseu_pbmc <- SeuratData::LoadData(\"pbmc3k\") %>% \n            PrepareData(n.HVG = 4000, \n                        n.PC = 15, \n                        which.dim.reduc = \"umap\", \n                        initial.resolution = 0.4, \n                        use.parallel = FALSE, \n                        random.seed = 629)\n#> [1] \"Running UMAP on 15 principal components\"\n#> [1] \"Found 6 unique clusters\"\n```\n\nVisualizing the broad clusters on our UMAP embedding, we can see a few\nclusters that seem heterogeneous enough to be reclustered.\n\n``` r\nDimPlot(seu_pbmc) + \n  labs(x = \"UMAP 1\", \n       y = \"UMAP 2\", \n       color = \"Louvain\\nCluster\") + \n  theme_classic(base_size = 14) + \n  theme(axis.text = element_blank(), \n        axis.ticks = element_blank())\n```\n\n<img src=\"man/figures/README-umap-broad-cluster-1.png\" width=\"100%\" />\n\nWe estimate silhouette scores for each cell, then visualize the\ndistribution for each broad cluster. Clusters 0, 1, & 3 have decently\nlower median scores than the other clusters.\n\n``` r\nsil_score_df <- ComputeSilhouetteScores(seu_pbmc, avg = FALSE)\nggplot(sil_score_df, aes(x = Cluster, y = Score, fill = Cluster)) + \n  geom_violin(draw_quantiles = 0.5, \n              scale = \"width\", \n              size = 1, \n              show.legend = FALSE) + \n  labs(x = \"Louvain Cluster\", \n       y = \"Silhouette Score\") + \n  theme_classic(base_size = 14) +\n  theme(panel.grid.major.y = element_line(color = \"grey80\"))\n```\n\n<img src=\"man/figures/README-silhouette-dist-1.png\" width=\"100%\" />\n\nLooking at the expression of canonical marker genes allows us to assign\na most-likely celltype identity to each broad cluster. This biological\nknowledge aids in the reclustering process i.e., we know that it\u2019s\nprobably best to recluster clusters 0 & 3 simultaneously, as they\u2019re\nboth composed of T cells. It also gives us some idea of which / how many\ncell subtypes to expect in each cluster, which can improve our\nconfidence in the final results. For example, if we saw 10 subclusters\nin the T cell group it wouldn\u2019t make much sense, as it\u2019s not likely that\nso many T cell subtypes exist in such a small dataset.\n\n``` r\nmarkers <- c(\"CD3G\", \"IL7R\",    # CD4+ T\n             \"LYZ\", \"CD14\",     # CD14+ monocyte\n             \"MS4A1\", \"CD79A\",  # B \n             \"CD8A\",            # CD8+ T\n             \"RHOC\",            # CD16+ monocyte\n             \"NKG7\")            # NK\nVlnPlot(seu_pbmc, \n        features = markers, \n        stack = TRUE, \n        flip = TRUE, \n        fill.by = \"ident\") + \n  labs(y = \"Expression\", \n       fill = \"Louvain\\nCluster\") + \n  theme(axis.title.x = element_blank())\n```\n\n<img src=\"man/figures/README-broad-markers-1.png\" width=\"100%\" />\n\nWe add the broad celltype labels to our clusters, then visualize the\nresults.\n\n``` r\nseu_pbmc@meta.data <- mutate(seu_pbmc@meta.data, \n                             broad_celltype = case_when(seurat_clusters == \"0\" ~ \"CD4+ T\", \n                                                        seurat_clusters == \"1\" ~ \"CD14+ Monocyte\", \n                                                        seurat_clusters == \"2\" ~ \"B\", \n                                                        seurat_clusters == \"3\" ~ \"CD8+ T\", \n                                                        seurat_clusters == \"4\" ~ \"CD16+ Monocyte\", \n                                                        seurat_clusters == \"5\" ~ \"NK\", \n                                                        TRUE ~ NA_character_), \n                             broad_celltype = factor(broad_celltype, levels = c(\"CD4+ T\", \n                                                                                \"CD8+ T\", \n                                                                                \"NK\", \"B\", \n                                                                                \"CD14+ Monocyte\", \n                                                                                \"CD16+ Monocyte\")))\nDimPlot(seu_pbmc, group.by = \"broad_celltype\") + \n  labs(x = \"UMAP 1\", \n       y = \"UMAP 2\", \n       color = \"Broad Celltype\") + \n  theme_classic(base_size = 14) + \n  theme(axis.text = element_blank(), \n        axis.ticks = element_blank(), \n        plot.title = element_blank())\n```\n\n<img src=\"man/figures/README-broad-celltypes-1.png\" width=\"100%\" />\n"
      },
      "source": "https://raw.githubusercontent.com/jr-leary7/SCISSORS/master/README.Rmd",
      "technique": "header_analysis"
    },
    {
      "confidence": 1,
      "result": {
        "original_header": "Reclustering",
        "parent_header": [
          "Usage"
        ],
        "type": "Text_excerpt",
        "value": "Now that we have an idea of which clusters are poorly fit, as well as a\ngeneral idea of which celltypes are which, we\u2019re ready to do some\nsubclustering. We\u2019ll start with the T cells; since we know that CD4+ and\nCD8+ T cells are fairly similar, we\u2019ll recluster them together.\n\n``` r\nt_reclust <- ReclusterCells(seu_pbmc, \n                            which.clust = c(0, 3), \n                            merge.clusters = TRUE, \n                            k.vals = c(30, 40, 50), \n                            resolution.vals = c(.2, .3, .4), \n                            n.HVG = 4000, \n                            n.PC = 15, \n                            use.parallel = FALSE, \n                            redo.embedding = TRUE, \n                            random.seed = 312)\n#> [1] \"Reclustering cells in clusters 0, 3 using k = 50 & resolution = 0.3; S = 0.263\"\nDimPlot(t_reclust) + \n  labs(x = \"UMAP 1\", \n       y = \"UMAP 2\", \n       color = \"Louvain\\nSubcluster\") + \n  theme_classic(base_size = 14) + \n  theme(axis.text = element_blank(), \n        axis.ticks = element_blank())\n```\n\n<img src=\"man/figures/README-t-reclust-1.png\" width=\"100%\" />\n\nSome canonical T-cell subtype markers help us to differentiate between\nthe subclusters. Cluster 0 houses Naive CD4+ T-cells, and Memory CD4+\nT-cells are located in cluster 1. The CD8+ T-cells are split into\neffector & memory subpopulations in clusters 2 and 3, respectively.\n\n``` r\ntcell_markers <- c(\"CCR7\", \"S100A4\", \"IL7R\", \"CD44\",  # CD4+ T\n                   \"CD8B\", \"GZMB\", \"FGFBP2\", \"CD8A\",  # effector CD8+ T\n                   \"GZMK\", \"NCR3\", \"KLRB1\", \"AQP3\")   # memory CD8+ T\nVlnPlot(t_reclust, \n        features = tcell_markers, \n        stack = TRUE, \n        fill.by = \"ident\", \n        flip = TRUE) + \n  labs(y = \"Expression\", \n       fill = \"Louvain\\nSubcluster\") + \n  theme(axis.title.x = element_blank())\n```\n\n<img src=\"man/figures/README-reclust-markers-1.png\" width=\"100%\" />\n\nAfter integrating the subcluster labels back into the full dataset with\n`IntegrateSubclusters()`, we add new finer-resolution celltype labels to\nthe cells & visualize the results on the original UMAP embedding.\n\n``` r\nseu_pbmc <- IntegrateSubclusters(seu_pbmc, reclust.results = t_reclust)\nseu_pbmc@meta.data <- mutate(seu_pbmc@meta.data, \n                             fine_celltype = case_when(seurat_clusters == \"1\" ~ \"CD14+ Monocyte\", \n                                                       seurat_clusters == \"2\" ~ \"B\", \n                                                       seurat_clusters == \"3\" ~ \"Memory CD8+ T\", \n                                                       seurat_clusters == \"4\" ~ \"CD16+ Monocyte\", \n                                                       seurat_clusters == \"5\" ~ \"NK\", \n                                                       seurat_clusters == \"6\" ~ \"Naive CD4+ T\", \n                                                       seurat_clusters == \"7\" ~ \"Memory CD4+ T\", \n                                                       seurat_clusters == \"8\" ~ \"Effector CD8+ T\", \n                                                       TRUE ~ NA_character_))\nDimPlot(seu_pbmc, group.by = \"fine_celltype\") + \n  labs(x = \"UMAP 1\", \n       y = \"UMAP 2\", \n       color = \"Fine Celltype\") + \n  theme_classic(base_size = 14) + \n  theme(axis.text = element_blank(), \n        axis.ticks = element_blank(), \n        plot.title = element_blank())\n```\n\n<img src=\"man/figures/README-integrate-reclust-1.png\" width=\"100%\" />\n\nLastly, we can use the `FindSpecificMarkers()` function to identify\npotential marker genes that are specific (in the statistical sense) to\neach cluster, which we accomplish by filtering the set of all DE genes\nagainst a list of genes that are highly expressed in other clusters.\nThis can be helpful in putting together gene sets for pathway analyses,\ncelltype classifiers, etc., though it does have the drawback of\nfiltering out some canonical markers that are highly expressed in more\nthan one celltype - for example **FCGR3A**, which is highly expressed in\nboth CD16+ monocytes and NK cells, is removed in these DE results. We\npull the top 3 marker genes by mean log2FC for each celltype, then plot\ntheir expression. Note: the results from this function are pre-filtered\nto only include genes with adjusted *p*-values lower than some target\nthreshold; the default is 0.05.\n\n``` r\nde_specific <- FindSpecificMarkers(seu_pbmc, \n                                   ident.use = \"fine_celltype\", \n                                   perc.cutoff = 0.95)\nde_specific_top3 <- de_specific %>% \n                    mutate(cluster = as.character(cluster)) %>% \n                    arrange(cluster, desc(avg_log2FC)) %>% \n                    with_groups(cluster, \n                                slice_head, \n                                n = 3)\nDotPlot(seu_pbmc, \n        assay = \"RNA\", \n        features = unique(de_specific_top3$gene), \n        dot.scale = 8, \n        group.by = \"fine_celltype\") + \n  coord_flip() + \n  theme_classic(base_size = 14) + \n  theme(axis.text.x = element_text(angle = 45, hjust = 0.95, vjust = 0.95), \n        axis.title = element_blank())\n```\n\n<img src=\"man/figures/README-spec-markers-1.png\" width=\"100%\" />\n"
      },
      "source": "https://raw.githubusercontent.com/jr-leary7/SCISSORS/master/README.Rmd",
      "technique": "header_analysis"
    }
  ]
}