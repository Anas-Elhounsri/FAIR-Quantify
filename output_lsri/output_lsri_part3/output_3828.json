{
  "application_domain": [
    {
      "confidence": 25.73,
      "result": {
        "type": "String",
        "value": "Computer Vision"
      },
      "technique": "supervised_classification"
    }
  ],
  "code_repository": [
    {
      "confidence": 1,
      "result": {
        "type": "Url",
        "value": "https://github.com/prabhakarlab/scConsensus"
      },
      "technique": "GitHub_API"
    }
  ],
  "date_created": [
    {
      "confidence": 1,
      "result": {
        "type": "Date",
        "value": "2021-05-03T06:41:52Z"
      },
      "technique": "GitHub_API"
    }
  ],
  "date_updated": [
    {
      "confidence": 1,
      "result": {
        "type": "Date",
        "value": "2022-05-25T15:35:42Z"
      },
      "technique": "GitHub_API"
    }
  ],
  "description": [
    {
      "confidence": 1,
      "result": {
        "type": "String",
        "value": "An approach combining supervised and unsupervised clustering for cell type detection in single-cell RNA-seq data"
      },
      "technique": "GitHub_API"
    },
    {
      "confidence": 0.984037373950536,
      "result": {
        "original_header": "scConsensus",
        "type": "Text_excerpt",
        "value": "An approach combining semi-supervised and unsupervised clustering for cell type annotation in single-cell RNA-seq data \n\n![](images/OverviewFig.png \"Overview of scConsensus\")\n**Overview of scConsensus**: (a) The scConsensus workflow considers two independent cell cluster annotations obtained from any pair of supervised and unsupervised clustering methods. (b) A contingency table is generated to elucidate the overlap of the annotations on the single cell level. A consensus labeling is generated using either an automated method or manual curation by the user. (c) DE genes are computed between all pairs of consensus clusters. Those DE genes are used to re-cluster the data. The refined clusters thus obtained can be annotated with cell type labels.\n \n"
      },
      "source": "https://raw.githubusercontent.com/prabhakarlab/scConsensus/main/README.md",
      "technique": "supervised_classification"
    }
  ],
  "download_url": [
    {
      "confidence": 1,
      "result": {
        "type": "Url",
        "value": "https://github.com/prabhakarlab/scConsensus/releases"
      },
      "technique": "GitHub_API"
    }
  ],
  "forks_count": [
    {
      "confidence": 1,
      "result": {
        "type": "Number",
        "value": 2
      },
      "technique": "GitHub_API"
    }
  ],
  "forks_url": [
    {
      "confidence": 1,
      "result": {
        "type": "Url",
        "value": "https://api.github.com/repos/prabhakarlab/scConsensus/forks"
      },
      "technique": "GitHub_API"
    }
  ],
  "full_name": [
    {
      "confidence": 1,
      "result": {
        "type": "String",
        "value": "prabhakarlab/scConsensus"
      },
      "technique": "GitHub_API"
    }
  ],
  "full_title": [
    {
      "confidence": 1,
      "result": {
        "type": "String",
        "value": "scConsensus"
      },
      "source": "https://raw.githubusercontent.com/prabhakarlab/scConsensus/main/README.md",
      "technique": "regular_expression"
    }
  ],
  "images": [
    {
      "confidence": 1,
      "result": {
        "type": "Url",
        "value": "https://raw.githubusercontent.com/prabhakarlab/scConsensus/main/images/OverviewFig.png"
      },
      "source": "https://raw.githubusercontent.com/prabhakarlab/scConsensus/main/README.md",
      "technique": "regular_expression"
    },
    {
      "confidence": 1,
      "result": {
        "type": "Url",
        "value": "https://raw.githubusercontent.com/prabhakarlab/scConsensus/main/images/Contingency_Table_Final.png"
      },
      "source": "https://raw.githubusercontent.com/prabhakarlab/scConsensus/main/README.md",
      "technique": "regular_expression"
    },
    {
      "confidence": 1,
      "result": {
        "type": "Url",
        "value": "https://raw.githubusercontent.com/prabhakarlab/scConsensus/main/images/Reclustered_DE_edgeR_Heatmap.png"
      },
      "source": "https://raw.githubusercontent.com/prabhakarlab/scConsensus/main/README.md",
      "technique": "regular_expression"
    },
    {
      "confidence": 1,
      "result": {
        "type": "Url",
        "value": "https://raw.githubusercontent.com/prabhakarlab/scConsensus/main/images/FACS_UMAPs.png"
      },
      "source": "https://raw.githubusercontent.com/prabhakarlab/scConsensus/main/README.md",
      "technique": "regular_expression"
    }
  ],
  "installation": [
    {
      "confidence": 1,
      "result": {
        "original_header": "Installing scConsensus",
        "parent_header": [
          "scConsensus"
        ],
        "type": "Text_excerpt",
        "value": "```R\ndevtools::install_github(\"prabhakarlab/scConsensus\")\n```\n\nscConsensus imports the following R packages:\n\n\n* BiocManager \n* edgeR\n* WGCNA\n* GO.db\n* AnnotationDbi\n* preprocessCore\n* mclust\n* ComplexHeatmap\n* circlize\n* reshape2\n* flashClust\n* calibrate\n* dynamicTreeCut\n* irlba\n\nThe data used in the manuscript is deposited [here](https://zenodo.org/record/3637700#.Xjpf3hMzY1J)\n"
      },
      "source": "https://raw.githubusercontent.com/prabhakarlab/scConsensus/main/README.md",
      "technique": "header_analysis"
    }
  ],
  "issue_tracker": [
    {
      "confidence": 1,
      "result": {
        "type": "Url",
        "value": "https://api.github.com/repos/prabhakarlab/scConsensus/issues"
      },
      "technique": "GitHub_API"
    }
  ],
  "keywords": [
    {
      "confidence": 1,
      "result": {
        "type": "String",
        "value": ""
      },
      "technique": "GitHub_API"
    }
  ],
  "license": [
    {
      "confidence": 1,
      "result": {
        "name": "Other",
        "spdx_id": "NOASSERTION",
        "type": "License",
        "url": null,
        "value": null
      },
      "technique": "GitHub_API"
    },
    {
      "confidence": 1,
      "result": {
        "type": "File_dump",
        "value": "YEAR: 2020\nCOPYRIGHT HOLDER: Bobby Ranjan, Florian Schmidt\n"
      },
      "source": "https://raw.githubusercontent.com/prabhakarlab/scConsensus/main/LICENSE",
      "technique": "file_exploration"
    }
  ],
  "name": [
    {
      "confidence": 1,
      "result": {
        "type": "String",
        "value": "scConsensus"
      },
      "technique": "GitHub_API"
    }
  ],
  "owner": [
    {
      "confidence": 1,
      "result": {
        "type": "User",
        "value": "prabhakarlab"
      },
      "technique": "GitHub_API"
    }
  ],
  "programming_languages": [
    {
      "confidence": 1,
      "result": {
        "name": "R",
        "size": 45576,
        "type": "Programming_language",
        "value": "R"
      },
      "technique": "GitHub_API"
    }
  ],
  "readme_url": [
    {
      "confidence": 1,
      "result": {
        "type": "Url",
        "value": "https://raw.githubusercontent.com/prabhakarlab/scConsensus/main/README.md"
      },
      "technique": "file_exploration"
    }
  ],
  "somef_missing_categories": [
    "citation",
    "acknowledgement",
    "run",
    "download",
    "requirements",
    "contact",
    "contributors",
    "documentation",
    "faq",
    "support",
    "identifier",
    "has_build_file",
    "executable_example"
  ],
  "somef_provenance": {
    "date": "2024-10-06 14:12:59",
    "somef_schema_version": "1.0.0",
    "somef_version": "0.9.5"
  },
  "stargazers_count": [
    {
      "confidence": 1,
      "result": {
        "type": "Number",
        "value": 1
      },
      "technique": "GitHub_API"
    }
  ],
  "usage": [
    {
      "confidence": 1,
      "result": {
        "original_header": "Example on 26k FACS-sorted PBMC data from Zheng et al. 2017",
        "parent_header": [
          "scConsensus"
        ],
        "type": "Text_excerpt",
        "value": "We ran Seurat and RCA on 26k FACS-sorted PBMCs from [Zheng et al. 2017](https://www.nature.com/articles/ncomms14049). The Seurat and RCA results are used as input for scConsensus. These objects are available [here](https://zenodo.org/record/3637700#.Xjpf3hMzY1J) - download the *pbmc_26k_S.v3.Filtered.rds* and *pbmc_26k_rca_obj.rds* files.\n\n```R\n# Load the Seurat and RCA objects...\nseuratObj <- readRDS(\"pbmc_26k_S.v3.Filtered.rds\")\nrca2Obj <- readRDS(\"pbmc_26k_rca_obj.rds\")\n\n\n# Assigning cell type names to Seurat clusters\nseurat_numbers <- as.character(seuratObj$RNA_snn_res.0.2)\nnames(seurat_numbers) <- colnames(seuratObj)\nunique_seurat_numbers <- as.character(sort(as.numeric(unique(seurat_numbers))))\nnames(unique_seurat_numbers) <- c(\"CD4_T-Memory\", \"CD4_T-Naive\", \"CD8_T-Naive\", \"B_Cells\", \"NK_Cells\", \"CD14_Monocytes\", \"CD34_Cells\", \"CD8_T-Cytotoxic\", \"CD34_Cells\", \"mDC\", \"pDC\", \"Unknown\")\nseurat_celltypes <- c()\nfor(num in unique_seurat_numbers) {\n    seurat_celltypes[which(seurat_numbers == num)] <- names(which(unique_seurat_numbers == num))\n}\n\n# Assigning cell type names to RCA clusters\nrca_colors <- rca2Obj$clustering.out$dynamicColorsList$`deepSplit 1`\nrca_colors_ds4 <- rca2Obj$clustering.out$dynamicColorsList$`deepSplit 4`\nnames(rca_colors_ds4) <- colnames(seuratObj)\n\nunique_rca_colors <- unique(rca_colors)\nunique_rca_celltypes <- c(\"red\" = \"CD8_T-Cytotoxic\", \"blue\" = \"NK_Cells\", \"black\" = \"DC\", \"turquoise\" = \"T_Cells\", \"pink\" = \"NK_Cells\", \"yellow\" = \"CD14_Monocytes\", \"magenta\" = \"B_Cells\", \"green\" = \"CD34_Cells\", \"brown\" = \"B_Cells\")\n\nrca_celltypes <- c()\nfor(color in unique_rca_colors) {\n    rca_celltypes[which(rca_colors == color)] <- unique_rca_celltypes[color]\n}\n\nnames(rca_celltypes) <- colnames(seuratObj)\n\nrca_celltypes[names(rca_colors_ds4)[which(rca_colors_ds4 == \"salmon\")]] <- \"CD8_T-Cytotoxic\"\nrca_celltypes[names(rca_colors_ds4)[which(rca_colors_ds4 == \"royalblue\")]] <- \"T_Reg\"\nrca_celltypes[names(rca_colors_ds4)[which(rca_colors_ds4 %in% c(\"white\", \"cyan\", \"darkred\", \"green\"))]] <- \"CD8_T-Naive\"\nrca_celltypes[names(rca_colors_ds4)[which(rca_colors_ds4 %in% c(\"purple\", \"lightcyan\", \"blue\", \"violet\", \"lightyellow\"))]] <- \"CD4_T-Helper\"\nrca_celltypes[names(rca_colors_ds4)[which(rca_colors_ds4 == \"turquoise\")]] <- \"CD4_T-Naive\"\nrca_celltypes[names(rca_colors_ds4)[which(rca_colors_ds4 %in% c(\"darkmagenta\", \"lightsteelblue1\", \"darkgreen\", \"darkturquoise\"))]] <- \"CD34_Cells\"\nrca_celltypes[which(is.na(rca_celltypes))] <- \"Unknown\"\n\n```\n"
      },
      "source": "https://raw.githubusercontent.com/prabhakarlab/scConsensus/main/README.md",
      "technique": "header_analysis"
    },
    {
      "confidence": 1,
      "result": {
        "original_header": "Obtaining the consensus cluster labels",
        "parent_header": [
          "scConsensus",
          "Example on 26k FACS-sorted PBMC data from Zheng et al. 2017"
        ],
        "type": "Text_excerpt",
        "value": "Using the Seurat and RCA cell type labels, we plot a contingency table using the `plotContingencyTable` function:\n\n```R\n# Plot the contingency table\nscRes <- plotContingencyTable(cluster_labels_1 = seurat_celltypes, cluster_labels_2 = rca_celltypes, filename = \"Contingency_Table.pdf\")\n```\n\nFor this dataset, we manually consolidated the 2 clustering outputs to obtain a consensus set of cluster labels in the following manner:\n\n```R\n# Get consensus cluster labels\nnames(seurat_celltypes) <- colnames(seuratObj)\n\nconsensusClusterLabels <- seurat_celltypes\n\nconsensusClusterLabels[names(which(seurat_celltypes == \"pDC\" & rca_celltypes == \"CD34_Cells\"))] <- \"CD34_Cells\"\nconsensusClusterLabels[names(which(seurat_celltypes == \"CD34_Cells\" & rca_celltypes == \"DC\"))] <- \"CD34_Cells\"\n\nconsensusClusterLabels[names(which(rca_celltypes == \"T_Reg\"))] <- \"T_Reg\"\n \nconsensusClusterLabels <- consensusClusterLabels[colnames(seuratObj)]\n\n```\n\n![](images/Contingency_Table_Final.png \"Contingency Table\")\n\n**Contingency Table**: Consensus matrix of cell type  annotation for PBMC data.Columns show  cell type labels based on supervised clustering with RCA, rows show cell type labels based on unsupervised clusters using Seurat and a subsequent marker based annotation. The most informative labelling could be obtained by combining both annotations, e.g. the immune cell annotation derived from Seurat clustering and the Progenitor annotation derived by RCA.\n"
      },
      "source": "https://raw.githubusercontent.com/prabhakarlab/scConsensus/main/README.md",
      "technique": "header_analysis"
    },
    {
      "confidence": 1,
      "result": {
        "original_header": "DE Gene Refinement of Cluster Labels",
        "parent_header": [
          "scConsensus",
          "Example on 26k FACS-sorted PBMC data from Zheng et al. 2017"
        ],
        "type": "Text_excerpt",
        "value": "After obtaining the consensus cluster labels, we further refine this clustering by selecting the top DE genes between every pair of clusters, after filtering out genes that were lowly expressed.\n\n```R\nseurat.data <- seuratObj@assays$RNA@data\n\nseurat.data <- seurat.data[rowSums(seurat.data>0)>100, ]\n\ndeObj <- reclusterDEConsensus(dataMatrix = seurat.data, consensusClusterLabels = consensusClusterLabels, method = \"edgeR\", qValThrs = 0.01, fcThrs = 2, meanScalingFactor = 2, deepSplitValues = 1:4, minClusterSize = 10, filename = \"Reclustered_DE_edgeR.rds\", plotName = \"Reclustered_DE_edgeR_Heatmap.pdf\")\n```\n![](images/Reclustered_DE_edgeR_Heatmap.png \"DE Gene Heatmap with Cluster Labels\")\n**DE Gene Heatmap with Cluster Labels**: The black and white rows indicate the consensus cluster labels that were used to call DE genes, while the color bars indicate the different depths of hierarchical clusters that were obtained by reclustering the cells using these DE genes.\n\nWe then annotated the resulting cluster labels by assigning cell type names to clusters based on the DE heatmap\n\n```R\n# Annotate DE gene clusters\nde_colors <- deObj$dynamicColors$`deepsplit: 3`\n\n# de_colors_ds_4 <- pca_dynamicColorsList$`deepsplit: 4`\n# names(de_colors_ds_4) <- colnames(seurat.data)\n\nunique_de_colors <- c(\"CD14_Monocytes\" = \"midnightblue\", \"CD14_Monocytes\" = \"magenta\", \"CD14_Monocytes\" = \"lightgreen\", \"CD14_Monocytes\" = \"darkgreen\", \"CD34_Cells\" = \"darkred\", \"B_Cells\" = \"grey60\", \"B_Cells\" = \"yellow\", \"CD34_Cells\" = \"purple\", \"CD34_Cells\" = \"royalblue\", \"CD34_Cells\" = \"lightcyan\", \"NK_Cells\" = \"pink\", \"NK_Cells\" = \"greenyellow\", \"CD8_T-Naive\" = \"blue\", \"CD8_T-Naive\" = \"red\", \"CD4_T-Naive\" = \"green\", \"T_Reg\" = \"salmon\", \"CD4_T-Naive\" = \"brown\", \"CD8_T-Cytotoxic\" = \"lightyellow\", \"CD8_T-Cytotoxic\" = \"tan\", \"T_Reg\" = \"cyan\", \"CD4_T-Memory\" = \"turquoise\", \"T_Reg\" = \"black\")\n\nde_celltypes <- c()\nfor(i in seq_along(unique_de_colors)) {\n    de_celltypes[which(de_colors == unique_de_colors[i])] <- names(unique_de_colors)[i]\n}\nnames(de_celltypes) <- colnames(seurat.data)\n```\n"
      },
      "source": "https://raw.githubusercontent.com/prabhakarlab/scConsensus/main/README.md",
      "technique": "header_analysis"
    },
    {
      "confidence": 1,
      "result": {
        "original_header": "Visualizing the results in a UMAP (not part of scConsensus)",
        "parent_header": [
          "scConsensus",
          "Example on 26k FACS-sorted PBMC data from Zheng et al. 2017"
        ],
        "type": "Text_excerpt",
        "value": "To visualize these cells as a UMAP, we computed the top 30 upregulated genes in each FACS-labelled cell type and used these DE genes as features for an unbiased feature space.\n\n```R\nIdents(seuratObj) <- \"orig.ident\"\n\nfacs.de.markers <- FindAllMarkers(object = seuratObj, min.pct = 0.75, logfc.threshold = 0.25, only.pos = T)\n\ntop30.facs.de.markers <- facs.de.markers %>% group_by(cluster) %>% top_n(n = 30, wt = avg_logFC)\n\npca.obj <- irlba::prcomp_irlba(x = t(seurat.data[unique(top30.facs.de.markers$gene),]), n = 15, center = TRUE, scale. = FALSE)\npca.data <- pca.obj$x[, 1:8]\n\numap.data <- umap::umap(d = pca.data)\numap.df <- as.data.frame(umap.data$layout)\ncolnames(umap.df) <- c(\"UMAP1\", \"UMAP2\")\numap.df$scConsensus <- de_celltypes\numap.df$FACS_Labels <- facs_celltypes\numap.df$Seurat <- seurat_facs_matched_celltypes\numap.df$RCA <- rca_facs_matched_celltypes\n```\n\n![](images/FACS_UMAPs.png \"FACS PBMC UMAPs\")\n**UMAP visualization**: PBMCs colored by Seurat, RCA and scConsensus as compared to the FACS labels.\n"
      },
      "source": "https://raw.githubusercontent.com/prabhakarlab/scConsensus/main/README.md",
      "technique": "header_analysis"
    }
  ]
}