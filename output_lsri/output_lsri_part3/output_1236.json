{
  "citation": [
    {
      "confidence": 1,
      "result": {
        "original_header": "Citation",
        "parent_header": [
          "cDNA-detector"
        ],
        "type": "Text_excerpt",
        "value": "If you use the tool in your work, please cite:\n> Qi M, Nayar U, Ludwig LS, Wagle N, Rheinbay E. 2021. [cDNA-detector: Detection and removal of cDNA contamination in DNA sequencing libraries](http://dx.doi.org/10.1101/2021.08.11.455962). bioRxiv doi: 10.1101/2021.08.11.455962\n"
      },
      "source": "https://raw.githubusercontent.com/rheinbaylab/cDNA-detector/master/README.md",
      "technique": "header_analysis"
    }
  ],
  "code_repository": [
    {
      "confidence": 1,
      "result": {
        "type": "Url",
        "value": "https://github.com/rheinbaylab/cDNA-detector"
      },
      "technique": "GitHub_API"
    }
  ],
  "date_created": [
    {
      "confidence": 1,
      "result": {
        "type": "Date",
        "value": "2021-04-21T18:52:20Z"
      },
      "technique": "GitHub_API"
    }
  ],
  "date_updated": [
    {
      "confidence": 1,
      "result": {
        "type": "Date",
        "value": "2022-10-30T11:14:45Z"
      },
      "technique": "GitHub_API"
    }
  ],
  "description": [
    {
      "confidence": 1,
      "result": {
        "type": "String",
        "value": "Detect and remove cDNA contamination in DNA sequencing data"
      },
      "technique": "GitHub_API"
    },
    {
      "confidence": 0.8739629686048788,
      "result": {
        "original_header": "cDNA-detector",
        "type": "Text_excerpt",
        "value": "Detect and remove cDNA contamination in DNA sequencing experiments (ATAC-Seq, ChIP-Seq, WES, etc.) \n"
      },
      "source": "https://raw.githubusercontent.com/rheinbaylab/cDNA-detector/master/README.md",
      "technique": "supervised_classification"
    },
    {
      "confidence": 0.9847141510505568,
      "result": {
        "original_header": "General overview",
        "type": "Text_excerpt",
        "value": "`cdna-detector` is a Python tool for detecting and removing contaminating cDNA from vectors and other sources in DNA-Seq data (ATAC-Seq, ChIP-Seq, WES, etc). The tool analyzes BAM formatted alignment files (coordinate-sorted), detects candidate contaminant cDNAs and, if desired, removes suspected contaminant reads from BAM files.\n \n"
      },
      "source": "https://raw.githubusercontent.com/rheinbaylab/cDNA-detector/master/README.md",
      "technique": "supervised_classification"
    }
  ],
  "download_url": [
    {
      "confidence": 1,
      "result": {
        "type": "Url",
        "value": "https://github.com/rheinbaylab/cDNA-detector/releases"
      },
      "technique": "GitHub_API"
    }
  ],
  "forks_count": [
    {
      "confidence": 1,
      "result": {
        "type": "Number",
        "value": 1
      },
      "technique": "GitHub_API"
    }
  ],
  "forks_url": [
    {
      "confidence": 1,
      "result": {
        "type": "Url",
        "value": "https://api.github.com/repos/rheinbaylab/cDNA-detector/forks"
      },
      "technique": "GitHub_API"
    }
  ],
  "full_name": [
    {
      "confidence": 1,
      "result": {
        "type": "String",
        "value": "rheinbaylab/cDNA-detector"
      },
      "technique": "GitHub_API"
    }
  ],
  "full_title": [
    {
      "confidence": 1,
      "result": {
        "type": "String",
        "value": "cDNA-detector"
      },
      "source": "https://raw.githubusercontent.com/rheinbaylab/cDNA-detector/master/README.md",
      "technique": "regular_expression"
    }
  ],
  "has_script_file": [
    {
      "confidence": 1,
      "result": {
        "type": "Url",
        "value": "https://raw.githubusercontent.com/rheinbaylab/cDNA-detector/master/scripts/detect/f_blastn_source_inference.sh"
      },
      "technique": "file_exploration"
    },
    {
      "confidence": 1,
      "result": {
        "type": "Url",
        "value": "https://raw.githubusercontent.com/rheinbaylab/cDNA-detector/master/data/blastn_database/f_create_blastn_databases.sh"
      },
      "technique": "file_exploration"
    }
  ],
  "installation": [
    {
      "confidence": 1,
      "result": {
        "original_header": "Installation",
        "parent_header": [
          "cDNA-detector"
        ],
        "type": "Text_excerpt",
        "value": "```\ngit clone https://github.com/rheinbaylab/cDNA-detector.git\ncd cDNA-detector\nchmod a+x cdna-detector.py\n```\n\nThen add cdna-detector into your PATH.\n\n"
      },
      "source": "https://raw.githubusercontent.com/rheinbaylab/cDNA-detector/master/README.md",
      "technique": "header_analysis"
    },
    {
      "confidence": 1,
      "result": {
        "original_header": "1. prepare: Generate gene model file [optional]",
        "parent_header": [
          "cDNA-detector",
          "Usage"
        ],
        "type": "Text_excerpt",
        "value": "`cdna-detector` relies on a species and assembly-specific gene model file to search for possible contaminant genes. We provide gene models for hg19/hg38/mm10 with this distribution. The 'prepare' step is thus only required for other species/assemblies or custom amplicon sets. The gene model file needs to be created only once. \nBuilt-in gene models are\n```\nhg19\nhg38\nhg19_nochr\nhg38_nochr\nmm10\nmm39\n```\nGene models `hg19_nochr` and `hg38_nochr` are used for reference genomes where chromosome names do not start with \"chr\"."
      },
      "source": "https://raw.githubusercontent.com/rheinbaylab/cDNA-detector/master/README.md",
      "technique": "header_analysis"
    },
    {
      "confidence": 1,
      "result": {
        "original_header": "Human hg19/hg38",
        "parent_header": [
          "cDNA-detector",
          "Usage",
          "1. prepare: Generate gene model file [optional]"
        ],
        "type": "Text_excerpt",
        "value": "Gene models ready for use are provided in diretory `data/gene_model`. \nAnd hg19/hg38 are equivalent to gene model files in the directory. Please see section 2 for usage examples. \n"
      },
      "source": "https://raw.githubusercontent.com/rheinbaylab/cDNA-detector/master/README.md",
      "technique": "header_analysis"
    },
    {
      "confidence": 1,
      "result": {
        "original_header": "Mouse mm10/mm39",
        "parent_header": [
          "cDNA-detector",
          "Usage",
          "1. prepare: Generate gene model file [optional]"
        ],
        "type": "Text_excerpt",
        "value": "Gene models are generated in diretory `data/gene_model`. \nUsers can use these files directly. And mm10/mm39 is equivalent to gene model file in the directory.\n"
      },
      "source": "https://raw.githubusercontent.com/rheinbaylab/cDNA-detector/master/README.md",
      "technique": "header_analysis"
    },
    {
      "confidence": 1,
      "result": {
        "original_header": "Other species/assemblies",
        "parent_header": [
          "cDNA-detector",
          "Usage",
          "1. prepare: Generate gene model file [optional]"
        ],
        "type": "Text_excerpt",
        "value": "**usage**\n```\ncdna-detector.py prepare --annotation <gtf/bed> --genome <genome sequenc filee>  [options]\n```\n**example**\n```\ncd cDNA-detector/\ncdna-detector  prepare --annotation  example_data/gtf_example/test.gtf --output_dir example_data/output_prepare --genome  example_data/test_genome/test_genome.fa\n```\n\n**Input parameters**\n```\nusage: cdna-detector.py prepare --annotation <gtf/bed> --genome <genome sequence file>  [options]\n\nrequired arguments:\n  --annotation          gene annotation files\n                        input format: gtf/bed\n  --genome              genome fasta file\n                        input format: fa/fasta\n\noptional arguments:\n  -h, --help            show this help message and exit\n  --format              input annotation format: gtf or bed\n                         If format is \"bed\", only 3 or 4 columns will be used.\n                        - default: gtf\n  --output_dir          output directory\n                        - default: .\n  --chr_exclude         exclude chromosomes, multiple chromosomes are separated by \",\"\n                        - conflict with --chr_include\n                        - default: chrM\n                        - example: --chr_exclude chrX,chrY,chrM\n  --chr_include         only include chromosomes, multiple chromosomes are separated by \",\"\n                        - conflict with --chr_exclude\n                        - example: --chr_include chr1,chr2\n  --source              the program that generated this feature, it is located in 2nd column of gtf. multiple sources are separated by \",\"\n                        - default: all source\n                        - example: --source havana\n  --feature_type_cds    feature name for identifying CDS regions. It is located in 3rd column of gtf. Multiple features are separated by \",\"\n                        - default: CDS\n  --featureid_gene_id   attribute to show gene id. \n                        - default: gene_id\n  --featureid_gene_name \n                        attribute to show gene name. \n                        - default: gene_name\n  --featureid_cds_ranking \n                        attribute to show exon number.\n                        - default exon_number\n  --featureid_transcript_id \n                        attribute to show transcript id. \n                        - default transcript_id\n```\n`annotation` input file can be in GTF or BED format, `genome` is the genome sequence. The chromosome names in the genome sequences must be consistent with chromosome names in GTF/BED files.\nIf the input file is in BED format, only the first 3 or 4 columns will be required and used. Details can be found in [BED format](https://genome.ucsc.edu/FAQ/FAQformat.html#format1.com).\n\nBy default, chrM is excluded due to high read accumulation in sequencing experiments. It can be added back to the analysis workflow with `--chr_include chrM`.\n\n\n**Output files**\n\n1. `GtfFileName.saf`: Gene model file. This file contains gene exon regions and boundary positions. This files is required for step `detect`.\n2. `GtfFileName.prepare.log`: Log file.\n\nHere are the first several lines of the file `GtfFileName.saf`.\n\n| seqname | start  | end    | gene_id | gene_name | transcript_id | exon_flank_start20   | exon_flank_end20     | is_exon_boundary_start | is_exon_boundary_end | exon_boundary_start_nearseq20 | exon_boundary_end_nearseq20 |\n|---------|--------|--------|---------|-----------|---------------|----------------------|----------------------|------------------------|----------------------|-------------------------------|-----------------------------|\n| chr1    | 901912 | 901994 | PLEKHN1 | PLEKHN1   | NM_001160184  | GACCTGTACGACTCTGGCCA | TGAGCGGGGCGTGGGTGCGG | 1                      | 0                    | GAGGACAGCGCGCGGATGTC          |                             |\n| chr1    | 901912 | 901994 | PLEKHN1 | PLEKHN1   | NM_001367552  | GACCTGTACGACTCTGGCCA | TGAGCGGGGCGTGGGTGCGG | 1                      | 0                    | GAGGACAGCGCGCGGATGTC          |                             |\n| chr1    | 901912 | 901994 | PLEKHN1 | PLEKHN1   | NM_032129     | GACCTGTACGACTCTGGCCA | TGAGCGGGGCGTGGGTGCGG | 1                      | 0                    | GAGGACAGCGCGCGGATGTC          |                             |\n| chr1    | 902084 | 902183 | PLEKHN1 | PLEKHN1   | NM_001160184  | CCCCTTGCCTTGTCCCCAGA | TGAGCGCGGCGTGCACGGTG | 0                      | 0                    | CCTCGCTGAAGGGAAACAGG          | ACATCCTGGACCTGGAGAAC        |\n| chr1    | 902084 | 902183 | PLEKHN1 | PLEKHN1   | NM_001367552  | CCCCTTGCCTTGTCCCCAGA | TGAGCGCGGCGTGCACGGTG | 0                      | 0                    | CCTCGCTGAAGGGAAACAGG          | ACATCCTGGACCTGGAGAAC        |\n\nUsers can provide several required columns for exon regions, such as seqname, start, end, gene_id, gene_name, then fill columns `is_exon_boundary_start` and `is_exon_boundary_end` with 0. Fill transcript with transcript id or gene id (If no transcript id.). Leave other columns blank.\n\n"
      },
      "source": "https://raw.githubusercontent.com/rheinbaylab/cDNA-detector/master/README.md",
      "technique": "header_analysis"
    }
  ],
  "issue_tracker": [
    {
      "confidence": 1,
      "result": {
        "type": "Url",
        "value": "https://api.github.com/repos/rheinbaylab/cDNA-detector/issues"
      },
      "technique": "GitHub_API"
    }
  ],
  "keywords": [
    {
      "confidence": 1,
      "result": {
        "type": "String",
        "value": ""
      },
      "technique": "GitHub_API"
    }
  ],
  "license": [
    {
      "confidence": 1,
      "result": {
        "name": "BSD 3-Clause \"New\" or \"Revised\" License",
        "spdx_id": "BSD-3-Clause",
        "type": "License",
        "url": "https://api.github.com/licenses/bsd-3-clause",
        "value": "https://api.github.com/licenses/bsd-3-clause"
      },
      "technique": "GitHub_API"
    },
    {
      "confidence": 1,
      "result": {
        "type": "File_dump",
        "value": "BSD 3-Clause License\n\nCopyright (c) 2020, rheinbaylab\nAll rights reserved.\n\nRedistribution and use in source and binary forms, with or without\nmodification, are permitted provided that the following conditions are met:\n\n1. Redistributions of source code must retain the above copyright notice, this\n   list of conditions and the following disclaimer.\n\n2. Redistributions in binary form must reproduce the above copyright notice,\n   this list of conditions and the following disclaimer in the documentation\n   and/or other materials provided with the distribution.\n\n3. Neither the name of the copyright holder nor the names of its\n   contributors may be used to endorse or promote products derived from\n   this software without specific prior written permission.\n\nTHIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS \"AS IS\"\nAND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE\nIMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE\nDISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE\nFOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL\nDAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR\nSERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER\nCAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY,\nOR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE\nOF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n"
      },
      "source": "https://raw.githubusercontent.com/rheinbaylab/cDNA-detector/master/LICENSE",
      "technique": "file_exploration"
    },
    {
      "confidence": 1,
      "result": {
        "original_header": "License Agreement",
        "parent_header": [
          "cDNA-detector"
        ],
        "type": "Text_excerpt",
        "value": "By using the software, you acknowledge that you agree to the terms below:\n\nFor academic and non-profit use, you are free to fork, download, modify, distribute and use the software without restrictions.\n\nFor commercial use, you are required to contact the authors at Massachusetts General Hospital to discuss licensing options.\n\n"
      },
      "source": "https://raw.githubusercontent.com/rheinbaylab/cDNA-detector/master/README.md",
      "technique": "header_analysis"
    }
  ],
  "name": [
    {
      "confidence": 1,
      "result": {
        "type": "String",
        "value": "cDNA-detector"
      },
      "technique": "GitHub_API"
    }
  ],
  "owner": [
    {
      "confidence": 1,
      "result": {
        "type": "Organization",
        "value": "rheinbaylab"
      },
      "technique": "GitHub_API"
    }
  ],
  "programming_languages": [
    {
      "confidence": 1,
      "result": {
        "name": "Python",
        "size": 168138,
        "type": "Programming_language",
        "value": "Python"
      },
      "technique": "GitHub_API"
    },
    {
      "confidence": 1,
      "result": {
        "name": "Shell",
        "size": 643,
        "type": "Programming_language",
        "value": "Shell"
      },
      "technique": "GitHub_API"
    }
  ],
  "readme_url": [
    {
      "confidence": 1,
      "result": {
        "type": "Url",
        "value": "https://raw.githubusercontent.com/rheinbaylab/cDNA-detector/master/README.md"
      },
      "technique": "file_exploration"
    }
  ],
  "requirements": [
    {
      "confidence": 1,
      "result": {
        "original_header": "Prerequisites",
        "parent_header": [
          "cDNA-detector"
        ],
        "type": "Text_excerpt",
        "value": "`cdna-detector` requires Python3 and blastn. We have tested it in Python 3.7.6 and BLASTN (2.9.0).\n`cdna-detector` also requires the Python modules listed below:\n```\npandas >= 0.23.0\nnumpy >= 1.17.0\nscipy >= 1.1.0\npysam >= 0.15.0\nStatsmodels >= 0.11.1\nBiopython >= 1.77\njoblib >= 0.15.1\ngffpandas >= 0.1.0\n```\nModules can be installed using pip or conda. Note that gffpandas cannot be installed via conda, but is only necessary if generating custom gene model files. \n```\npip install --user pandas numpy scipy pysam statsmodels biopython gffpandas joblib\nconda install -c bioconda blast==2.9.0\n```\nor\n```\nconda install  pandas numpy scipy statsmodels biopython joblib\nconda install -c bioconda pysam\nconda install -c bioconda blast==2.9.0\npip install gffpandas\n```\nGene model files for the hg19 and hg38 human and mm10 mouse genome assemblies are provided with cDNA-detector. The subcommand `prepare` is only necessary when generating gene models for other species, assemblies or custom amplicons.\n"
      },
      "source": "https://raw.githubusercontent.com/rheinbaylab/cDNA-detector/master/README.md",
      "technique": "header_analysis"
    }
  ],
  "somef_missing_categories": [
    "acknowledgement",
    "run",
    "download",
    "contact",
    "contributors",
    "documentation",
    "faq",
    "identifier",
    "has_build_file",
    "executable_example"
  ],
  "somef_provenance": {
    "date": "2024-10-06 04:06:23",
    "somef_schema_version": "1.0.0",
    "somef_version": "0.9.5"
  },
  "stargazers_count": [
    {
      "confidence": 1,
      "result": {
        "type": "Number",
        "value": 2
      },
      "technique": "GitHub_API"
    }
  ],
  "support": [
    {
      "confidence": 1,
      "result": {
        "original_header": "Getting Help",
        "parent_header": [
          "cDNA-detector"
        ],
        "type": "Text_excerpt",
        "value": "If you have any questions, please submit issues via GitHub or send email to mqi3@mgh.harvard.edu.\n"
      },
      "source": "https://raw.githubusercontent.com/rheinbaylab/cDNA-detector/master/README.md",
      "technique": "header_analysis"
    }
  ],
  "type": [
    {
      "confidence": 0.82,
      "result": {
        "type": "String",
        "value": "commandline-application"
      },
      "technique": "software_type_heuristics"
    }
  ],
  "usage": [
    {
      "confidence": 1,
      "result": {
        "original_header": "Usage",
        "parent_header": [
          "cDNA-detector"
        ],
        "type": "Text_excerpt",
        "value": "`cDNA-detector` consists of three steps (subcommands):\n\n1. `prepare`: Generate gene model file [optional]\n2. `detect`: Detect candidate contaminant cDNA in bam file\n3. `clean`: Clean up cDNA in bam file [optional]\n\nDetails and examples are shown below.\n\n"
      },
      "source": "https://raw.githubusercontent.com/rheinbaylab/cDNA-detector/master/README.md",
      "technique": "header_analysis"
    },
    {
      "confidence": 1,
      "result": {
        "original_header": "Human hg19/hg38",
        "parent_header": [
          "cDNA-detector",
          "Usage",
          "1. prepare: Generate gene model file [optional]"
        ],
        "type": "Text_excerpt",
        "value": "Gene models ready for use are provided in diretory `data/gene_model`. \nAnd hg19/hg38 are equivalent to gene model files in the directory. Please see section 2 for usage examples. \n"
      },
      "source": "https://raw.githubusercontent.com/rheinbaylab/cDNA-detector/master/README.md",
      "technique": "header_analysis"
    },
    {
      "confidence": 1,
      "result": {
        "original_header": "Mouse mm10/mm39",
        "parent_header": [
          "cDNA-detector",
          "Usage",
          "1. prepare: Generate gene model file [optional]"
        ],
        "type": "Text_excerpt",
        "value": "Gene models are generated in diretory `data/gene_model`. \nUsers can use these files directly. And mm10/mm39 is equivalent to gene model file in the directory.\n"
      },
      "source": "https://raw.githubusercontent.com/rheinbaylab/cDNA-detector/master/README.md",
      "technique": "header_analysis"
    },
    {
      "confidence": 1,
      "result": {
        "original_header": "Other species/assemblies",
        "parent_header": [
          "cDNA-detector",
          "Usage",
          "1. prepare: Generate gene model file [optional]"
        ],
        "type": "Text_excerpt",
        "value": "**usage**\n```\ncdna-detector.py prepare --annotation <gtf/bed> --genome <genome sequenc filee>  [options]\n```\n**example**\n```\ncd cDNA-detector/\ncdna-detector  prepare --annotation  example_data/gtf_example/test.gtf --output_dir example_data/output_prepare --genome  example_data/test_genome/test_genome.fa\n```\n\n**Input parameters**\n```\nusage: cdna-detector.py prepare --annotation <gtf/bed> --genome <genome sequence file>  [options]\n\nrequired arguments:\n  --annotation          gene annotation files\n                        input format: gtf/bed\n  --genome              genome fasta file\n                        input format: fa/fasta\n\noptional arguments:\n  -h, --help            show this help message and exit\n  --format              input annotation format: gtf or bed\n                         If format is \"bed\", only 3 or 4 columns will be used.\n                        - default: gtf\n  --output_dir          output directory\n                        - default: .\n  --chr_exclude         exclude chromosomes, multiple chromosomes are separated by \",\"\n                        - conflict with --chr_include\n                        - default: chrM\n                        - example: --chr_exclude chrX,chrY,chrM\n  --chr_include         only include chromosomes, multiple chromosomes are separated by \",\"\n                        - conflict with --chr_exclude\n                        - example: --chr_include chr1,chr2\n  --source              the program that generated this feature, it is located in 2nd column of gtf. multiple sources are separated by \",\"\n                        - default: all source\n                        - example: --source havana\n  --feature_type_cds    feature name for identifying CDS regions. It is located in 3rd column of gtf. Multiple features are separated by \",\"\n                        - default: CDS\n  --featureid_gene_id   attribute to show gene id. \n                        - default: gene_id\n  --featureid_gene_name \n                        attribute to show gene name. \n                        - default: gene_name\n  --featureid_cds_ranking \n                        attribute to show exon number.\n                        - default exon_number\n  --featureid_transcript_id \n                        attribute to show transcript id. \n                        - default transcript_id\n```\n`annotation` input file can be in GTF or BED format, `genome` is the genome sequence. The chromosome names in the genome sequences must be consistent with chromosome names in GTF/BED files.\nIf the input file is in BED format, only the first 3 or 4 columns will be required and used. Details can be found in [BED format](https://genome.ucsc.edu/FAQ/FAQformat.html#format1.com).\n\nBy default, chrM is excluded due to high read accumulation in sequencing experiments. It can be added back to the analysis workflow with `--chr_include chrM`.\n\n\n**Output files**\n\n1. `GtfFileName.saf`: Gene model file. This file contains gene exon regions and boundary positions. This files is required for step `detect`.\n2. `GtfFileName.prepare.log`: Log file.\n\nHere are the first several lines of the file `GtfFileName.saf`.\n\n| seqname | start  | end    | gene_id | gene_name | transcript_id | exon_flank_start20   | exon_flank_end20     | is_exon_boundary_start | is_exon_boundary_end | exon_boundary_start_nearseq20 | exon_boundary_end_nearseq20 |\n|---------|--------|--------|---------|-----------|---------------|----------------------|----------------------|------------------------|----------------------|-------------------------------|-----------------------------|\n| chr1    | 901912 | 901994 | PLEKHN1 | PLEKHN1   | NM_001160184  | GACCTGTACGACTCTGGCCA | TGAGCGGGGCGTGGGTGCGG | 1                      | 0                    | GAGGACAGCGCGCGGATGTC          |                             |\n| chr1    | 901912 | 901994 | PLEKHN1 | PLEKHN1   | NM_001367552  | GACCTGTACGACTCTGGCCA | TGAGCGGGGCGTGGGTGCGG | 1                      | 0                    | GAGGACAGCGCGCGGATGTC          |                             |\n| chr1    | 901912 | 901994 | PLEKHN1 | PLEKHN1   | NM_032129     | GACCTGTACGACTCTGGCCA | TGAGCGGGGCGTGGGTGCGG | 1                      | 0                    | GAGGACAGCGCGCGGATGTC          |                             |\n| chr1    | 902084 | 902183 | PLEKHN1 | PLEKHN1   | NM_001160184  | CCCCTTGCCTTGTCCCCAGA | TGAGCGCGGCGTGCACGGTG | 0                      | 0                    | CCTCGCTGAAGGGAAACAGG          | ACATCCTGGACCTGGAGAAC        |\n| chr1    | 902084 | 902183 | PLEKHN1 | PLEKHN1   | NM_001367552  | CCCCTTGCCTTGTCCCCAGA | TGAGCGCGGCGTGCACGGTG | 0                      | 0                    | CCTCGCTGAAGGGAAACAGG          | ACATCCTGGACCTGGAGAAC        |\n\nUsers can provide several required columns for exon regions, such as seqname, start, end, gene_id, gene_name, then fill columns `is_exon_boundary_start` and `is_exon_boundary_end` with 0. Fill transcript with transcript id or gene id (If no transcript id.). Leave other columns blank.\n\n"
      },
      "source": "https://raw.githubusercontent.com/rheinbaylab/cDNA-detector/master/README.md",
      "technique": "header_analysis"
    },
    {
      "confidence": 1,
      "result": {
        "original_header": "2. detect: detecting cDNA contamination in BAM files",
        "parent_header": [
          "cDNA-detector",
          "Usage"
        ],
        "type": "Text_excerpt",
        "value": "`cdna-detector detect` searches for possible cDNA contamination in BAM-formatted sequence alignments using the predefined gene model file. `cdna-detector detect` outputs several files, including original statistics about candidate contaminant exons and genes, high-confidence filtered exons and genes, and coordinate files containing the positions of genes with suspected contaminations for use with the `clean` step.\n\n**Usage**\n```\ncdna-detector detect --bam <bam> --sample_id <sample_id> --gene_model <gene_model> [options]\n```\n**Example**\n```\ncd cDNA-detector/\ncdna-detector detect --bam  example_data/bam_file/tmp.sample.bam --sample_id tmp_sample  --gene_model hg19 --output_dir example_data/output_detect\n```\n\n**Input options**\n\n```\nusage: cdna-detector.py detect --bam <bam> --sample_id <sample_id> --gene_model <gene_model> [options]\n\nrequired arguments:\n  --bam                 The input file is in BAM format. Recommend results from software bwa\n  --sample_id           Identifier. Used as output prefix\n  --gene_model          Link to gene model.\n                         - INPUT: hg19/hg38/mm10/(gene model generated from subcommand \"prepare\")\n\noptional arguments:\n  -h, --help            show this help message and exit\n  --min_quality         Minimum read mapping quality.\n                        - integer\n                        - default: 0\n  --pvalue              significant p values.\n                        - float\n                        - default: 0.05\n  --min_ratio_transcript \n                        minimum ratio of detected exons of one transcript\n                        - float\n                        - default: 0.3\n  --output_dir          output directory\n                        - default: \".\"\n  --n_threads           number of threads\n                        - integer\n                        - default: 1\n  --min_exon_cdna_reads \n                        minimum number of reads which may come from cDNA for each exon.\n                        - integer\n                        - default: 1\n  --exclude_ehc {True,False}\n                        to exclude extremely high coverage of clipped reads for single gene from background calculation.\n                        - string\n                        - default: True\n  --ratio_ehc           cutoff for ratio of extremely high coverage of clipped reads for single gene.\n                        - float\n                        - default: 0.05\n  --count_ehc           cutoff for read count of extremely high coverage of clipped reads for single gene.\n                        - integer\n                        - default: 10000\n  --blastn_database     databases for cDNA source inference.\n                        - default: corresponding databases for build-in gene models or default databases\n  --file_source_known   file represent gene class.\n                        - default: for human, genes from retrocopy and blacklist are listed.\n  --inferred_source_include \n                        only include cDNAs with inferred sources, multiple input are separated by \",\"\n                        - conflict with --inferred_source_exclude\n                        - example: --inferred_source_include vector,unknown\n                        - default: output all cDNAs with inferred sources\n  --inferred_source_exclude \n                        only exclude cDNAs with inference sources, multiple input are separated by \",\"\n                        - conflict with --inferred_source_include\n                        - example: --inferred_source_exclude retrocopy\n                        - default: null value\n  --known_source_include \n                        only include cDNAs with known sources, multiple input are separated by \",\"\n                        - conflict with --known_source_exclude\n                        - example: --known_source_include retrocopy\n                        - default: null value\n  --known_source_exclude \n                        only exclude cDNAs with inference sources, multiple input are separated by \",\"\n                        - conflict with --known_source_include\n                        - example: --known_source_exclude blacklist\n                        - default: blacklist\n```\n\n`gene_model` can be a **hg19**/**hg38**/**mm10**/**hg19_nochr**/**hg38_nochr**/**mm39** gene model provided with this tool or gene model file generated by subcommand `cdna-detector prepare` (see above). Note: Adapter sequences can affect the sensitivity of cDNA-detector. It's recommend to remove adapter sequences in BAM files.\n\n\n**Output files**\n\nIf cDNAs are detected, `cdna-detector detect` outputs several files. If no cDNA is detected in the input, only the `SAMPLE_ID.log` log file will be generated.\nImportant files are explained below:\n\n1. `SAMPLE_ID.log`: log file.\n2. `SAMPLE_ID.gene_statistics.tsv` original statistics for all tested genes.\n3. `SAMPLE_ID.exon_statistics.tsv` original statistics for all tested exons.\n4. `SAMPLE_ID.exon_statistics.filter.tsv` filtered results containing only \"high-confidence\" candidate contaminant exons.\n5. `SAMPLE_ID.gene_statistics.filter.tsv` filtered results containing only \"high-confidence\" candidate contaminant genes.\n6. `SAMPLE_ID.gene_statistics.filtered.source_filtered.tsv`: filtered results containing only \"high-confidence\" candidate contaminant genes from user-defined sources.\n7. `SAMPLE_ID.merge_region.tsv`:  merged exon regions which can be used in the \"clean\" step (see below).\n8. `SAMPLE_ID.merge_region.bed`:  merged exon regions which can be used in IGV for manually checking results.\n9. `SAMPLE_ID.clipped_seq.source_inference.tsv`: Inferred source (vector or retrogene) for each candidate cDNA, if enough evidence is available.\n\n\nFor most cases, users can only check `SAMPLE_ID.gene_statistics.filtered.source_filtered.tsv`, which describes high-confidence cDNAs in the BAM file. It is recommended to review cDNA calls in IGV with `SAMPLE_ID.merge_region.bed`. \n\n**Important Note**: cDNAs where only one exon scored as significant can represent a false positive and should be reviewed.\n\nDescription of columns in `SAMPLE_ID.gene_statistics.tsv`, `SAMPLE_ID.gene_statistics.filter.tsv` and `SAMPLE_ID.gene_statistics.filtered.source_filtered.tsv`:\n\n| column                | description                                                          |\n|---------------------  |----------------------------------------------------------------------|\n| gene_id               | gene id                                                              |\n| gene_name             | gene name                                                            |\n| transcript_id         | transcript id                                                        |\n| num_exon_detected     | number of exons detected                                             |\n| num_exon_transcript   | number of exons in the transcript                                    |\n| ratio                 | ratio of detected exons to all exons in transcript                   |\n| source_inference      | possible source of detected cDNAs inferred by cDNA-detector          |\n| source_known_databases| known source of detected cDNAs defined by users or built-in databases|\n| combined_pvalue       | combined p-value for each transcript                                 |\n| avg_log10pvalue       | average log10 pvalue for each transcript                             |\n| avg_pvalue            | average pvalue for each transcript                                   |\n| avg_cDNA              | average value of possible cDNA reads for each transcript             |\n| median_cDNA           | median value of possible cDNA reads for each transcript              |\n\n\n\n\nDescription of columns in `SAMPLE_ID.exon_statistics.tsv` and `SAMPLE_ID.exon_statistics.filter.tsv`.\n\n| column              | description                                                         |\n|---------------------|---------------------------------------------------------------------|\n| seqname             | chromosome name                                                     |\n| exon_start          | start position of exon                                              |\n| exon_end            | end position of exon                                                |\n| pos_start           | start position of candidate region                                  |\n| pos_end             | end position of candidate region                                    |\n| gene_id             | gene id                                                             |\n| gene_name           | gene name                                                           |\n| transcript          | transcript name                                                     |\n| num_clipped_start   | number of clipped reads overlapping start of candidate region       |\n| num_total_start     | number of total reads at start position of candidate region         |\n| bbinom_pvalue_start | binomial p-value at start position of candidate region             |\n| num_clipped_end     | number of clipped reads at end position of candidate region         |\n| num_total_end       | number of total reads at end position of candidate region           |\n| bbinom_pvalue_end   | binomial p-value at end position of candidate region                |\n| num_bg_clipped      | number of clipped reads in total exon regions (background)          |\n| num_bg_total        | number of total reads in total exon regions (background)            |\n| combine_pvalue      | combined p-value of start and end of candidate regions              |\n| combine_pvalue      | combined q-value of start and end of candidate regions              |\n\n\n\n\n\n"
      },
      "source": "https://raw.githubusercontent.com/rheinbaylab/cDNA-detector/master/README.md",
      "technique": "header_analysis"
    },
    {
      "confidence": 1,
      "result": {
        "original_header": "3. clean up cDNA in BAM file",
        "parent_header": [
          "cDNA-detector",
          "Usage"
        ],
        "type": "Text_excerpt",
        "value": "`cdna-detector clean` utilizes `SAMPLE_ID.merge_region.tsv` generated in the previous step `cdna-detector detect` and the source BAM file, then generates a \"clean\" BAM file by removing identified contaminant reads from candidate regions.\n\n**Usage**\n```\ncdna-detector clean --bam <bam> --region <region_file> --sample_id <sample_id> [options]\n```\n**Example**\n```\ncdna-detector clean --bam example_data/bam_file/tmp.sample.bam  --sample_id tmp_sample --region example_data/output_detect/tmp_sample.merge_region.tsv   --output_dir example_data/output_clean\n```\n**Input options**\n```\nrequired arguments:\n  --bam                 The input file in bam format\n                        - Note: must be sorted (use samtools sort if necessary)\n  --region              files which show contaminated regions\n                        - output \"SAMPLE_ID.merge_region.tsv\" from the \"detect\" step\n  --sample_id           Identifier. Used as output prefix\n\noptional arguments:\n  -h, --help            show this help message and exit\n  --method {automatic,rpm,fraction}\n                        method of removing reads from bam files\n                        - value: automatic (recommended), fraction, rpm\n                        - automatic: estimate cDNA based on cDNA in exon boundaries\n                        - fraction: fraction of reads to keep after cleaning in exon regions\n                        - rpm: reads per million to keep after cleaning in exon regions\n                        - default: automatic\n  --output_dir          output directory\n                        - default: \".\"\n  --gDNA_remove         by default, reads identified as genomic DNA (gDNA) will be kept in exon regions. If the user suspects all reads in a given exon are contaminant reads, add this flag\n```\n\nBy default, `cdna-detector clean` estimates the fraction of cDNA in a candidate region based on cDNA detected in exon boundaries. Sometimes, this is not accurate. In this case, the user has the option to set `method` to rpm or fraction to estimate quantity of cDNA manually (i.e after alignment review in IGV). This can be useful when all reads in a candidate exon regions stem from contaminating cDNA.\n\n```\ncdna-detector clean --bam example_data/bam_file/tmp.sample.bam  --sample_id tmp_sample --region example_data/output_detect/tmp_sample.merge_region.tsv   --output_dir example_data/output_clean\n```\n\n**Output**\n\n`cdna-detector clean` outputs 4 files:\n\n1. `SAMPLEID.clean.log`: log file.\n2. `SAMPLEID.clean.bam`: clean BAM file.\n3. `SAMPLEID.clean.bam`: index for clean BAM file.\n4. `SAMPLEID.clean_region.tsv`: cleaned regions and detailed information about how much cDNA was removed in each region. Useful for manual cDNA removal. [ If `method` is rpm or fraction, this file will not be generated ]\n\nExample `SAMPLEID.clean_region.tsv`.\n\n| seqname | start    | end      | gene_name | rpm                | fraction           |\n|---------|----------|----------|-----------|--------------------|--------------------|\n| chr1    | 11167436 | 11167558 | MTOR      | 3515.5354398240534 | 0.6                |\n| chr1    | 11168234 | 11168344 | MTOR      | 7608.5018214549555 | 0.7173738991192954 |\n| chr1    | 11169344 | 11169427 | MTOR      | 5655.426577108259  | 0.7458006718924972 |\n| chr1    | 11169705 | 11169787 | MTOR      | 1316.20288205973   | 0.6007751937984496 |\n\nWhen the automatic method setting appears incorrect, the user can manually edit fraction or rpm. For example, these values can be set to 0 if there is reason to believe all reads in a given exon stem from contaminating cDNA.\n\nDescription of columns in `SAMPLEID.clean_region.tsv`\n\n| column              | description                                                         |\n|---------------------|---------------------------------------------------------------------|\n| seqname             | chromosome name                                                     |\n| start               | start position of candidate/cleaned region                          |\n| end                 | end position of candidate/cleaned region                            |\n| gene_name           | gene name                                                           |\n| rpm                 | reads per million kept in the clean bam file                        |\n| fraction            | fraction of reads kept in the clean bam file                        |\n"
      },
      "source": "https://raw.githubusercontent.com/rheinbaylab/cDNA-detector/master/README.md",
      "technique": "header_analysis"
    },
    {
      "confidence": 1,
      "result": {
        "original_header": "Getting Help",
        "parent_header": [
          "cDNA-detector"
        ],
        "type": "Text_excerpt",
        "value": "If you have any questions, please submit issues via GitHub or send email to mqi3@mgh.harvard.edu.\n"
      },
      "source": "https://raw.githubusercontent.com/rheinbaylab/cDNA-detector/master/README.md",
      "technique": "header_analysis"
    }
  ]
}