{
  "code_repository": [
    {
      "confidence": 1,
      "result": {
        "type": "Url",
        "value": "https://github.com/elkebir-group/PhySigs"
      },
      "technique": "GitHub_API"
    }
  ],
  "date_created": [
    {
      "confidence": 1,
      "result": {
        "type": "Date",
        "value": "2019-07-28T22:22:48Z"
      },
      "technique": "GitHub_API"
    }
  ],
  "date_updated": [
    {
      "confidence": 1,
      "result": {
        "type": "Date",
        "value": "2022-12-24T23:05:20Z"
      },
      "technique": "GitHub_API"
    }
  ],
  "description": [
    {
      "confidence": 1,
      "result": {
        "type": "String",
        "value": "Phylogenetic inference of exposures of mutational signatures"
      },
      "technique": "GitHub_API"
    },
    {
      "confidence": 0.9808259717440796,
      "result": {
        "original_header": "PhySigs: Phylogenetic Inference of Mutational Signature Dynamics",
        "type": "Text_excerpt",
        "value": "The input to PhySigs is a phylogeny with nodes representing clones in a patient tumor, a signature matrix containing the set of mutational signatures to use in the analysis, and a feature matrix for the set of mutations introduced in each clone. In particular, the mutational categories in the feature matrix should correspond to the mutational categories used in the signature matrix.  Currently, PhySigs supports the standard 96 mutational categories for SNVs for [COSMIC V2](https://cancer.sanger.ac.uk/cosmic/signatures_v2) signatures.    \nPhySigs automatically computes the count matrix, as it is simply a diagonal matrix containing the sum of columns in the feature matrix. PhySigs then solves the Tree-constrained Exposure (TE) problem for all possible clusterings of the clones that correspond to a partition of the phylogeny. The output of the TE problem is a relative exposure matrix composed of groups of identical columns corresponding to clusters of clones with identical exposures (denoted by blue and yellow). Edges between these clusters in the phylogeny are interpreted to be where exposure shifts occurred (denoted by a lightning bolt). PhySigs uses the Bayesian Information Criterion to select the number of clusters that best explain the data (2 clusters depicted). \nThis software corresponds to the paper \"PhySigs: Phylogenetic Inference of Mutational Signature Dynamics\" presented at the 2020 Pacific Symposium on Biocomputing and linked [here](https://psb.stanford.edu/psb-online/proceedings/psb20/Christensen.pdf). Please cite this paper when using the PhySigs software.   \n \n"
      },
      "source": "https://raw.githubusercontent.com/elkebir-group/PhySigs/master/README.md",
      "technique": "supervised_classification"
    }
  ],
  "download_url": [
    {
      "confidence": 1,
      "result": {
        "type": "Url",
        "value": "https://github.com/elkebir-group/PhySigs/releases"
      },
      "technique": "GitHub_API"
    }
  ],
  "executable_example": [
    {
      "confidence": 1,
      "result": {
        "format": "jupyter_notebook",
        "type": "Url",
        "value": "https://raw.githubusercontent.com/elkebir-group/PhySigs/master/results/plots.ipynb"
      },
      "source": "https://raw.githubusercontent.com/elkebir-group/PhySigs/master/results/plots.ipynb",
      "technique": "file_exploration"
    },
    {
      "confidence": 1,
      "result": {
        "format": "jupyter_notebook",
        "type": "Url",
        "value": "https://raw.githubusercontent.com/elkebir-group/PhySigs/master/results/plots_mcpherson.ipynb"
      },
      "source": "https://raw.githubusercontent.com/elkebir-group/PhySigs/master/results/plots_mcpherson.ipynb",
      "technique": "file_exploration"
    },
    {
      "confidence": 1,
      "result": {
        "format": "jupyter_notebook",
        "type": "Url",
        "value": "https://raw.githubusercontent.com/elkebir-group/PhySigs/master/data/simulations/generate_simulations.ipynb"
      },
      "source": "https://raw.githubusercontent.com/elkebir-group/PhySigs/master/data/simulations/generate_simulations.ipynb",
      "technique": "file_exploration"
    }
  ],
  "forks_count": [
    {
      "confidence": 1,
      "result": {
        "type": "Number",
        "value": 1
      },
      "technique": "GitHub_API"
    }
  ],
  "forks_url": [
    {
      "confidence": 1,
      "result": {
        "type": "Url",
        "value": "https://api.github.com/repos/elkebir-group/PhySigs/forks"
      },
      "technique": "GitHub_API"
    }
  ],
  "full_name": [
    {
      "confidence": 1,
      "result": {
        "type": "String",
        "value": "elkebir-group/PhySigs"
      },
      "technique": "GitHub_API"
    }
  ],
  "full_title": [
    {
      "confidence": 1,
      "result": {
        "type": "String",
        "value": "PhySigs: Phylogenetic Inference of Mutational Signature Dynamics"
      },
      "source": "https://raw.githubusercontent.com/elkebir-group/PhySigs/master/README.md",
      "technique": "regular_expression"
    }
  ],
  "images": [
    {
      "confidence": 1,
      "result": {
        "type": "Url",
        "value": "https://raw.githubusercontent.com/elkebir-group/PhySigs/master/overview.png"
      },
      "source": "https://raw.githubusercontent.com/elkebir-group/PhySigs/master/README.md",
      "technique": "regular_expression"
    },
    {
      "confidence": 1,
      "result": {
        "type": "Url",
        "value": "https://raw.githubusercontent.com/elkebir-group/PhySigs/master/example_results.png"
      },
      "source": "https://raw.githubusercontent.com/elkebir-group/PhySigs/master/README.md",
      "technique": "regular_expression"
    }
  ],
  "installation": [
    {
      "confidence": 0.8272936962189362,
      "result": {
        "original_header": "Contents",
        "type": "Text_excerpt",
        "value": "<a name=\"start\"></a>\n \n"
      },
      "source": "https://raw.githubusercontent.com/elkebir-group/PhySigs/master/README.md",
      "technique": "supervised_classification"
    }
  ],
  "issue_tracker": [
    {
      "confidence": 1,
      "result": {
        "type": "Url",
        "value": "https://api.github.com/repos/elkebir-group/PhySigs/issues"
      },
      "technique": "GitHub_API"
    }
  ],
  "keywords": [
    {
      "confidence": 1,
      "result": {
        "type": "String",
        "value": ""
      },
      "technique": "GitHub_API"
    }
  ],
  "name": [
    {
      "confidence": 1,
      "result": {
        "type": "String",
        "value": "PhySigs"
      },
      "technique": "GitHub_API"
    }
  ],
  "owner": [
    {
      "confidence": 1,
      "result": {
        "type": "Organization",
        "value": "elkebir-group"
      },
      "technique": "GitHub_API"
    }
  ],
  "programming_languages": [
    {
      "confidence": 1,
      "result": {
        "name": "Jupyter Notebook",
        "size": 937658,
        "type": "Programming_language",
        "value": "Jupyter Notebook"
      },
      "technique": "GitHub_API"
    },
    {
      "confidence": 1,
      "result": {
        "name": "R",
        "size": 37885,
        "type": "Programming_language",
        "value": "R"
      },
      "technique": "GitHub_API"
    },
    {
      "confidence": 1,
      "result": {
        "name": "Python",
        "size": 592,
        "type": "Programming_language",
        "value": "Python"
      },
      "technique": "GitHub_API"
    }
  ],
  "readme_url": [
    {
      "confidence": 1,
      "result": {
        "type": "Url",
        "value": "https://raw.githubusercontent.com/elkebir-group/PhySigs/master/README.md"
      },
      "technique": "file_exploration"
    }
  ],
  "requirements": [
    {
      "confidence": 1,
      "result": {
        "original_header": "Dependencies",
        "parent_header": [
          "PhySigs: Phylogenetic Inference of Mutational Signature Dynamics",
          "Getting started"
        ],
        "type": "Text_excerpt",
        "value": "PhySigs has the following dependencies to perform signature exposure inference:\n\n* [deconstructSigs](https://cran.r-project.org/web/packages/deconstructSigs/index.html) (>= 1.8.0)\n* [graph](http://www.bioconductor.org/packages/release/bioc/html/graph.html) (>= 1.63)\n\nPhySigs has the following optional dependencies, which may be used to visualize the results:\n\n* [Rgraphviz](https://bioconductor.org/packages/release/bioc/html/Rgraphviz.html) (>= 3.9)\n* [RColorBrewer](https://cran.r-project.org/web/packages/RColorBrewer/index.html) (>= 1.1-2)\n\n<a name=\"usage\"></a>\n"
      },
      "source": "https://raw.githubusercontent.com/elkebir-group/PhySigs/master/README.md",
      "technique": "header_analysis"
    }
  ],
  "somef_missing_categories": [
    "citation",
    "acknowledgement",
    "run",
    "download",
    "contact",
    "contributors",
    "documentation",
    "license",
    "faq",
    "support",
    "identifier",
    "has_build_file"
  ],
  "somef_provenance": {
    "date": "2024-10-06 17:48:03",
    "somef_schema_version": "1.0.0",
    "somef_version": "0.9.5"
  },
  "stargazers_count": [
    {
      "confidence": 1,
      "result": {
        "type": "Number",
        "value": 4
      },
      "technique": "GitHub_API"
    }
  ],
  "usage": [
    {
      "confidence": 1,
      "result": {
        "original_header": "Getting started",
        "parent_header": [
          "PhySigs: Phylogenetic Inference of Mutational Signature Dynamics"
        ],
        "type": "Text_excerpt",
        "value": "PhySigs is written in R. The implementation was develped and tested in R Version 3.6.1. The repository is organized as follows:\n\n| Folder    | DESCRIPTION                                                  |\n| --------- | ------------------------------------------------------------ |\n| `src`     | source code for PhySigs                                      |\n| `data`    | example input data for PhySigs                               |\n| `results` | example code using PhySigs to analyze input data and corresponding results |\n\n<a name=\"dep\"></a>\n"
      },
      "source": "https://raw.githubusercontent.com/elkebir-group/PhySigs/master/README.md",
      "technique": "header_analysis"
    },
    {
      "confidence": 1,
      "result": {
        "original_header": "Usage instructions",
        "parent_header": [
          "PhySigs: Phylogenetic Inference of Mutational Signature Dynamics"
        ],
        "type": "Text_excerpt",
        "value": "Here we walk through the pipeline of how to use PhySigs. The code provided in this tutorial can be found at ./results/example.R. \n\n<a name=\"io\"></a>\n"
      },
      "source": "https://raw.githubusercontent.com/elkebir-group/PhySigs/master/README.md",
      "technique": "header_analysis"
    },
    {
      "confidence": 1,
      "result": {
        "original_header": "I/O formats",
        "parent_header": [
          "PhySigs: Phylogenetic Inference of Mutational Signature Dynamics",
          "Usage instructions"
        ],
        "type": "Text_excerpt",
        "value": "PhySigs takes as input a phylogeny represented as a graph::graphNEL object, with nodes labeled by each clone. It also takes as input a feature matrix whose row labels correspond to the nodes in the phylogeny and whose column labels correspond to mutational categories (e.g. \"A[C>A]A\"). The final input is a character vector containing the names for the subset of COSMIC V2 signatures to include.\n\nAn example of how to set the signature vector.\n\n```R\n# Input subset of COSMIC signatures\nS <- c(\"Signature.1\", \"Signature.3\")\n```\n\nAn example of how to construct the phylogeny from a csv file with rows containing edges of the tumor phylogeny. \n\n```R\n# Input CSV file \ntree_matrix <- read.csv(file=\"../data/example/tree.csv\", header=TRUE, sep=\",\")\n\n# V1/V2 contains clone label for first/second endpoint of edge\nV1 <- as.character(tree_matrix$V1)\nV2 <- as.character(tree_matrix$V2)\n\n# Get nodes in the tree\nnode_ids <- unique(union(V1, V2))\n\n# Initialize a tree \nT <- new(\"graphNEL\", nodes=node_ids, edgemode=\"directed\")\n\n# Add edges to the tree\nfor (i in 1:nrow(tree_matrix)){\n  T <- addEdge(V1[i], V2[i], T, 1)\n}\n```\n\nAn example of how to construct the feature matrix from a CSV file of SNVs.\n\n```R\n# Input CSV file\ninput_mat <- as.data.frame(read.csv(file=\"./data/example/snv.csv\", \n             colClasses = c(\"character\", \"character\", \"numeric\", \"character\", \"character\")))\n\n# Use deconstructSigs to convert SNVs to 96 Features\nP <- mut.to.sigs.input(mut.ref = input_mat, \n                    sample.id = \"Sample\", \n                    chr = \"chr\", \n                    pos = \"pos\", \n                    ref = \"ref\", \n                    alt = \"alt\")\n```\n\n<a name=\"norm\"></a>\n"
      },
      "source": "https://raw.githubusercontent.com/elkebir-group/PhySigs/master/README.md",
      "technique": "header_analysis"
    },
    {
      "confidence": 1,
      "result": {
        "original_header": "normalizeFeatureMatrix",
        "parent_header": [
          "PhySigs: Phylogenetic Inference of Mutational Signature Dynamics",
          "Usage instructions"
        ],
        "type": "Text_excerpt",
        "value": "This function takes as input feature matrix and adjusts the counts based on the trinucleotide context fraction. The backend of this function relies on getTriContextFraction in deconstuctSigs. Possible normalization options include: \"default\", \"genome\", and \"exome\". Please see deconstructSigs [documentation](https://github.com/raerose01/deconstructSigs) for more information on the normalization procedure. \n\n```R\n# Normalize feature matrix\nP_Norm <- normalizeFeatureMatrix(P, \"genome\")\n```\n\n<a name=\"all\"></a>\n"
      },
      "source": "https://raw.githubusercontent.com/elkebir-group/PhySigs/master/README.md",
      "technique": "header_analysis"
    },
    {
      "confidence": 1,
      "result": {
        "original_header": "allTreeExposures",
        "parent_header": [
          "PhySigs: Phylogenetic Inference of Mutational Signature Dynamics",
          "Usage instructions"
        ],
        "type": "Text_excerpt",
        "value": "This function takes as input a phylogeny, the signature vector, and the normalized feature matrix. It returns a list of exposure matrices whose entries correspond to the best partition of the phylogeny for each possible number of clusters. Each exposure matrix has a row for each requested signature and a column for each cluster of clones induced by the partition of the phylogeny. \n\n```R\n# Recover lowest error exposure matrix for every possible number of clusters. \nE_list <- allTreeExposures(T, P_Norm, S)\n```\n\n<a name=\"error\"></a>\n"
      },
      "source": "https://raw.githubusercontent.com/elkebir-group/PhySigs/master/README.md",
      "technique": "header_analysis"
    },
    {
      "confidence": 1,
      "result": {
        "original_header": "getError",
        "parent_header": [
          "PhySigs: Phylogenetic Inference of Mutational Signature Dynamics",
          "Usage instructions"
        ],
        "type": "Text_excerpt",
        "value": "Given a normalized feature matrix, estimated exposures, and signature matrix, this function returns the Frobineous norm between the reconstructed feature matrix and the normalized feature matrix.\n\n```R\n# Get error for exposure matrix from best set of k clusters.\nk <- 1\nerror <- getError(P_Norm, E_list[[k]], S)\n```\n\n<a name=\"bic\"></a>\n"
      },
      "source": "https://raw.githubusercontent.com/elkebir-group/PhySigs/master/README.md",
      "technique": "header_analysis"
    },
    {
      "confidence": 1,
      "result": {
        "original_header": "getBIC",
        "parent_header": [
          "PhySigs: Phylogenetic Inference of Mutational Signature Dynamics",
          "Usage instructions"
        ],
        "type": "Text_excerpt",
        "value": "Given a normalized feature matrix, estimated exposures, and signature matrix, this function returns the Bayesian information criterion based on the error between the reconstructed feature matrix and the normalized feature matrix.\n\n```R\n# Get BIC for exposure matrix from best set of k clusters. \nbic <- getBIC(P_Norm, E_list[[k]], S)\n```\n\n<a name=\"plot\"></a>\n"
      },
      "source": "https://raw.githubusercontent.com/elkebir-group/PhySigs/master/README.md",
      "technique": "header_analysis"
    },
    {
      "confidence": 1,
      "result": {
        "original_header": "plotTree",
        "parent_header": [
          "PhySigs: Phylogenetic Inference of Mutational Signature Dynamics",
          "Usage instructions"
        ],
        "type": "Text_excerpt",
        "value": "The inputs to this function are the tumor phylogeny, normalized feature matrix, and exposure matrix. To annotate the plot, the function also requires a tumorID (useful when analyzing more than 1 tumor), a plot title, and optionally a tree index (useful when tumor has more than 1 possible tree).\n\n```R\n# Get tree figure with pie chart nodes showing exposures.\ntumorID <- \"Tumor1\"\ntitle <- \"Example Plot for PhySigs\"\nplotTree(tumorID, title, T, P_Norm, E_list[[k]], tree_idx=1)\n```\n\nRunning all of these steps together should result in the following plot.\n\n\n![Example Tree Exposure Plot](example_results.png)\n"
      },
      "source": "https://raw.githubusercontent.com/elkebir-group/PhySigs/master/README.md",
      "technique": "header_analysis"
    }
  ]
}