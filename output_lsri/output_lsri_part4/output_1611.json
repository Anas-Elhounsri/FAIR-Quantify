{
  "citation": [
    {
      "confidence": 1,
      "result": {
        "original_header": "References <a name=\"refs\"></a>",
        "parent_header": [
          "DMRfinder: efficiently identifying differentially methylated regions from MethylC-seq data",
          "Miscellaneous <a name=\"misc\"></a>"
        ],
        "type": "Text_excerpt",
        "value": "<a name=\"ref1\"></a> [1]  Krueger F, Andrews SR. Bismark: a flexible aligner and methylation caller for Bisulfite-Seq applications. Bioinformatics. 2011 Jun 1;27(11):1571-2.\n\n<a name=\"ref2\"></a> [2]  Feng H, Conneely KN, Wu H. A Bayesian hierarchical model to detect differentially methylated loci from single nucleotide resolution sequencing data. Nucleic Acids Res. 2014 Apr;42(8):e69.\n\n<a name=\"ref3\"></a> [3]  Langmead B, Salzberg SL. Fast gapped-read alignment with Bowtie 2. Nat Methods. 2012 Mar 4;9(4):357-9.\n\n[4]  Gaspar JM, Hart RP. DMRfinder: efficiently identifying differentially methylated regions from MethylC-seq data. BMC Bioinformatics. 2017 Nov 29;18(1):528.\n<br><br>\n"
      },
      "source": "https://raw.githubusercontent.com/jsh58/DMRfinder/master/README.md",
      "technique": "header_analysis"
    }
  ],
  "code_repository": [
    {
      "confidence": 1,
      "result": {
        "type": "Url",
        "value": "https://github.com/jsh58/DMRfinder"
      },
      "technique": "GitHub_API"
    }
  ],
  "contact": [
    {
      "confidence": 1,
      "result": {
        "original_header": "Contact <a name=\"contact\"></a>",
        "parent_header": [
          "DMRfinder: efficiently identifying differentially methylated regions from MethylC-seq data",
          "Miscellaneous <a name=\"misc\"></a>"
        ],
        "type": "Text_excerpt",
        "value": "Copyright &copy; 2016  John M. Gaspar (jsh58@wildcats.unh.edu)\n\nThe software was created at Rutgers University, under the support of NIH grant 1R01AT009152.\n<br><br>\n"
      },
      "source": "https://raw.githubusercontent.com/jsh58/DMRfinder/master/README.md",
      "technique": "header_analysis"
    }
  ],
  "date_created": [
    {
      "confidence": 1,
      "result": {
        "type": "Date",
        "value": "2016-12-10T21:14:33Z"
      },
      "technique": "GitHub_API"
    }
  ],
  "date_updated": [
    {
      "confidence": 1,
      "result": {
        "type": "Date",
        "value": "2024-07-22T20:58:37Z"
      },
      "technique": "GitHub_API"
    }
  ],
  "description": [
    {
      "confidence": 1,
      "result": {
        "type": "String",
        "value": "Identifying differentially methylated regions from MethylC-seq (bisulfite-sequencing) data"
      },
      "technique": "GitHub_API"
    },
    {
      "confidence": 1,
      "result": {
        "original_header": "Introduction <a name=\"intro\"></a>",
        "parent_header": [
          "DMRfinder: efficiently identifying differentially methylated regions from MethylC-seq data"
        ],
        "type": "Text_excerpt",
        "value": "DMRfinder efficiently identifies genomic regions with differentially methylated CpG sites from high-throughput MethylC-seq datasets (sequencing preceded by bisulfite treatment).  Following alignment with Bismark [[1](#ref1)], DMRfinder extracts methylation counts and clusters the CpG sites into genomic regions.  It then performs pairwise comparisons to identify differentially methylated regions (DMRs) using the statistical framework of the Bioconductor package DSS [[2](#ref2)].\n"
      },
      "source": "https://raw.githubusercontent.com/jsh58/DMRfinder/master/README.md",
      "technique": "header_analysis"
    },
    {
      "confidence": 0.9166048549162354,
      "result": {
        "original_header": "Alignment <a name=\"align\"></a>",
        "type": "Text_excerpt",
        "value": "To identify the methylation status of genomic cytosines, the high-throughput sequence reads from a MethylC-seq run first must be aligned to a reference genome.  To accomplish this, Bismark [[1](#ref1)] performs an in silico bisulfite conversion of both the reads and the reference genome, and then uses Bowtie2 [[3](#ref3)] to align the reads to the reference.  Reads with a single optimal alignment are further analyzed for methylation status; reference cytosines that were sequenced as thymines are labeled unmethylated, and those that remained as cytosines are labeled methylated.  All methylation calls are made with respect to the forward strand, so for reads that align to the reverse strand of the genome, methylation calls appear on the guanine bases.  Bismark classifies each methylation call based on the sequence context (CpG/CHG/CHH). \nThere are many command-line options in Bismark, which are described in the [User Guide](https://rawgit.com/FelixKrueger/Bismark/master/Docs/Bismark_User_Guide.html).  Of note, because Bismark relies on the alignments produced by Bowtie2, most of the Bowtie2 command-line options are available with Bismark as well (a full description of the Bowtie2 options can be found in the [manual](http://bowtie-bio.sourceforge.net/bowtie2/manual.shtml)). \nFollowing alignment, some researchers choose to remove reads that may be PCR duplicates.  We do not recommend using Bismark's deduplication script for this purpose; it simply keeps the first read at a given position in the alignment file and eliminates the rest, regardless of the reads' sequences or methylation information. \n"
      },
      "source": "https://raw.githubusercontent.com/jsh58/DMRfinder/master/README.md",
      "technique": "supervised_classification"
    },
    {
      "confidence": 0.9824938935817921,
      "result": {
        "original_header": "BASH5*",
        "type": "Text_excerpt",
        "value": "A [bug](https://github.com/FelixKrueger/Bismark/issues/56) related to ambiguous read alignments crept into version 0.16.0 of Bismark.  [Until this is fixed](https://github.com/FelixKrueger/Bismark/pull/58), we recommend [version 0.15.0](https://github.com/FelixKrueger/Bismark/releases/tag/v0.15.0).\n<br><br> \n"
      },
      "source": "https://raw.githubusercontent.com/jsh58/DMRfinder/master/README.md",
      "technique": "supervised_classification"
    },
    {
      "confidence": 0.9433423532748585,
      "result": {
        "original_header": "Extracting methylation counts <a name=\"extract\"></a>",
        "type": "Text_excerpt",
        "value": "The DMRfinder script `extract_CpG_data.py` converts the output from Bismark's aligner into a table of methylated/unmethylated counts at each CpG site.  The table is sorted by chromosome (based on the order of reference sequence names in the header of the SAM) and position, which is the 1-based coordinate of the cytosine of the CpG.  The script also merges methylation counts, in that it sums counts for both the cytosine and the guanine of each CpG site (this occurs when reads align to different strands of the reference; see [above](#align)).\n```\nUsage: python extract_CpG_data.py  [options]  -i <input>  -o <output>\n    -i <input>    SAM alignment file produced by Bismark (must have\n                    a header, 'XM' methylation strings, and 'XG'\n                    genome designations; can use '-' for stdin)\n    -o <output>   Output file listing counts of methylated and\n                    unmethylated CpGs, merged and sorted\n  Options:\n    -m <int>      Minimum coverage (methylation counts) to report a\n                    CpG site (def. 1)\n    -s            Report strand in third column of output\n    -n <file>     BED file listing regions for which to collect\n                    linked methylation data\n    -b            Memory-saving option (with coordinate-sorted SAM)\n    -e <file>     Output file listing ordered chromosomes\n```\n---\n \n```\n    -i <input>    SAM alignment file produced by Bismark (must have\n                    a header, 'XM' methylation strings, and 'XG'\n                    genome designations; can use '-' for stdin)\n```\nA SAM alignment file produced by Bismark, whether gzip-compressed or not, can be used directly as the `<input>` file.  However, a BAM file must be converted to SAM, or it can be piped in via Samtools, e.g.:\nBASH3*\n<br>\n```\n    -o <output>   Output file listing counts of methylated and\n                    unmethylated CpGs, merged and sorted\n```\nEach line of the output lists the following six values for a single CpG, tab-delimited:\n<table>\n  <tr>\n    <td align=\"center\">chrom</td>\n    <td>chromosome name</td>\n  </tr>\n  <tr>\n    <td align=\"center\">chromStart</td>\n    <td>1-based position of the cytosine in the CpG</td>\n  </tr>\n  <tr>\n    <td align=\"center\">chromEnd</td>\n    <td>chromStart + 1</td>\n  </tr>\n  <tr>\n    <td align=\"center\">percent</td>\n    <td>percent methylation at this site</td>\n  </tr>\n  <tr>\n    <td align=\"center\">methylated</td>\n    <td>count of methylated cytosines</td>\n  </tr>\n  <tr>\n    <td align=\"center\">unmethylated</td>\n    <td>count of unmethylated cytosines</td>\n  </tr>\n</table>\n<br>\n```\n    -m <int>      Minimum coverage (methylation counts) to report a\n                    CpG site (def. 1)\n```\nAny sites that do not have at least the specified number of methylation counts will be excluded from the output.  By default, all sites with at least one count are reported.\n<br><br>\n```\n    -s            Report strand in third column of output\n```\nWith this option, the 3rd column of the output, instead of chromEnd, will contain the strand.  Because this is a merged output, the strand will invariably be `+`.\n<br><br>\n```\n    -n <file>     BED file listing regions for which to collect\n                    linked methylation data\n```\nOn separate lines, the input BED file should list, for each genomic region of interest, chromosome name, 1-based start and end coordinates, and unique region name, tab-delimited.  For example:\nBASH8*\nThe output file, `<file>_linked.txt`, will list, for each BED region, the methylation data for reads that cover at least one CpG in the region.  The methylation data is summarized using `0` for an unmethylated CpG, `1` for methylated, and `-` for no data.  For example:\nBASH9*\nThis shows that, in regionA, there were six CpG sites, corresponding to the six columns of data for the three reads.  The first read (`read1`) had unmethylated CpGs at positions 102, 109, 140, and 147, while the CpG at position 123 was methylated.  The last CpG, at position 168, was not covered by this read.  The methylation data for the six CpG sites are similarly shown for `read2` and `read3`.\n<br><br>\n```\n    -b            Memory-saving option (with coordinate-sorted SAM)\n```\nWith this option, the script will process one chromosome at a time, rather than loading all of the methylation data into memory.  This requires that the SAM be coordinate-sorted in advance (e.g., by `samtools sort`).  For large input files, this option is recommended.  See also `-e` (below), and the `-b` and `-e` arguments of [`combine_CpG_sites.py`](#cluster).\n<br><br>\n```\n    -e <file>     Output file listing ordered chromosomes\n```\nWhen selected, a file will be produced that lists the chromosomes in the correct sort order.  This file can be given to `combine_CpG_sites.py` (`-e` argument also), when using the memory-saving option of that script (`-b`), provided that each analyzed SAM file has the same sort order.\n<br><br>\n \n**Note:** this script is specific for producing merged CpG methylation counts.  To get comprehensive methylation information, such as CHG/CHH methylation counts or M-bias plots, one can use the Bismark script `bismark_methylation_extractor`.  To produce a merged output similar to that of `extract_CpG_data.py`, one must also run the Bismark script `coverage2cytosine` (with `--merge_CpG`) on the `bismark_methylation_extractor` output.\n<br><br> \nThe DMRfinder script `combine_CpG_sites.py` takes one or more samples' methylation counts at individual CpG sites and produces a single output.  It clusters adjacent CpG sites into genomic regions, following a three-step procedure as described below, and sums the methylation data within the regions for each sample.\n```\nUsage: python combine_CpG_sites.py  [options]  -o <output>  [<input>]+\n    [<input>]+    One or more files, each listing methylation counts\n                    for a particular sample\n    -o <output>   Output file listing genomic regions and combined\n                    methylation counts for each sample\n  Options:\n    To consider a particular CpG:\n      -r <int>    Min. number of counts at a position (def. 3)\n      -s <int>    Min. number of samples with -r counts (def. 1)\n    To analyze a region of CpGs:\n      -d <int>    Max. distance between CpG sites (def. 100)\n      -c <int>    Min. number of CpGs in a region (def. 3)\n      -x <int>    Max. length of a region (def. 500)\n    To report a particular result:\n      -m <int>    Min. total counts in a region (def. 20)\n    Other:\n      -f          Report methylation fraction for each sample\n      -y <file>   Report clusters of valid CpG sites;\n                    if <file> exists, use these clusters\n      -b          Analyze one chromosome at a time (memory-saving)\n      -e <file>   File listing ordered chromosome names (comma-\n                    separated; used only with -b option)\n```\n---\n \n```\n    [<input>]+    One or more files, each listing methylation counts\n                    for a particular sample\n```\nThese headerless files must have six tab-delimited fields per line, with the first, second, fifth, and sixth columns being chromosome, position, methylated counts, and unmethylated counts, respectively (the third and fourth columns are not used).  This is the format produced by `extract_CpG_data.py`, as well as `coverage2cytosine` (specifying `--merge_CpG`) in Bismark.\n<br><br>\n```\n    -o <output>   Output file listing genomic regions and combined\n                    methylation counts for each sample\n```\nThe header line of this tab-delimited output file lists the following: `chr`, `start`, `end`, `CpG`, and two columns for each input file (the sample name [the basename of the input file, minus the suffix] followed by `-N`, and the sample name followed by `-X`).  In the following lines, the first four columns give the location of a genomic region (`start` and `end` are the 1-based positions of the cytosines in the first and last CpG sites of the region) and the number of CpG sites it contains.  The remaining columns give the methylation data for each sample; the `-N` column gives the total counts for the sample in the region, and the `-X` column gives the methylated counts.\n<br><br>\n \nStep one is to determine the list of valid CpG sites that meet the coverage criteria defined by the two parameters `-r` and `-s`:\n```\n    To consider a particular CpG:\n      -r <int>    Min. number of counts at a position (def. 3)\n      -s <int>    Min. number of samples with -r counts (def. 1)\n```\nIn a given sample, any CpG sites that do not have sufficient counts to meet the `-r` threshold will be disregarded.  Note that both methylated and unmethylated counts are considered; the methylation fraction is not taken into account.  The default value is 3.  Setting `-r 1` means that all sites will be analyzed. \nStep two is to perform a modified single-linkage clustering of the CpG sites into genomic regions, as established by the three parameters `-d`, `-c`, and `-x`:\n```\n    To analyze a region of CpGs:\n      -d <int>    Max. distance between CpG sites (def. 100)\n      -c <int>    Min. number of CpGs in a region (def. 3)\n      -x <int>    Max. length of a region (def. 500)\n```\nAny CpG sites that are within the distance set by `-d` are placed into the same cluster.  For example, with the default value of 100bp, CpGs at positions 100, 120, 200, and 300 will form one cluster.  Another CpG at position 401 will not join the cluster, because it is more than 100bp from the nearest CpG site. \nThe `-x` parameter sets the (ideal) maximum length for a region (default 500bp).  This option effectively limits the chaining effect of the single-linkage clustering.  However, this parameter is not strictly enforced; a region longer than the specified length will be split only in such a way that the subclusters meet the `-c` threshold.  If such a split is not possible, the original region will be kept as is.  Note that, following a split, each subcluster must individually meet the `-m` threshold as described below.\n<br><br> \nStep three is to perform a final filtering based on the number of counts in each sample individually, using the `-m` parameter:\n```\n    To report a particular result:\n      -m <int>    Min. total counts in a region (def. 20)\n```\nFor each region, the sum of methylated and unmethylated counts at valid CpG sites is calculated per sample.  Any sample for which this sum does not meet the `-m` threshold is reported as `NA` for both `-N` and `-X` columns in the output file; otherwise, the total sum is reported under `-N` and the methylated sum under `-X`.  Note that a valid CpG site is considered valid for all samples, even those that failed to meet the `-r` threshold.\n<br><br>\n```\n    Other:\n      -f          Report methylation fraction for each sample\n```\nWith this option, the output file will contain only one column per sample, which lists the methylation fraction in each region.  Note that this is calculated as the sum of methylated counts at the CpG sites within a region divided by the total sum of counts, not the average of the methylation fractions at those CpG sites.\n<br><br>\n```\n      -y <file>   Report clusters of valid CpG sites;\n                    if <file> exists, use these clusters\n```\nIf the given `<file>` does not exist, the script will produce a file listing the clusters it created, one line per cluster (reference name followed by a comma-separated list of CpG sites).\n \nThis is a convenience option for those processing large numbers of samples or different sets of samples.  One can perform the clustering on a subset of the samples, and then use the defined clusters to extract counts from all of the samples.  This will greatly reduce time and memory requirements.\n<br><br>\n```\n      -b          Analyze one chromosome at a time (memory-saving)\n```\nThis option causes the script to analyze the input files one chromosome at a time, rather than loading the files into memory all at once.  For large input files, this option is preferred.  Note that the chromosomes must be in the same order in the input files.\nBy default, the script will attempt to contruct the correct chromosome order from the input files.  This can be time-consuming, and in rare cases (e.g., when multiple samples are missing counts for certain chromosomes), the script may fail to produce the correct order and incorrectly complain about sorted input files being unsorted.  To avoid this, one can use the `-e` option, below.\n<br><br>\n```\n      -e <file>   File listing ordered chromosome names (comma-\n                    separated; used only with -b option)\n```\nThis option allows one to provide the correct chromosome order as a comma- or line-separated list.  All input files must list methylation counts in the same given order.  Note that one can use the file generated via the `-e` option of `extract_CpG_data.py`.\n<br><br>\n \nThe DMRfinder script `findDMRs.r` conducts pairwise tests of sample groups to find genomic regions that are differentially methylated.  The underlying statistics are based on the beta-binomial hierarchical modeling and Wald test implemented in the Bioconductor package DSS [[2](#ref2)]. Illustrative examples of the usage of findDMRs.r are provided in [Appendix B](#appB).\n```\nUsage: Rscript findDMRs.r  [options]  -i <input>  -o <output>  \\\n             <groupList1>  <groupList2>  [...]\n    -i <input>    File listing genomic regions and methylation counts\n    -o <output>   Output file listing methylation results\n    <groupList>   Comma-separated list of sample names (at least two\n                    such lists must be provided)\n  Options:\n    -n <str>      Comma-separated list of group names\n    -k <str>      Column names of <input> to copy to <output> (comma-\n                    separated; def. \"chr, start, end, CpG\")\n    -s <str>      Column names of DSS output to include in <output>\n                    (comma-separated; def. \"mu, diff, pval\")\n    -c <int>      Min. number of CpGs in a region (def. 3)\n    -d <float>    Min. methylation difference between sample groups\n                    ([0-1]; def. 0.10)\n    -p <float>    Max. p-value ([0-1]; def. 0.05)\n    -q <float>    Max. q-value ([0-1]; def. 1)\n    -up           Report only regions hypermethylated in later group\n    -down         Report only regions hypomethylated in later group\n    -t <int>      Report regions with at least <int> comparisons\n                    that are significant (def. 1)\n```\n---\n \n```\n    -i <input>    File listing genomic regions and methylation counts\n```\nThis tab-delimited file must have columns labeled `chr`, `start`, `end`, and `CpG`.  In addition, for each of the samples to be analyzed, there must be two columns, the sample name followed by `-N` and the sample name followed by `-X`.  This is the format produced by `combine_CpG_sites.py`.\n<br><br>\n```\n    -o <output>   Output file listing methylation results\n```\nThis tab-delimited output file lists any regions judged as differentially methylated, based on the specified thresholds (`-c`/`-d`/`-p`/`-q`/`-up`/`-down`/`-t`, see below).  For each region, the same four columns (`chr`, `start`, `end`, `CpG`) will be reported, plus statistical results from DSS (methylation levels, differences, and *p*-values; see `-k`, `-s` below).\n<br><br>\n```\n    <groupList>   Comma-separated list of sample names (at least two\n                    such lists must be provided)\n```\nThese are the lists of samples for each group between which methylation differences are to be ascertained.  The sample names must match those found in the header of the input file (not including the `-N` and `-X`).  As indicated, at least two such lists must be provided.  If more than two groups are provided, this script will conduct pairwise tests for each two-group combination.\n \nAn individual sample cannot be included multiple times, not even in different groups.  Not every sample in the input file need be analyzed.\n<br><br>\n```\n    -n <str>      Comma-separated list of group names\n```\nThis list should correspond to the `<groupList>` order on the command-line.  The names are how each group will be referred to in the output file.  By default, if this option is not supplied, group names are constructed from the list of sample names, joined by `_`.\n<br><br>\n \n```\n    -k <str>      Column names of <input> to copy to <output> (comma-\n                    separated; def. \"chr, start, end, CpG\")\n```\nThese are the fields from the input file that are included in the output file.  The default values are the four columns that are required in the input; columns selected with `-k` will be appended to this list.  For example, if an input file contains genomic annotations, specifying the column header(s) of the annotations with `-k` will ensure that these fields are copied to the output file.\n<br><br>\n```\n    -s <str>      Column names of DSS output to include in <output>\n                    (comma-separated; def. \"mu, diff, pval\")\n```\nThese are the fields of the DSS output that are included in the output file.  The default values are `mu` (methylation fraction), `diff` (methylation difference), and `pval` (*p*-value); columns selected with `-s` will be appended to this list.  Options available with DSS (v2.14.0) are the following: `phi`, `diff.se`, `stat`, and `fdr`.  When `-q` is specified (see below), `fdr` is automatically selected.\n \nThe methylation fraction is reported for each group individually, as `group:mu`.  For each group-group comparison, slightly different values for `mu` may be reported for a given group; these values are averaged for the output file.  The same is true for other values that are reported for each group (e.g. `phi`). \nThe methylation difference and *p*-value are reported for each group-group comparison, as `group1->group2:diff` and `group1->group2:pval`.  Differences are given as group2 with respect to group1, so values below zero represent hypomethylation in group2.  Because of occasional inconsistencies in reported methylation levels (as described in the previous paragraph), a given `group1->group2:diff` might not exactly equal `group2:mu` minus `group1:mu`.\n<br><br>\n```\n    -c <int>      Min. number of CpGs in a region (def. 3)\n```\nAny regions not containing at least the specified number of CpG sites will be eliminated.  This parameter is equivalent to `-c` in `combine_CpG_sites.py`.\n<br><br>\n \n```\n    -d <float>    Min. methylation difference between sample groups\n                    ([0-1]; def. 0.10)\n```\nThis is the minimum methylation difference that is considered significant.  The default value of 0.10 means that there must be at least a 10% methylation difference, plus or minus, between two groups.  Specifying `-d 0` means that no regions will be rejected on this basis, except for those listed as `NA`.\n<br><br>\n```\n    -p <float>    Max. p-value ([0-1]; def. 0.05)\n```\nThis is the maximum *p*-value that is considered significant.  The default value of 0.05 means that a group-group comparison must have a *p*-value at or below this threshold.  Specifying `-p 1` means that no regions will be rejected on this basis, except for those listed as `NA`.\n<br><br>\n```\n    -q <float>    Max. q-value ([0-1]; def. 1)\n```\nThis is the maximum *q*-value (false discovery rate-adjusted *p*-value) that is considered significant.  The default value of 1 means that no regions will be rejected on this basis.  When this option is used, `fdr` is automatically added as an output column for each group-group comparison.\n<br><br>\n```\n    -up           Report only regions hypermethylated in later group\n    -down         Report only regions hypomethylated in later group\n```\nThese options limit which regions are reported.  The order of groups given on the command-line determines which group is considered \"later\".\n<br><br>\n```\n    -t <int>      Report regions with at least <int> comparisons\n                    that are significant (def. 1)\n```\nThis parameter determines how many group-group comparisons in a region must meet the `-d`/`-p`/`-q`/`-up`/`-down` threshold(s) to be reported.  The default value of 1 means that only one comparison must be considered significant to report the region; even if other comparisons do not meet the threshold(s), their results for the region will be included as well.\n \n<a name=\"ref1\"></a> [1]  Krueger F, Andrews SR. Bismark: a flexible aligner and methylation caller for Bisulfite-Seq applications. Bioinformatics. 2011 Jun 1;27(11):1571-2. \nIn this section, we will demonstrate the three-step process for producing genomic regions as implemented in `combine_CpG_sites.py`.  We will use a simplified set of methylation counts for two samples, C1 and C2, as produced by `extract_CpG_data.py` (for simplification, the third and fourth columns are not shown):\n```\n      C1.cov                       C2.cov\nchrZ   100   0   1           chrZ   100   1   2\nchrZ   120   1   2           chrZ   120   2   3\nchrZ   200   0   4           chrZ   200   1   5\nchrZ   300   3   3           chrZ   300   0   2\nchrZ   401   2   6           chrZ   401   3   3\nchrZ   450   3   5           chrZ   450   4   5\nchrZ   600   5   2           chrZ   600   6   3\nchrZ   625   4   2           chrZ   625   8   0\nchrZ   650   5   1           chrZ   650   7   1\nchrZ   700   3   2           chrZ   700   3   4\n``` \nFirst, with the default of `-r 3`, it determined which CpG sites in each sample had at least three methylated/unmethylated counts (the sum of the last two columns of the data).  For sample C1, all the sites met this criterion except for position 100; in sample C2, only position 300 failed to have at least three counts.  After this, the collective validity of the CpG sites was evaluated; with the default of `-s 1`, only one sample needed to meet the `-r` threshold at each location.  Therefore, all CpG sites were considered valid.  Note that, if `-s 2` had been set, the CpG sites at positions 100 and 300 would have been discarded, because fewer than two samples had sufficient counts at those sites. \nNext, regions of adjacent CpG sites were defined.  With the default maximum distance between CpG sites of 100bp  (`-d 100`), this dataset was clustered into three groups: (100, 120, 200, 300); (401, 450); (600, 625, 650, 700).  After this, any clusters smaller than the minimum size were eliminated; with the default value of three (`-c 3`), the second cluster was removed, leaving (100, 120, 200, 300) and (600, 625, 650, 700).  The maximum length parameter (`-x 500`) did not affect the remaining clusters, since neither was longer than 500bp. \nFinally, the methylation counts within these clusters were summed for each sample, and those failing to meet the threshold established by the `-m` parameter were reported as `NA`.  With the first cluster, the sum of counts for sample C1 was 14, and that for sample C2 was 16.  Therefore, since neither sample met the threshold (`-m 20`), this cluster was not even reported in the output.  For the remaining cluster, the sum of methylated counts for both samples was placed in their respective `-X` columns, and the total sum of counts was in the `-N` columns.  \nIn this section, we will outline how the statistical results from DSS are incorporated into the output of this script.  We will use a simplified dataset for two groups (Control and Experimental), each of which had two samples (C1/C2 and E1/E2).  Here is the input, as produced by `combine_CpG_sites.py`:\n```\nchr  start  end  CpG  C1-N  C1-X  C2-N  C2-X  E1-N  E1-X  E2-N  E2-X\nchrZ  100   300   4    14     4    16     4    21    10    30     8\nchrZ  600   700   4    24    17    32    24    28    15    35    16\n``` \nThis shows that, for the genomic region of `chrZ:600-700`, the methylation levels (`mu`) in the Control and Experimental groups were 72.7% and 49.3%, respectively.  Therefore, the difference of -23.4% easily met the 10% default threshold, and the *p*-value of 0.03 was below the default value of 0.05.  The other region, `chrZ:100-300`, was not reported in the output because it failed to meet one or both thresholds. \n"
      },
      "source": "https://raw.githubusercontent.com/jsh58/DMRfinder/master/README.md",
      "technique": "supervised_classification"
    },
    {
      "confidence": 0.9253306689892092,
      "result": {
        "original_header": "BASH5*",
        "type": "Text_excerpt",
        "value": "# DMRfinder: efficiently identifying differentially methylated regions from MethylC-seq data \n## Table of Contents\n* [Introduction](#intro)\n  * [Quick start](#quick)\n  * [Software prerequisites](#prereqs)\n* [Alignment](#align)\n* [Extracting methylation counts](#extract)\n* [Clustering CpG sites into regions](#cluster)\n* [Testing regions for differential methylation](#test)\n* [Miscellaneous](#misc)\n  * [Universal options](#options)\n  * [References](#refs)\n  * [Contact](#contact)\n* [Appendix A. Illustrative examples with `combine_CpG_sites.py`](#appA)\n* [Appendix B. Illustrative examples with `findDMRs.r`](#appB)\n<br><br> \nDMRfinder efficiently identifies genomic regions with differentially methylated CpG sites from high-throughput MethylC-seq datasets (sequencing preceded by bisulfite treatment).  Following alignment with Bismark [[1](#ref1)], DMRfinder extracts methylation counts and clusters the CpG sites into genomic regions.  It then performs pairwise comparisons to identify differentially methylated regions (DMRs) using the statistical framework of the Bioconductor package DSS [[2](#ref2)]. \n"
      },
      "source": "https://raw.githubusercontent.com/jsh58/DMRfinder/master/README.md",
      "technique": "supervised_classification"
    },
    {
      "confidence": 0.904175718077337,
      "result": {
        "original_header": "Quick start <a name=\"quick\"></a>",
        "type": "Text_excerpt",
        "value": "Given:\n* `/path/to/genome`: a file path to a reference genome\n* `C1.fastq`, `C2.fastq`: single-end sequence files for two samples in the group `Control`\n* `E1.fastq`, `E2.fastq`: single-end sequence files for two samples in the group `Exptl`\n<br><br> \nLooking for:\n* Genomic regions that are differentially methylated between the groups `Control` and `Exptl`\n<br><br> \n"
      },
      "source": "https://raw.githubusercontent.com/jsh58/DMRfinder/master/README.md",
      "technique": "supervised_classification"
    },
    {
      "confidence": 0.983861265967548,
      "result": {
        "original_header": "BASH5*",
        "type": "Text_excerpt",
        "value": "```\n    -i <input>    SAM alignment file produced by Bismark (must have\n                    a header, 'XM' methylation strings, and 'XG'\n                    genome designations; can use '-' for stdin)\n```\nA SAM alignment file produced by Bismark, whether gzip-compressed or not, can be used directly as the `<input>` file.  However, a BAM file must be converted to SAM, or it can be piped in via Samtools, e.g.:\nBASH7*\n<br>\n```\n    -o <output>   Output file listing counts of methylated and\n                    unmethylated CpGs, merged and sorted\n```\nEach line of the output lists the following six values for a single CpG, tab-delimited:\n<table>\n  <tr>\n    <td align=\"center\">chrom</td>\n    <td>chromosome name</td>\n  </tr>\n  <tr>\n    <td align=\"center\">chromStart</td>\n    <td>1-based position of the cytosine in the CpG</td>\n  </tr>\n  <tr>\n    <td align=\"center\">chromEnd</td>\n    <td>chromStart + 1</td>\n  </tr>\n  <tr>\n    <td align=\"center\">percent</td>\n    <td>percent methylation at this site</td>\n  </tr>\n  <tr>\n    <td align=\"center\">methylated</td>\n    <td>count of methylated cytosines</td>\n  </tr>\n  <tr>\n    <td align=\"center\">unmethylated</td>\n    <td>count of unmethylated cytosines</td>\n  </tr>\n</table>\n<br>\n```\n    -m <int>      Minimum coverage (methylation counts) to report a\n                    CpG site (def. 1)\n```\nAny sites that do not have at least the specified number of methylation counts will be excluded from the output.  By default, all sites with at least one count are reported.\n<br><br>\n```\n    -s            Report strand in third column of output\n```\nWith this option, the 3rd column of the output, instead of chromEnd, will contain the strand.  Because this is a merged output, the strand will invariably be `+`.\n<br><br>\n```\n    -n <file>     BED file listing regions for which to collect\n                    linked methylation data\n```\nOn separate lines, the input BED file should list, for each genomic region of interest, chromosome name, 1-based start and end coordinates, and unique region name, tab-delimited.  For example:\nBASH12*\nThe output file, `<file>_linked.txt`, will list, for each BED region, the methylation data for reads that cover at least one CpG in the region.  The methylation data is summarized using `0` for an unmethylated CpG, `1` for methylated, and `-` for no data.  For example:\nBASH13*\nThis shows that, in regionA, there were six CpG sites, corresponding to the six columns of data for the three reads.  The first read (`read1`) had unmethylated CpGs at positions 102, 109, 140, and 147, while the CpG at position 123 was methylated.  The last CpG, at position 168, was not covered by this read.  The methylation data for the six CpG sites are similarly shown for `read2` and `read3`.\n<br><br>\n```\n    -b            Memory-saving option (with coordinate-sorted SAM)\n```\nWith this option, the script will process one chromosome at a time, rather than loading all of the methylation data into memory.  This requires that the SAM be coordinate-sorted in advance (e.g., by `samtools sort`).  For large input files, this option is recommended.  See also `-e` (below), and the `-b` and `-e` arguments of [`combine_CpG_sites.py`](#cluster).\n<br><br>\n```\n    -e <file>     Output file listing ordered chromosomes\n```\nWhen selected, a file will be produced that lists the chromosomes in the correct sort order.  This file can be given to `combine_CpG_sites.py` (`-e` argument also), when using the memory-saving option of that script (`-b`), provided that each analyzed SAM file has the same sort order.\n<br><br>\n \n"
      },
      "source": "https://raw.githubusercontent.com/jsh58/DMRfinder/master/README.md",
      "technique": "supervised_classification"
    }
  ],
  "download_url": [
    {
      "confidence": 1,
      "result": {
        "type": "Url",
        "value": "https://github.com/jsh58/DMRfinder/releases"
      },
      "technique": "GitHub_API"
    }
  ],
  "forks_count": [
    {
      "confidence": 1,
      "result": {
        "type": "Number",
        "value": 8
      },
      "technique": "GitHub_API"
    }
  ],
  "forks_url": [
    {
      "confidence": 1,
      "result": {
        "type": "Url",
        "value": "https://api.github.com/repos/jsh58/DMRfinder/forks"
      },
      "technique": "GitHub_API"
    }
  ],
  "full_name": [
    {
      "confidence": 1,
      "result": {
        "type": "String",
        "value": "jsh58/DMRfinder"
      },
      "technique": "GitHub_API"
    }
  ],
  "full_title": [
    {
      "confidence": 1,
      "result": {
        "type": "String",
        "value": "DMRfinder: efficiently identifying differentially methylated regions from MethylC-seq data"
      },
      "source": "https://raw.githubusercontent.com/jsh58/DMRfinder/master/README.md",
      "technique": "regular_expression"
    }
  ],
  "installation": [
    {
      "confidence": 0.8906768476097967,
      "result": {
        "original_header": "BASH5*",
        "type": "Text_excerpt",
        "value": "A [bug](https://github.com/FelixKrueger/Bismark/issues/56) related to ambiguous read alignments crept into version 0.16.0 of Bismark.  [Until this is fixed](https://github.com/FelixKrueger/Bismark/pull/58), we recommend [version 0.15.0](https://github.com/FelixKrueger/Bismark/releases/tag/v0.15.0).\n<br><br> \n"
      },
      "source": "https://raw.githubusercontent.com/jsh58/DMRfinder/master/README.md",
      "technique": "supervised_classification"
    },
    {
      "confidence": 0.8497895422689105,
      "result": {
        "original_header": "Extracting methylation counts <a name=\"extract\"></a>",
        "type": "Text_excerpt",
        "value": "**Note:** this script is specific for producing merged CpG methylation counts.  To get comprehensive methylation information, such as CHG/CHH methylation counts or M-bias plots, one can use the Bismark script `bismark_methylation_extractor`.  To produce a merged output similar to that of `extract_CpG_data.py`, one must also run the Bismark script `coverage2cytosine` (with `--merge_CpG`) on the `bismark_methylation_extractor` output.\n<br><br> \nThe following options work for all scripts in DMRfinder:\n```\n    -h/--help     Print the usage message\n    --version     Print the version and copyright\n    -v            Run the script in verbose mode (printing various\n                    updates and statistics to stdout/stderr)\n``` \nCopyright &copy; 2016  John M. Gaspar (jsh58@wildcats.unh.edu) \n## Appendix A. Illustrative examples with `combine_CpG_sites.py` <a name=\"appA\"></a> \nThese files were analyzed using the following command:\n```\n$ python combine_CpG_sites.py  -o results.csv  C1.cov  C2.cov\n``` \n\n## Appendix B. Illustrative examples with `findDMRs.r` <a name=\"appB\"></a> \n"
      },
      "source": "https://raw.githubusercontent.com/jsh58/DMRfinder/master/README.md",
      "technique": "supervised_classification"
    },
    {
      "confidence": 0.9795196918543101,
      "result": {
        "original_header": "Quick start <a name=\"quick\"></a>",
        "type": "Text_excerpt",
        "value": "Step 1: Alignment\n```\n$ bismark_genome_preparation  /path/to/genome\n$ bismark  /path/to/genome  C1.fastq\n$ bismark  /path/to/genome  C2.fastq\n$ bismark  /path/to/genome  E1.fastq\n$ bismark  /path/to/genome  E2.fastq\n```\n<br> \nStep 2: Extract methylation counts from alignment files\n```\n$ samtools view -h C1_bismark_bt2.bam  |  python extract_CpG_data.py  -i -  -o C1.cov  -v\n$ samtools view -h C2_bismark_bt2.bam  |  python extract_CpG_data.py  -i -  -o C2.cov  -v\n$ samtools view -h E1_bismark_bt2.bam  |  python extract_CpG_data.py  -i -  -o E1.cov  -v\n$ samtools view -h E2_bismark_bt2.bam  |  python extract_CpG_data.py  -i -  -o E2.cov  -v\n```\n<br> \n"
      },
      "source": "https://raw.githubusercontent.com/jsh58/DMRfinder/master/README.md",
      "technique": "supervised_classification"
    },
    {
      "confidence": 0.81634238522873,
      "result": {
        "original_header": "BASH5*",
        "type": "Text_excerpt",
        "value": "### Software prerequisites <a name=\"prereqs\"></a> \n"
      },
      "source": "https://raw.githubusercontent.com/jsh58/DMRfinder/master/README.md",
      "technique": "supervised_classification"
    },
    {
      "confidence": 0.9999996811657976,
      "result": {
        "original_header": "Software prerequisites <a name=\"prereqs\"></a>",
        "type": "Text_excerpt",
        "value": "Required:\n* [DMRfinder](https://github.com/jsh58/DMRfinder)\n* [Bismark](http://www.bioinformatics.babraham.ac.uk/projects/bismark/)\n* [Bowtie2](http://bowtie-bio.sourceforge.net/bowtie2/index.shtml)\n* [DSS](http://www.bioconductor.org/packages/release/bioc/html/DSS.html). This package requires [R](https://www.r-project.org/) and [Bioconductor](http://www.bioconductor.org/install/).  DMRfinder scripts have been tested with Rscript version 3.3.1 and DSS version 2.14.0.\n* [Python](https://www.python.org/downloads/).  DMRfinder scripts have been tested with Python versions 2.7.12 and 3.5.2. \n"
      },
      "source": "https://raw.githubusercontent.com/jsh58/DMRfinder/master/README.md",
      "technique": "supervised_classification"
    },
    {
      "confidence": 0.9992451843404289,
      "result": {
        "original_header": "BASH5*",
        "type": "Text_excerpt",
        "value": "Optional:\n* [Samtools](http://www.htslib.org/).  If this is installed, the output from Bismark will be converted to BAM; otherwise, the output will be gzip-compressed.  Either output can be analyzed by DMRfinder, as described [below](#extract).\n<br><br> \n"
      },
      "source": "https://raw.githubusercontent.com/jsh58/DMRfinder/master/README.md",
      "technique": "supervised_classification"
    }
  ],
  "invocation": [
    {
      "confidence": 0.8563617771555361,
      "result": {
        "original_header": "Extracting methylation counts <a name=\"extract\"></a>",
        "type": "Text_excerpt",
        "value": "\n## Testing regions for differential methylation <a name=\"test\"></a> \n## Appendix A. Illustrative examples with `combine_CpG_sites.py` <a name=\"appA\"></a> \nThese files were analyzed using the following command:\n```\n$ python combine_CpG_sites.py  -o results.csv  C1.cov  C2.cov\n``` \n\n## Appendix B. Illustrative examples with `findDMRs.r` <a name=\"appB\"></a> \nThis file was analyzed using the following command:\n```\n$ Rscript findDMRs.r  -i input.csv  -o output.csv  C1,C2  E1,E2  -n Ctrl,Exp\n``` \n"
      },
      "source": "https://raw.githubusercontent.com/jsh58/DMRfinder/master/README.md",
      "technique": "supervised_classification"
    },
    {
      "confidence": 0.816875233715117,
      "result": {
        "original_header": "BASH5*",
        "type": "Text_excerpt",
        "value": "### Quick start <a name=\"quick\"></a> \n"
      },
      "source": "https://raw.githubusercontent.com/jsh58/DMRfinder/master/README.md",
      "technique": "supervised_classification"
    },
    {
      "confidence": 0.8758078602835608,
      "result": {
        "original_header": "Quick start <a name=\"quick\"></a>",
        "type": "Text_excerpt",
        "value": "Step 2: Extract methylation counts from alignment files\n```\n$ samtools view -h C1_bismark_bt2.bam  |  python extract_CpG_data.py  -i -  -o C1.cov  -v\n$ samtools view -h C2_bismark_bt2.bam  |  python extract_CpG_data.py  -i -  -o C2.cov  -v\n$ samtools view -h E1_bismark_bt2.bam  |  python extract_CpG_data.py  -i -  -o E1.cov  -v\n$ samtools view -h E2_bismark_bt2.bam  |  python extract_CpG_data.py  -i -  -o E2.cov  -v\n```\n<br> \nStep 3: Cluster CpG sites into regions\n```\n$ python combine_CpG_sites.py  -v  -o combined.csv  C1.cov  C2.cov  E1.cov  E2.cov\n```\n<br> \n"
      },
      "source": "https://raw.githubusercontent.com/jsh58/DMRfinder/master/README.md",
      "technique": "supervised_classification"
    }
  ],
  "issue_tracker": [
    {
      "confidence": 1,
      "result": {
        "type": "Url",
        "value": "https://api.github.com/repos/jsh58/DMRfinder/issues"
      },
      "technique": "GitHub_API"
    }
  ],
  "keywords": [
    {
      "confidence": 1,
      "result": {
        "type": "String",
        "value": ""
      },
      "technique": "GitHub_API"
    }
  ],
  "license": [
    {
      "confidence": 1,
      "result": {
        "name": "MIT License",
        "spdx_id": "MIT",
        "type": "License",
        "url": "https://api.github.com/licenses/mit",
        "value": "https://api.github.com/licenses/mit"
      },
      "technique": "GitHub_API"
    },
    {
      "confidence": 1,
      "result": {
        "type": "File_dump",
        "value": "The MIT License\n\nCopyright (C) 2016 John M. Gaspar (jsh58@wildcats.unh.edu)\n\nPermission is hereby granted, free of charge, to any person obtaining a copy\nof this software and associated documentation files (the \"Software\"), to deal\nin the Software without restriction, including without limitation the rights\nto use, copy, modify, merge, publish, distribute, sublicense, and/or sell\ncopies of the Software, and to permit persons to whom the Software is\nfurnished to do so, subject to the following conditions:\n\nThe above copyright notice and this permission notice shall be included in\nall copies or substantial portions of the Software.\n\nTHE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\nIMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\nFITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\nAUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\nLIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\nOUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\nTHE SOFTWARE.\n\n"
      },
      "source": "https://raw.githubusercontent.com/jsh58/DMRfinder/master/LICENSE",
      "technique": "file_exploration"
    }
  ],
  "name": [
    {
      "confidence": 1,
      "result": {
        "type": "String",
        "value": "DMRfinder"
      },
      "technique": "GitHub_API"
    }
  ],
  "owner": [
    {
      "confidence": 1,
      "result": {
        "type": "User",
        "value": "jsh58"
      },
      "technique": "GitHub_API"
    }
  ],
  "programming_languages": [
    {
      "confidence": 1,
      "result": {
        "name": "Python",
        "size": 40032,
        "type": "Programming_language",
        "value": "Python"
      },
      "technique": "GitHub_API"
    },
    {
      "confidence": 1,
      "result": {
        "name": "R",
        "size": 12930,
        "type": "Programming_language",
        "value": "R"
      },
      "technique": "GitHub_API"
    }
  ],
  "readme_url": [
    {
      "confidence": 1,
      "result": {
        "type": "Url",
        "value": "https://raw.githubusercontent.com/jsh58/DMRfinder/master/README.md"
      },
      "technique": "file_exploration"
    }
  ],
  "releases": [
    {
      "confidence": 1,
      "result": {
        "author": {
          "name": "jsh58",
          "type": "User"
        },
        "date_created": "2017-11-30T15:02:42Z",
        "date_published": "2017-11-30T15:05:46Z",
        "description": "Version 0.3 - Oct. 21, 2017\r\n\r\n* Memory-saving options in `extract_CpG_data.py` and `combine_CpG_sites.py` (both `-b`).  With this option, the scripts will analyze one chromosome (reference sequence) at a time, rather than loading/saving all data at once.  The input SAM must be coordinate-sorted for `extract_CpG_data.py`, and the input files must be in the same sort order for `combine_CpG_sites.py`.\r\n",
        "html_url": "https://github.com/jsh58/DMRfinder/releases/tag/v0.3",
        "name": "Version 0.3",
        "release_id": 8719168,
        "tag": "v0.3",
        "tarball_url": "https://api.github.com/repos/jsh58/DMRfinder/tarball/v0.3",
        "type": "Release",
        "url": "https://api.github.com/repos/jsh58/DMRfinder/releases/8719168",
        "value": "https://api.github.com/repos/jsh58/DMRfinder/releases/8719168",
        "zipball_url": "https://api.github.com/repos/jsh58/DMRfinder/zipball/v0.3"
      },
      "technique": "GitHub_API"
    },
    {
      "confidence": 1,
      "result": {
        "author": {
          "name": "jsh58",
          "type": "User"
        },
        "date_created": "2017-09-23T18:29:50Z",
        "date_published": "2017-11-30T14:56:19Z",
        "description": "Version 0.2 - June 13, 2017\r\n\r\n* Clarified sample names designation.\r\n",
        "html_url": "https://github.com/jsh58/DMRfinder/releases/tag/v0.2",
        "name": "Version 0.2",
        "release_id": 8719013,
        "tag": "v0.2",
        "tarball_url": "https://api.github.com/repos/jsh58/DMRfinder/tarball/v0.2",
        "type": "Release",
        "url": "https://api.github.com/repos/jsh58/DMRfinder/releases/8719013",
        "value": "https://api.github.com/repos/jsh58/DMRfinder/releases/8719013",
        "zipball_url": "https://api.github.com/repos/jsh58/DMRfinder/zipball/v0.2"
      },
      "technique": "GitHub_API"
    },
    {
      "confidence": 1,
      "result": {
        "author": {
          "name": "jsh58",
          "type": "User"
        },
        "date_created": "2017-02-21T22:20:15Z",
        "date_published": "2017-11-30T14:50:45Z",
        "description": "Version 0.1 - Dec 19, 2016\r\n\r\n* First public release on GitHub.\r\n",
        "html_url": "https://github.com/jsh58/DMRfinder/releases/tag/v0.1",
        "name": "Version 0.1",
        "release_id": 8718904,
        "tag": "v0.1",
        "tarball_url": "https://api.github.com/repos/jsh58/DMRfinder/tarball/v0.1",
        "type": "Release",
        "url": "https://api.github.com/repos/jsh58/DMRfinder/releases/8718904",
        "value": "https://api.github.com/repos/jsh58/DMRfinder/releases/8718904",
        "zipball_url": "https://api.github.com/repos/jsh58/DMRfinder/zipball/v0.1"
      },
      "technique": "GitHub_API"
    }
  ],
  "requirements": [
    {
      "confidence": 1,
      "result": {
        "original_header": "Software prerequisites <a name=\"prereqs\"></a>",
        "parent_header": [
          "DMRfinder: efficiently identifying differentially methylated regions from MethylC-seq data",
          "Introduction <a name=\"intro\"></a>"
        ],
        "type": "Text_excerpt",
        "value": "Required:\n* [DMRfinder](https://github.com/jsh58/DMRfinder)\n* [Bismark](http://www.bioinformatics.babraham.ac.uk/projects/bismark/)\n* [Bowtie2](http://bowtie-bio.sourceforge.net/bowtie2/index.shtml)\n* [DSS](http://www.bioconductor.org/packages/release/bioc/html/DSS.html). This package requires [R](https://www.r-project.org/) and [Bioconductor](http://www.bioconductor.org/install/).  DMRfinder scripts have been tested with Rscript version 3.3.1 and DSS version 2.14.0.\n* [Python](https://www.python.org/downloads/).  DMRfinder scripts have been tested with Python versions 2.7.12 and 3.5.2.\n\nOptional:\n* [Samtools](http://www.htslib.org/).  If this is installed, the output from Bismark will be converted to BAM; otherwise, the output will be gzip-compressed.  Either output can be analyzed by DMRfinder, as described [below](#extract).\n<br><br>\n"
      },
      "source": "https://raw.githubusercontent.com/jsh58/DMRfinder/master/README.md",
      "technique": "header_analysis"
    }
  ],
  "somef_missing_categories": [
    "acknowledgement",
    "run",
    "download",
    "contributors",
    "documentation",
    "faq",
    "support",
    "identifier",
    "has_build_file",
    "executable_example"
  ],
  "somef_provenance": {
    "date": "2024-11-04 07:42:17",
    "somef_schema_version": "1.0.0",
    "somef_version": "0.9.5"
  },
  "stargazers_count": [
    {
      "confidence": 1,
      "result": {
        "type": "Number",
        "value": 26
      },
      "technique": "GitHub_API"
    }
  ],
  "type": [
    {
      "confidence": 0.82,
      "result": {
        "type": "String",
        "value": "commandline-application"
      },
      "technique": "software_type_heuristics"
    }
  ],
  "usage": [
    {
      "confidence": 1,
      "result": {
        "original_header": "Quick start <a name=\"quick\"></a>",
        "parent_header": [
          "DMRfinder: efficiently identifying differentially methylated regions from MethylC-seq data",
          "Introduction <a name=\"intro\"></a>"
        ],
        "type": "Text_excerpt",
        "value": "Given:\n* `/path/to/genome`: a file path to a reference genome\n* `C1.fastq`, `C2.fastq`: single-end sequence files for two samples in the group `Control`\n* `E1.fastq`, `E2.fastq`: single-end sequence files for two samples in the group `Exptl`\n<br><br>\n\nLooking for:\n* Genomic regions that are differentially methylated between the groups `Control` and `Exptl`\n<br><br>\n\nStep 1: Alignment\n```\n$ bismark_genome_preparation  /path/to/genome\n$ bismark  /path/to/genome  C1.fastq\n$ bismark  /path/to/genome  C2.fastq\n$ bismark  /path/to/genome  E1.fastq\n$ bismark  /path/to/genome  E2.fastq\n```\n<br>\n\nStep 2: Extract methylation counts from alignment files\n```\n$ samtools view -h C1_bismark_bt2.bam  |  python extract_CpG_data.py  -i -  -o C1.cov  -v\n$ samtools view -h C2_bismark_bt2.bam  |  python extract_CpG_data.py  -i -  -o C2.cov  -v\n$ samtools view -h E1_bismark_bt2.bam  |  python extract_CpG_data.py  -i -  -o E1.cov  -v\n$ samtools view -h E2_bismark_bt2.bam  |  python extract_CpG_data.py  -i -  -o E2.cov  -v\n```\n<br>\n\nStep 3: Cluster CpG sites into regions\n```\n$ python combine_CpG_sites.py  -v  -o combined.csv  C1.cov  C2.cov  E1.cov  E2.cov\n```\n<br>\n\nStep 4: Test regions for differential methylation\n```\n$ Rscript findDMRs.r  -i combined.csv  -o results.csv  -v  -n Control,Exptl  C1,C2  E1,E2\n```\n<br>\n"
      },
      "source": "https://raw.githubusercontent.com/jsh58/DMRfinder/master/README.md",
      "technique": "header_analysis"
    },
    {
      "confidence": 1,
      "result": {
        "original_header": "Appendix A. Illustrative examples with `combine_CpG_sites.py` <a name=\"appA\"></a>",
        "parent_header": [
          "DMRfinder: efficiently identifying differentially methylated regions from MethylC-seq data"
        ],
        "type": "Text_excerpt",
        "value": "In this section, we will demonstrate the three-step process for producing genomic regions as implemented in `combine_CpG_sites.py`.  We will use a simplified set of methylation counts for two samples, C1 and C2, as produced by `extract_CpG_data.py` (for simplification, the third and fourth columns are not shown):\n```\n      C1.cov                       C2.cov\nchrZ   100   0   1           chrZ   100   1   2\nchrZ   120   1   2           chrZ   120   2   3\nchrZ   200   0   4           chrZ   200   1   5\nchrZ   300   3   3           chrZ   300   0   2\nchrZ   401   2   6           chrZ   401   3   3\nchrZ   450   3   5           chrZ   450   4   5\nchrZ   600   5   2           chrZ   600   6   3\nchrZ   625   4   2           chrZ   625   8   0\nchrZ   650   5   1           chrZ   650   7   1\nchrZ   700   3   2           chrZ   700   3   4\n```\n\nThese files were analyzed using the following command:\n```\n$ python combine_CpG_sites.py  -o results.csv  C1.cov  C2.cov\n```\n\nWith the default parameters (`-r 3  -s 1  -d 100  -c 3  -x 500  -m 20`), `combine_CpG_sites.py` utilized the following procedure.\n\nFirst, with the default of `-r 3`, it determined which CpG sites in each sample had at least three methylated/unmethylated counts (the sum of the last two columns of the data).  For sample C1, all the sites met this criterion except for position 100; in sample C2, only position 300 failed to have at least three counts.  After this, the collective validity of the CpG sites was evaluated; with the default of `-s 1`, only one sample needed to meet the `-r` threshold at each location.  Therefore, all CpG sites were considered valid.  Note that, if `-s 2` had been set, the CpG sites at positions 100 and 300 would have been discarded, because fewer than two samples had sufficient counts at those sites.\n\nNext, regions of adjacent CpG sites were defined.  With the default maximum distance between CpG sites of 100bp  (`-d 100`), this dataset was clustered into three groups: (100, 120, 200, 300); (401, 450); (600, 625, 650, 700).  After this, any clusters smaller than the minimum size were eliminated; with the default value of three (`-c 3`), the second cluster was removed, leaving (100, 120, 200, 300) and (600, 625, 650, 700).  The maximum length parameter (`-x 500`) did not affect the remaining clusters, since neither was longer than 500bp.\n\nFinally, the methylation counts within these clusters were summed for each sample, and those failing to meet the threshold established by the `-m` parameter were reported as `NA`.  With the first cluster, the sum of counts for sample C1 was 14, and that for sample C2 was 16.  Therefore, since neither sample met the threshold (`-m 20`), this cluster was not even reported in the output.  For the remaining cluster, the sum of methylated counts for both samples was placed in their respective `-X` columns, and the total sum of counts was in the `-N` columns. \n\nHere is the resulting output:\n```\nchr   start  end   CpG   C1-N   C1-X   C2-N   C2-X\nchrZ   600   700    4     24     17     32     24\n```\n\nHere are some results produced by `combine_CpG_sites.py` using parameters other than the defaults.\n\n`-m 15`:\n```\nchr   start  end   CpG   C1-N   C1-X   C2-N   C2-X\nchrZ   100   300    4     NA     NA     16      4\nchrZ   600   700    4     24     17     32     24\n```\n\n`-m 10`:\n```\nchr   start  end   CpG   C1-N   C1-X   C2-N   C2-X\nchrZ   120   300    4     14      4     16      4\nchrZ   600   700    4     24     17     32     24\n```\n\n`-r 2  -s 2  -m 10`:\n```\nchr   start  end   CpG   C1-N   C1-X   C2-N   C2-X\nchrZ   120   300    3     13      4     13      3\nchrZ   600   700    4     24     17     32     24\n```\n\n`-c 2  -x 50  -m 10`:\n```\nchr   start  end   CpG   C1-N   C1-X   C2-N   C2-X\nchrZ   200   300    2     10      3     NA     NA\nchrZ   401   450    2     16      5     15      7\nchrZ   600   625    2     13      9     17     14\nchrZ   650   700    2     11      8     15     10\n```\n<br>\n\n"
      },
      "source": "https://raw.githubusercontent.com/jsh58/DMRfinder/master/README.md",
      "technique": "header_analysis"
    },
    {
      "confidence": 1,
      "result": {
        "original_header": "Appendix B. Illustrative examples with `findDMRs.r` <a name=\"appB\"></a>",
        "parent_header": [
          "DMRfinder: efficiently identifying differentially methylated regions from MethylC-seq data"
        ],
        "type": "Text_excerpt",
        "value": "In this section, we will outline how the statistical results from DSS are incorporated into the output of this script.  We will use a simplified dataset for two groups (Control and Experimental), each of which had two samples (C1/C2 and E1/E2).  Here is the input, as produced by `combine_CpG_sites.py`:\n```\nchr  start  end  CpG  C1-N  C1-X  C2-N  C2-X  E1-N  E1-X  E2-N  E2-X\nchrZ  100   300   4    14     4    16     4    21    10    30     8\nchrZ  600   700   4    24    17    32    24    28    15    35    16\n```\n\nThis file was analyzed using the following command:\n```\n$ Rscript findDMRs.r  -i input.csv  -o output.csv  C1,C2  E1,E2  -n Ctrl,Exp\n```\n\nHere is the resulting output:\n```\nchr   start  end  CpG   Ctrl:mu   Exp:mu   Ctrl->Exp:diff  Ctrl->Exp:pval\nchrZ   600   700   4   0.727412  0.493122    -0.2342893      0.0302165\n```\n\nThis shows that, for the genomic region of `chrZ:600-700`, the methylation levels (`mu`) in the Control and Experimental groups were 72.7% and 49.3%, respectively.  Therefore, the difference of -23.4% easily met the 10% default threshold, and the *p*-value of 0.03 was below the default value of 0.05.  The other region, `chrZ:100-300`, was not reported in the output because it failed to meet one or both thresholds.\n\nTo get the `mu`, `diff`, and `pval` results for every region (except those whose results are just `NA`), we can run `findDMRs.r` with `-d 0  -p 1`:\n```\nchr   start  end  CpG   Ctrl:mu   Exp:mu   Ctrl->Exp:diff  Ctrl->Exp:pval\nchrZ   100   300   4   0.273988  0.362521     0.0885337      0.4701449\nchrZ   600   700   4   0.727412  0.493122    -0.2342893      0.0302165\n```\n\nFrom this we can see that the first genomic region (`chrZ:100-300`) had a methylation difference less than the 10% threshold, and a large *p*-value as well.\n\n"
      },
      "source": "https://raw.githubusercontent.com/jsh58/DMRfinder/master/README.md",
      "technique": "header_analysis"
    }
  ]
}