{
  "application_domain": [
    {
      "confidence": 17.66,
      "result": {
        "type": "String",
        "value": "Computer Vision"
      },
      "technique": "supervised_classification"
    }
  ],
  "code_repository": [
    {
      "confidence": 1,
      "result": {
        "type": "Url",
        "value": "https://github.com/kuijjerlab/lionessR"
      },
      "technique": "GitHub_API"
    }
  ],
  "date_created": [
    {
      "confidence": 1,
      "result": {
        "type": "Date",
        "value": "2019-07-31T11:14:38Z"
      },
      "technique": "GitHub_API"
    }
  ],
  "date_updated": [
    {
      "confidence": 1,
      "result": {
        "type": "Date",
        "value": "2024-07-27T19:54:03Z"
      },
      "technique": "GitHub_API"
    }
  ],
  "description": [
    {
      "confidence": 1,
      "result": {
        "type": "String",
        "value": "Single sample network reconstruction in R"
      },
      "technique": "GitHub_API"
    },
    {
      "confidence": 0.9885428250887188,
      "result": {
        "original_header": "An R package for single sample network reconstruction",
        "type": "Text_excerpt",
        "value": "Below we describe an example of co-expression network analysis using lionessR. This code is also available in the lionessR vignette.\n \n"
      },
      "source": "https://raw.githubusercontent.com/kuijjerlab/lionessR/master/README.md",
      "technique": "supervised_classification"
    }
  ],
  "download_url": [
    {
      "confidence": 1,
      "result": {
        "type": "Url",
        "value": "https://github.com/kuijjerlab/lionessR/releases"
      },
      "technique": "GitHub_API"
    }
  ],
  "forks_count": [
    {
      "confidence": 1,
      "result": {
        "type": "Number",
        "value": 2
      },
      "technique": "GitHub_API"
    }
  ],
  "forks_url": [
    {
      "confidence": 1,
      "result": {
        "type": "Url",
        "value": "https://api.github.com/repos/kuijjerlab/lionessR/forks"
      },
      "technique": "GitHub_API"
    }
  ],
  "full_name": [
    {
      "confidence": 1,
      "result": {
        "type": "String",
        "value": "kuijjerlab/lionessR"
      },
      "technique": "GitHub_API"
    }
  ],
  "full_title": [
    {
      "confidence": 1,
      "result": {
        "type": "String",
        "value": "lionessR"
      },
      "source": "https://raw.githubusercontent.com/kuijjerlab/lionessR/master/README.md",
      "technique": "regular_expression"
    }
  ],
  "images": [
    {
      "confidence": 1,
      "result": {
        "type": "Url",
        "value": "https://user-images.githubusercontent.com/5340797/54591309-43e9fa00-4a2a-11e9-9b58-da43ce450bbf.png"
      },
      "source": "https://raw.githubusercontent.com/kuijjerlab/lionessR/master/README.md",
      "technique": "regular_expression"
    }
  ],
  "installation": [
    {
      "confidence": 0.9999999915656161,
      "result": {
        "original_header": "An R package for single sample network reconstruction",
        "type": "Text_excerpt",
        "value": "The easiest way to install the R package lionessR is via the devtools package from CRAN:\n```\ninstall.packages(\"devtools\")\nlibrary(devtools)\ndevtools::install_github(\"kuijjerlab/lionessR\")\n```\nAnd then load the package using: BASH3*. \n"
      },
      "source": "https://raw.githubusercontent.com/kuijjerlab/lionessR/master/README.md",
      "technique": "supervised_classification"
    }
  ],
  "issue_tracker": [
    {
      "confidence": 1,
      "result": {
        "type": "Url",
        "value": "https://api.github.com/repos/kuijjerlab/lionessR/issues"
      },
      "technique": "GitHub_API"
    }
  ],
  "keywords": [
    {
      "confidence": 1,
      "result": {
        "type": "String",
        "value": ""
      },
      "technique": "GitHub_API"
    }
  ],
  "license": [
    {
      "confidence": 1,
      "result": {
        "name": "Other",
        "spdx_id": "NOASSERTION",
        "type": "License",
        "url": null,
        "value": null
      },
      "technique": "GitHub_API"
    },
    {
      "confidence": 1,
      "result": {
        "type": "File_dump",
        "value": "cc-by-4.0\n"
      },
      "source": "https://raw.githubusercontent.com/kuijjerlab/lionessR/master/LICENSE.md",
      "technique": "file_exploration"
    }
  ],
  "name": [
    {
      "confidence": 1,
      "result": {
        "type": "String",
        "value": "lionessR"
      },
      "technique": "GitHub_API"
    }
  ],
  "owner": [
    {
      "confidence": 1,
      "result": {
        "type": "Organization",
        "value": "kuijjerlab"
      },
      "technique": "GitHub_API"
    }
  ],
  "programming_languages": [
    {
      "confidence": 1,
      "result": {
        "name": "R",
        "size": 2494,
        "type": "Programming_language",
        "value": "R"
      },
      "technique": "GitHub_API"
    }
  ],
  "readme_url": [
    {
      "confidence": 1,
      "result": {
        "type": "Url",
        "value": "https://raw.githubusercontent.com/kuijjerlab/lionessR/master/README.md"
      },
      "technique": "file_exploration"
    }
  ],
  "somef_missing_categories": [
    "citation",
    "acknowledgement",
    "run",
    "download",
    "requirements",
    "contact",
    "contributors",
    "documentation",
    "faq",
    "support",
    "identifier",
    "has_build_file",
    "executable_example"
  ],
  "somef_provenance": {
    "date": "2024-11-04 01:55:47",
    "somef_schema_version": "1.0.0",
    "somef_version": "0.9.5"
  },
  "stargazers_count": [
    {
      "confidence": 1,
      "result": {
        "type": "Number",
        "value": 7
      },
      "technique": "GitHub_API"
    }
  ],
  "usage": [
    {
      "confidence": 1,
      "result": {
        "original_header": "Example: single-sample co-expression network analysis in osteosarcoma",
        "parent_header": [
          "lionessR"
        ],
        "type": "Text_excerpt",
        "value": "As an example of how to model single-sample networks using lionessR, we will reconstruct and analyze co-expression networks for individual osteosarcoma patients. Osteosarcoma is an aggressive primary bone tumor that has a peak incidence in adolescents and young adults. The leading cause of death of osteosarcoma is distant metastases, which develop in 45% of patients. Detection of differential co-expression between osteosarcoma biopsies of patients with short and long metastasis-free survival (MFS) may help better understand metastasis development, and may point to targets for treatment.\n\nOur example dataset contains gene expression data for pre-treatment biopsies of two groups of patients\u2014one group contains 19 patients who did not develop any metastases within 5 years after diagnosis of the primary tumor (long-term metastasis-free survivors), the other group contains 34 patients who did developed metastases within 5 years (short-term metastasis-free survivors).\n\nFor this analysis, we need to load the following packages:\n```\nlibrary(devtools)\nlibrary(lionessR)\nlibrary(igraph)\nlibrary(reshape2)\nlibrary(limma)\n```\nTo start, we load the dataset in R:\n```\ndata(OSdata)\n```\nThis dataset contains an object exp with expression data for these 53 patients and an object ```targets``` with information on which patients developed metastases within 5 years. Because co-expression networks are usually very large, we subset this dataset to the 500 most variably expressed genes. To do this, we will sort the dataset based on the standard deviation of expression levels of each gene, and will select the top 500 genes:\n```\nnsel=500\ncvar <- apply(as.array(as.matrix(exp)), 1, sd)\ndat <- cbind(cvar, exp)\ndat <- dat[order(dat[,1], decreasing=T),]\ndat <- dat[1:nsel, -1]\ndat <- as.matrix(dat)\n```\nNext, we will make two condition-specific networks, one for the short-term and one for the long-term MFS group. We calculate the difference between these condition-specific network adjacency matrices, so that we can use this to select edges that have large absolute differences in their co-expression levels:\n```\ngroupyes <- which(targets$mets==\"yes\")\ngroupno <- which(targets$mets==\"no\")\nnetyes <- cor(t(dat[,groupyes]))\nnetno <- cor(t(dat[,groupno]))\nnetdiff <- netyes-netno\n```\nWe use R packages ```igraph``` and ```reshape2``` to convert these adjacency matrices to edgelists. As this is a symmetric adjacency matrix, we takeconvert the upper triangle of the co-expression adjacency matrix into an edge list. We then select those edges that have a difference in Pearson R correlation coefficient of at least 0.5:\n```\ncormat2 <- rep(1:nsel, each=nsel)\ncormat1 <- rep(1:nsel,nsel)\nel <- cbind(cormat1, cormat2, c(netdiff))\nmelted <- melt(upper.tri(netdiff))\nmelted <- melted[which(melted$value),]\nvalues <- netdiff[which(upper.tri(netdiff))]\nmelted <- cbind(melted[,1:2], values)\ngenes <- row.names(netdiff)\nmelted[,1] <- genes[melted[,1]]\nmelted[,2] <- genes[melted[,2]]\nrow.names(melted) <- paste(melted[,1], melted[,2], sep=\"_\")\ntosub <- melted\ntosel <- row.names(tosub[which(abs(tosub[,3])>0.5),])\n```\nNext, we\u2019ll model the single-sample networks based on co-expression using lionessR. Note that, depending on the size of the dataset, this could take some time to run. We subset these networks to the selection of edges which we had defined above:\n```\ncormat <- lioness(dat, netFun)\nrow.names(cormat) <- paste(cormat[,1], cormat[,2], sep=\"_\")\ncorsub <- cormat[which(row.names(cormat) %in% tosel),3:ncol(cormat)]\ncorsub <- as.matrix(corsub)\n```\nWe then run a LIMMA analysis on these edges:\n```\ngroup <- factor(targets[,2])\ndesign <- model.matrix(~0+group)\ncont.matrix <- makeContrasts(yesvsno = (groupyes - groupno), levels = design)  \nfit <- lmFit(corsub, design)\nfit2 <- contrasts.fit(fit, cont.matrix)\nfit2e <- eBayes(fit2)\ntoptable <- topTable(fit2e, number=nrow(corsub), adjust=\"fdr\")\n```\nWe select the top 50 most differentially co-expressed edges and convert them into an igraph graph.data.frame object for visualization. We color edges red if they have higher coefficients in the short-term MFS group, and blue if they have higher coefficients in the long-term MFS group:\n```\ntoptable_edges <- t(matrix(unlist(c(strsplit(row.names(toptable), \"_\"))),2))\nz <- cbind(toptable_edges[1:50,], toptable$logFC[1:50])\ng <- graph.data.frame(z, directed=F)\nE(g)$weight <- as.numeric(z[,3])\nE(g)$color[E(g)$weight<0] <- \"blue\"\nE(g)$color[E(g)$weight>0] <- \"red\"\nE(g)$weight <- 1\n```\nNext, we perform a LIMMA analysis on gene expression so that we can also color nodes based on their differential expression:\n```\ntopgeneslist <- unique(c(toptable_edges[1:50,]))\nfit <- lmFit(exp, design)\nfit2 <- contrasts.fit(fit, cont.matrix)\nfit2e <- eBayes(fit2)\ntopDE <- topTable(fit2e, number=nrow(exp), adjust=\"fdr\")\ntopDE <- topDE[which(row.names(topDE) %in% topgeneslist),]\ntopgenesDE <- cbind(row.names(topDE), topDE$t)\n```\nWe color nodes based on the t-statistic from the LIMMA analysis:\n```\n# add t-statistic to network nodes\nnodeorder <- cbind(V(g)$name, 1:length(V(g)))\nnodes <- merge(nodeorder, topgenesDE, by.x=1, by.y=1)\nnodes <- nodes[order(as.numeric(as.character(nodes[,2]))),]\nnodes[,3] <- as.numeric(as.character(nodes[,3]))\nnodes <- nodes[,-2]\nV(g)$weight <- nodes[,2]\n\n# make a color palette\nmypalette4 <- colorRampPalette(c(\"blue\",\"white\",\"white\",\"red\"), space=\"Lab\")(256) \nbreaks2a <- seq(min(V(g)$weight), 0, length.out=128)\nbreaks2b <- seq(0.00001, max(V(g)$weight)+0.1,length.out=128)\nbreaks4 <- c(breaks2a,breaks2b)\n\n# select bins for colors\nbincol <- rep(NA, length(V(g)))\nfor(i in 1:length(V(g))){\n    bincol[i] <- min(which(breaks4>V(g)$weight[i]))\n}\nbincol <- mypalette4[bincol]\n    \n# add colors to nodes\nV(g)$color <- bincol\n```\nFinally, we visualize these results in a network diagram of the 50 most significant edges from the LIMMA analysis:\n```\npar(mar=c(0,0,0,0))\nplot(g, vertex.label.cex=0.7, vertex.size=10, vertex.label.color = \"black\", vertex.label.font=3, edge.width=10*(abs(as.numeric(z[,3]))-0.7), vertex.color=V(g)$color)\n```\nThis will return the following image:\n![osfig](https://user-images.githubusercontent.com/5340797/54591309-43e9fa00-4a2a-11e9-9b58-da43ce450bbf.png)\n\nHere, edges are colored based on whether they have higher weights in patients with poor (red) or better (blue) MFS. Thicker edges represent higher log fold changes. Nodes (genes) are colored based on the t-statistic from the differential expression analysis. Nodes with absolute t-statistic < 1.5 are shown in white, nodes in red/blue have higher expression in patients with poor/better MFS, respectively.\n"
      },
      "source": "https://raw.githubusercontent.com/kuijjerlab/lionessR/master/README.md",
      "technique": "header_analysis"
    }
  ]
}