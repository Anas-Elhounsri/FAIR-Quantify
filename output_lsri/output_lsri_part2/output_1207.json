{
  "acknowledgement": [
    {
      "confidence": 1,
      "result": {
        "original_header": "Acknowledgements and third party licences",
        "parent_header": [
          "gofasta"
        ],
        "type": "Text_excerpt",
        "value": "gofasta incorporates [b\u00edogo](https://github.com/biogo/biogo), which is distributed under licence. Its licence is reproduced under `THIRD_PARTY_LICENCES/biogo` or run `gofasta licences` to print it.\n\ngofasta uses a slightly modified version of the bit-level coding scheme for nucleotides by Emmanuel Paradis, which is used in [ape](https://doi.org/10.1093/bioinformatics/btg412). For a description of it, see [here](https://emmanuelparadis.github.io/misc/BitLevelCodingScheme.html).\n\nThe functions with SAM files as input were written to handle pairwise alignments between assembled SARS-CoV-2 genomes from [minimap2](https://github.com/lh3/minimap2).\n\n"
      },
      "source": "https://raw.githubusercontent.com/virus-evolution/gofasta/master/README.md",
      "technique": "header_analysis"
    }
  ],
  "application_domain": [
    {
      "confidence": 0.8895831378920654,
      "result": {
        "type": "String",
        "value": "Semantic web"
      },
      "technique": "supervised_classification"
    }
  ],
  "code_repository": [
    {
      "confidence": 1,
      "result": {
        "type": "Url",
        "value": "https://github.com/virus-evolution/gofasta"
      },
      "technique": "GitHub_API"
    }
  ],
  "date_created": [
    {
      "confidence": 1,
      "result": {
        "type": "Date",
        "value": "2020-08-27T14:15:56Z"
      },
      "technique": "GitHub_API"
    }
  ],
  "date_updated": [
    {
      "confidence": 1,
      "result": {
        "type": "Date",
        "value": "2024-09-26T08:48:19Z"
      },
      "technique": "GitHub_API"
    }
  ],
  "description": [
    {
      "confidence": 0.9393451627181435,
      "result": {
        "original_header": "gofasta",
        "type": "Text_excerpt",
        "value": "\ngofasta is a command-line utility developed to handle SARS-CoV-2 alignments, but should be useful more generally for handling consensus genomes of any microbial pathogen. It has been used on datasets of millions of sequences, including by the United Kingdom's [daily SARS-CoV-2 genome processing pipelines](https://github.com/COG-UK), [Pangolin](https://github.com/cov-lineages/pangolin) and [Civet](https://github.com/artic-network/civet). \nIf you use gofasta in your work, please cite [https://doi.org/10.1093/bioinformatics/btac424](https://doi.org/10.1093/bioinformatics/btac424).\n \n"
      },
      "source": "https://raw.githubusercontent.com/virus-evolution/gofasta/master/README.md",
      "technique": "supervised_classification"
    },
    {
      "confidence": 0.9089095354318502,
      "result": {
        "original_header": "Commands",
        "type": "Text_excerpt",
        "value": "For a full list of commands and options, you can run `gofasta` with the `-h` flag at the command line: `gofasta -h`,  `gofasta sam -h`, `gofasta sam variants -h`, etc.  \ne.g., for `gofasta updown list -h`: \n```\n\u276f gofasta updown list -h\nGenerate input CSV files for gofasta updown topranking \nNon-ATGC nucleotides are not recommended in the --reference, and --reference and --query must\nbe aligned to the same thing. \n--outfile is a CSV-format file with the columns: query,SNPs,ambiguities,SNPcount,ambcount. There is one row\nfor each sequence in --query. SNPs is a \"|\"-delimited list of SNPs relative to --reference. ambiguities is\na \"|\"-delimited list of ranges (1-based, inclusive) of tracts of ambiguities (anything that isn't ATGC).\n \n"
      },
      "source": "https://raw.githubusercontent.com/virus-evolution/gofasta/master/README.md",
      "technique": "supervised_classification"
    },
    {
      "confidence": 0.9641037393469246,
      "result": {
        "original_header": "Context, limitations and alternatives",
        "type": "Text_excerpt",
        "value": "Alternatives to minimap2 for pairwise viral genome alignment exist. Notably, [Nextalign](https://github.com/nextstrain/nextclade) [(Aksamentov et al. 2021)](https://joss.theoj.org/papers/10.21105/joss.03773.pdf) can use a genome annotation to apply a reading-frame-aware gap penalty, and will perform translation and amino acid alignment to call amino acid mutations.  \ngofasta\u2019s functions for finding the closest genetic neighbours to a set of query sequences were designed for the specific use-case of querying a large dataset of target genomes by genetic distance to place a smaller set of focal sequences in context, without having to infer all the phylogenetic relationships between hundreds of thousands or millions of sequences. An alternative approach is currently provided by an up-to-date a [maximum parsimony phylogenetic tree consisting of publicly available SARS-CoV-2 genomes](https://hgdownload.soe.ucsc.edu/goldenPath/wuhCor1/UShER_SARS-CoV-2/) [(McBroome et al. 2021)](https://academic.oup.com/mbe/article/38/12/5819/6361626) [and associated software](https://github.com/yatisht/usher) which can be used for placing new samples and querying the dataset [(Turakhia et al. 2021)](https://www.nature.com/articles/s41588-021-00862-7). \nOther software exists for calculating pairwise genetic distances, including [tn93](https://github.com/veg/tn93) and [pairsnp](https://github.com/gtonkinhill/pairsnp).\n \n"
      },
      "source": "https://raw.githubusercontent.com/virus-evolution/gofasta/master/README.md",
      "technique": "supervised_classification"
    }
  ],
  "download_url": [
    {
      "confidence": 1,
      "result": {
        "type": "Url",
        "value": "https://github.com/virus-evolution/gofasta/releases"
      },
      "technique": "GitHub_API"
    }
  ],
  "forks_count": [
    {
      "confidence": 1,
      "result": {
        "type": "Number",
        "value": 1
      },
      "technique": "GitHub_API"
    }
  ],
  "forks_url": [
    {
      "confidence": 1,
      "result": {
        "type": "Url",
        "value": "https://api.github.com/repos/virus-evolution/gofasta/forks"
      },
      "technique": "GitHub_API"
    }
  ],
  "full_name": [
    {
      "confidence": 1,
      "result": {
        "type": "String",
        "value": "virus-evolution/gofasta"
      },
      "technique": "GitHub_API"
    }
  ],
  "full_title": [
    {
      "confidence": 1,
      "result": {
        "type": "String",
        "value": "gofasta"
      },
      "source": "https://raw.githubusercontent.com/virus-evolution/gofasta/master/README.md",
      "technique": "regular_expression"
    }
  ],
  "images": [
    {
      "confidence": 1,
      "result": {
        "type": "Url",
        "value": "https://raw.githubusercontent.com/virus-evolution/gofasta/master/.github/help.png"
      },
      "source": "https://raw.githubusercontent.com/virus-evolution/gofasta/master/README.md",
      "technique": "regular_expression"
    }
  ],
  "installation": [
    {
      "confidence": 1,
      "result": {
        "original_header": "Installation",
        "parent_header": [
          "gofasta"
        ],
        "type": "Text_excerpt",
        "value": "Binaries are available for Mac OSX and Linux under the [latest release](https://github.com/virus-evolution/gofasta/releases/latest),\n\nor you can install gofasta from Bioconda:\n\n`conda install bioconda::gofasta`\n\nIf you have [Go](https://go.dev/) installed, you can run `go install github.com/virus-evolution/gofasta@latest` to build a binary of the latest release locally (maybe in `~/go/bin/`). Branches, commits or tags other than `latest` can be built in the same way.\n\nYou can also build the contents of this repository:\n\n```\ngit clone https://github.com/virus-evolution/gofasta.git\ncd gofasta\ngo build -o gofasta\n```\n"
      },
      "source": "https://raw.githubusercontent.com/virus-evolution/gofasta/master/README.md",
      "technique": "header_analysis"
    },
    {
      "confidence": 0.8589566391314982,
      "result": {
        "original_header": "Commands",
        "type": "Text_excerpt",
        "value": "For a full list of commands and options, you can run `gofasta` with the `-h` flag at the command line: `gofasta -h`,  `gofasta sam -h`, `gofasta sam variants -h`, etc.  \n<details><summary><b>Click to see the help message</b></summary> \n"
      },
      "source": "https://raw.githubusercontent.com/virus-evolution/gofasta/master/README.md",
      "technique": "supervised_classification"
    }
  ],
  "invocation": [
    {
      "confidence": 0.8305874149617276,
      "result": {
        "original_header": "Commands",
        "type": "Text_excerpt",
        "value": "```\n\u276f gofasta updown list -h\nGenerate input CSV files for gofasta updown topranking \nExample usage: \n"
      },
      "source": "https://raw.githubusercontent.com/virus-evolution/gofasta/master/README.md",
      "technique": "supervised_classification"
    }
  ],
  "issue_tracker": [
    {
      "confidence": 1,
      "result": {
        "type": "Url",
        "value": "https://api.github.com/repos/virus-evolution/gofasta/issues"
      },
      "technique": "GitHub_API"
    }
  ],
  "keywords": [
    {
      "confidence": 1,
      "result": {
        "type": "String",
        "value": ""
      },
      "technique": "GitHub_API"
    }
  ],
  "license": [
    {
      "confidence": 1,
      "result": {
        "name": "MIT License",
        "spdx_id": "MIT",
        "type": "License",
        "url": "https://api.github.com/licenses/mit",
        "value": "https://api.github.com/licenses/mit"
      },
      "technique": "GitHub_API"
    },
    {
      "confidence": 1,
      "result": {
        "type": "File_dump",
        "value": "Copyright 2020 Ben Jackson\n\nPermission is hereby granted, free of charge, to any person obtaining a copy of this software and associated documentation files (the \"Software\"), to deal in the Software without restriction, including without limitation the rights to use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies of the Software, and to permit persons to whom the Software is furnished to do so, subject to the following conditions:\n\nThe above copyright notice and this permission notice shall be included in all copies or substantial portions of the Software.\n\nTHE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.\n"
      },
      "source": "https://raw.githubusercontent.com/virus-evolution/gofasta/master/LICENSE",
      "technique": "file_exploration"
    },
    {
      "confidence": 1,
      "result": {
        "original_header": "Acknowledgements and third party licences",
        "parent_header": [
          "gofasta"
        ],
        "type": "Text_excerpt",
        "value": "gofasta incorporates [b\u00edogo](https://github.com/biogo/biogo), which is distributed under licence. Its licence is reproduced under `THIRD_PARTY_LICENCES/biogo` or run `gofasta licences` to print it.\n\ngofasta uses a slightly modified version of the bit-level coding scheme for nucleotides by Emmanuel Paradis, which is used in [ape](https://doi.org/10.1093/bioinformatics/btg412). For a description of it, see [here](https://emmanuelparadis.github.io/misc/BitLevelCodingScheme.html).\n\nThe functions with SAM files as input were written to handle pairwise alignments between assembled SARS-CoV-2 genomes from [minimap2](https://github.com/lh3/minimap2).\n\n"
      },
      "source": "https://raw.githubusercontent.com/virus-evolution/gofasta/master/README.md",
      "technique": "header_analysis"
    }
  ],
  "name": [
    {
      "confidence": 1,
      "result": {
        "type": "String",
        "value": "gofasta"
      },
      "technique": "GitHub_API"
    }
  ],
  "owner": [
    {
      "confidence": 1,
      "result": {
        "type": "Organization",
        "value": "virus-evolution"
      },
      "technique": "GitHub_API"
    }
  ],
  "programming_languages": [
    {
      "confidence": 1,
      "result": {
        "name": "Go",
        "size": 4763533,
        "type": "Programming_language",
        "value": "Go"
      },
      "technique": "GitHub_API"
    }
  ],
  "readme_url": [
    {
      "confidence": 1,
      "result": {
        "type": "Url",
        "value": "https://raw.githubusercontent.com/virus-evolution/gofasta/master/README.md"
      },
      "technique": "file_exploration"
    }
  ],
  "releases": [
    {
      "confidence": 1,
      "result": {
        "author": {
          "name": "benjamincjackson",
          "type": "User"
        },
        "date_created": "2023-08-10T22:42:59Z",
        "date_published": "2023-08-10T22:55:05Z",
        "description": "#### Notes\r\n\r\nThis minor release fixes the following bugs:\r\n\r\n* Ambiguous alignment positions are now reported in 1-based coordinates (instead of 0-based) when parsing sam files.\r\n* The `--wrap`/`-w` argument to `gofasta sam toMultiAlign` and `toPairAlign` no longer has a default value of 80 nucleotides if you invoke the flag on the command line without an argument. This is to fix a bug in flag parsing.\r\n\r\n\r\n#### Full changelog:  \r\nhttps://github.com/virus-evolution/gofasta/compare/v1.2.0...v1.2.1",
        "html_url": "https://github.com/virus-evolution/gofasta/releases/tag/v1.2.1",
        "name": "v1.2.1",
        "release_id": 115998530,
        "tag": "v1.2.1",
        "tarball_url": "https://api.github.com/repos/virus-evolution/gofasta/tarball/v1.2.1",
        "type": "Release",
        "url": "https://api.github.com/repos/virus-evolution/gofasta/releases/115998530",
        "value": "https://api.github.com/repos/virus-evolution/gofasta/releases/115998530",
        "zipball_url": "https://api.github.com/repos/virus-evolution/gofasta/zipball/v1.2.1"
      },
      "technique": "GitHub_API"
    },
    {
      "confidence": 1,
      "result": {
        "author": {
          "name": "benjamincjackson",
          "type": "User"
        },
        "date_created": "2023-01-23T13:02:52Z",
        "date_published": "2023-01-23T13:17:43Z",
        "description": "#### Notes\r\n\r\nThis release incorporates the following extra functionality:\r\n\r\n* The ability to annotate amino acid changes in genes which are on the reverse strand using `variants` and `sam variants` (#37)\r\n* The ability to restrict the output of `variants` and `sam variants` by genomic position\r\n* The ability to wrap the output fastas produced by `sam toMultiAlign` and `sam toPairAlign` to a set number of bases wide\r\n\r\nAnd fixes the following bugs:\r\n\r\n* Fasta files with records up to 1MB on a single line can now be read without overflowing the buffer (#37)\r\n* Genbank and gff protein-coding features on the reverse strand are now handled (see above)\r\n\r\n#### Full changelog:  \r\nhttps://github.com/virus-evolution/gofasta/compare/v1.1.0...v1.2.0",
        "html_url": "https://github.com/virus-evolution/gofasta/releases/tag/v1.2.0",
        "name": "v1.2.0",
        "release_id": 89904005,
        "tag": "v1.2.0",
        "tarball_url": "https://api.github.com/repos/virus-evolution/gofasta/tarball/v1.2.0",
        "type": "Release",
        "url": "https://api.github.com/repos/virus-evolution/gofasta/releases/89904005",
        "value": "https://api.github.com/repos/virus-evolution/gofasta/releases/89904005",
        "zipball_url": "https://api.github.com/repos/virus-evolution/gofasta/zipball/v1.2.0"
      },
      "technique": "GitHub_API"
    },
    {
      "confidence": 1,
      "result": {
        "author": {
          "name": "benjamincjackson",
          "type": "User"
        },
        "date_created": "2022-06-22T10:07:32Z",
        "date_published": "2022-06-22T10:11:13Z",
        "description": "#### Notes\r\n\r\nThis release incorporates the following extra functionality:\r\n\r\n* The ability to provide a genome annotation in gff (version 3) format to `variants` and `sam variants`\r\n* The ability to push node distances outwards for non-empty bins in `updown topranking`\r\n* The ability to write long-form outputs including the distances between targets and queries using the `--table` flag for `closest` and `updown topranking` \r\n* Extra distance measures (number of snps and tn93 evolutionary distance) to `closest`\r\n\r\nAnd fixes the following bugs:\r\n\r\n* A reference fasta file is no longer required for `updown topranking` if both target and query input files are csvs\r\n* The same amino acid mutation with different underlying nucleotide mutations is no longer represented twice in the output of `variants` and `sam variants` when using the `--aggregate` flag unless `--append-snps` is also called.\r\n\r\n#### Full changelog:  \r\nhttps://github.com/virus-evolution/gofasta/compare/v1.0.0...v1.1.0",
        "html_url": "https://github.com/virus-evolution/gofasta/releases/tag/v1.1.0",
        "name": "v1.1.0",
        "release_id": 69931614,
        "tag": "v1.1.0",
        "tarball_url": "https://api.github.com/repos/virus-evolution/gofasta/tarball/v1.1.0",
        "type": "Release",
        "url": "https://api.github.com/repos/virus-evolution/gofasta/releases/69931614",
        "value": "https://api.github.com/repos/virus-evolution/gofasta/releases/69931614",
        "zipball_url": "https://api.github.com/repos/virus-evolution/gofasta/zipball/v1.1.0"
      },
      "technique": "GitHub_API"
    },
    {
      "confidence": 1,
      "result": {
        "author": {
          "name": "benjamincjackson",
          "type": "User"
        },
        "date_created": "2022-01-26T20:29:52Z",
        "date_published": "2022-01-26T20:32:46Z",
        "description": "Notes:\r\n\r\n  - This release incorporates a change in the API for `gofasta sam toMultiAlign`, but the old flags and behaviour are retained for backwards compatibility (although they are hidden from the help messages)\r\n  - Bug fix: nucleotides after the last gene in the genbank annotation are now included in the output of `gofasta variants` and `gofasta sam variants` (#28)\r\n\r\n\r\n**Full Changelog**: https://github.com/virus-evolution/gofasta/compare/v0.0.6...v1.0.0",
        "html_url": "https://github.com/virus-evolution/gofasta/releases/tag/v1.0.0",
        "name": "version 1",
        "release_id": 58042422,
        "tag": "v1.0.0",
        "tarball_url": "https://api.github.com/repos/virus-evolution/gofasta/tarball/v1.0.0",
        "type": "Release",
        "url": "https://api.github.com/repos/virus-evolution/gofasta/releases/58042422",
        "value": "https://api.github.com/repos/virus-evolution/gofasta/releases/58042422",
        "zipball_url": "https://api.github.com/repos/virus-evolution/gofasta/zipball/v1.0.0"
      },
      "technique": "GitHub_API"
    },
    {
      "confidence": 1,
      "result": {
        "author": {
          "name": "benjamincjackson",
          "type": "User"
        },
        "date_created": "2021-12-01T10:02:31Z",
        "date_published": "2021-12-06T15:35:54Z",
        "description": "Notes:\r\n\r\n- This release incorporates a change in format of the output of `gofasta sam variants`\r\n- This release fixes a bug when calling `gofasta updown topranking` with the `--size-*` flags",
        "html_url": "https://github.com/virus-evolution/gofasta/releases/tag/v0.0.6",
        "name": "new updown behaviour and code reformat",
        "release_id": 54719511,
        "tag": "v0.0.6",
        "tarball_url": "https://api.github.com/repos/virus-evolution/gofasta/tarball/v0.0.6",
        "type": "Release",
        "url": "https://api.github.com/repos/virus-evolution/gofasta/releases/54719511",
        "value": "https://api.github.com/repos/virus-evolution/gofasta/releases/54719511",
        "zipball_url": "https://api.github.com/repos/virus-evolution/gofasta/zipball/v0.0.6"
      },
      "technique": "GitHub_API"
    },
    {
      "confidence": 1,
      "result": {
        "author": {
          "name": "benjamincjackson",
          "type": "User"
        },
        "date_created": "2021-07-07T14:33:37Z",
        "date_published": "2021-07-13T13:58:57Z",
        "html_url": "https://github.com/virus-evolution/gofasta/releases/tag/v0.0.5",
        "name": "updated updown for civet",
        "release_id": 46122833,
        "tag": "v0.0.5",
        "tarball_url": "https://api.github.com/repos/virus-evolution/gofasta/tarball/v0.0.5",
        "type": "Release",
        "url": "https://api.github.com/repos/virus-evolution/gofasta/releases/46122833",
        "value": "https://api.github.com/repos/virus-evolution/gofasta/releases/46122833",
        "zipball_url": "https://api.github.com/repos/virus-evolution/gofasta/zipball/v0.0.5"
      },
      "technique": "GitHub_API"
    },
    {
      "confidence": 1,
      "result": {
        "author": {
          "name": "benjamincjackson",
          "type": "User"
        },
        "date_created": "2021-05-14T15:39:08Z",
        "date_published": "2021-05-15T18:39:53Z",
        "html_url": "https://github.com/virus-evolution/gofasta/releases/tag/v0.0.4",
        "release_id": 43002247,
        "tag": "v0.0.4",
        "tarball_url": "https://api.github.com/repos/virus-evolution/gofasta/tarball/v0.0.4",
        "type": "Release",
        "url": "https://api.github.com/repos/virus-evolution/gofasta/releases/43002247",
        "value": "https://api.github.com/repos/virus-evolution/gofasta/releases/43002247",
        "zipball_url": "https://api.github.com/repos/virus-evolution/gofasta/zipball/v0.0.4"
      },
      "technique": "GitHub_API"
    },
    {
      "confidence": 1,
      "result": {
        "author": {
          "name": "benjamincjackson",
          "type": "User"
        },
        "date_created": "2021-05-14T16:32:07Z",
        "date_published": "2021-05-15T17:18:18Z",
        "description": "Conda recipe test release",
        "html_url": "https://github.com/virus-evolution/gofasta/releases/tag/v0.0.3.5",
        "release_id": 43001000,
        "tag": "v0.0.3.5",
        "tarball_url": "https://api.github.com/repos/virus-evolution/gofasta/tarball/v0.0.3.5",
        "type": "Release",
        "url": "https://api.github.com/repos/virus-evolution/gofasta/releases/43001000",
        "value": "https://api.github.com/repos/virus-evolution/gofasta/releases/43001000",
        "zipball_url": "https://api.github.com/repos/virus-evolution/gofasta/zipball/v0.0.3.5"
      },
      "technique": "GitHub_API"
    },
    {
      "confidence": 1,
      "result": {
        "author": {
          "name": "benjamincjackson",
          "type": "User"
        },
        "date_created": "2021-02-01T15:46:02Z",
        "date_published": "2021-02-01T16:22:27Z",
        "html_url": "https://github.com/virus-evolution/gofasta/releases/tag/v0.0.3",
        "release_id": 37187130,
        "tag": "v0.0.3",
        "tarball_url": "https://api.github.com/repos/virus-evolution/gofasta/tarball/v0.0.3",
        "type": "Release",
        "url": "https://api.github.com/repos/virus-evolution/gofasta/releases/37187130",
        "value": "https://api.github.com/repos/virus-evolution/gofasta/releases/37187130",
        "zipball_url": "https://api.github.com/repos/virus-evolution/gofasta/zipball/v0.0.3"
      },
      "technique": "GitHub_API"
    },
    {
      "confidence": 1,
      "result": {
        "author": {
          "name": "benjamincjackson",
          "type": "User"
        },
        "date_created": "2020-11-27T10:31:05Z",
        "date_published": "2020-11-27T10:36:08Z",
        "html_url": "https://github.com/virus-evolution/gofasta/releases/tag/v0.0.2",
        "release_id": 34498123,
        "tag": "v0.0.2",
        "tarball_url": "https://api.github.com/repos/virus-evolution/gofasta/tarball/v0.0.2",
        "type": "Release",
        "url": "https://api.github.com/repos/virus-evolution/gofasta/releases/34498123",
        "value": "https://api.github.com/repos/virus-evolution/gofasta/releases/34498123",
        "zipball_url": "https://api.github.com/repos/virus-evolution/gofasta/zipball/v0.0.2"
      },
      "technique": "GitHub_API"
    },
    {
      "confidence": 1,
      "result": {
        "author": {
          "name": "benjamincjackson",
          "type": "User"
        },
        "date_created": "2020-08-28T00:50:30Z",
        "date_published": "2020-08-28T00:55:05Z",
        "html_url": "https://github.com/virus-evolution/gofasta/releases/tag/0.0.1",
        "release_id": 30296608,
        "tag": "0.0.1",
        "tarball_url": "https://api.github.com/repos/virus-evolution/gofasta/tarball/0.0.1",
        "type": "Release",
        "url": "https://api.github.com/repos/virus-evolution/gofasta/releases/30296608",
        "value": "https://api.github.com/repos/virus-evolution/gofasta/releases/30296608",
        "zipball_url": "https://api.github.com/repos/virus-evolution/gofasta/zipball/0.0.1"
      },
      "technique": "GitHub_API"
    },
    {
      "confidence": 1,
      "result": {
        "author": {
          "name": "benjamincjackson",
          "type": "User"
        },
        "date_created": "2020-08-27T14:18:00Z",
        "date_published": "2020-08-28T00:53:02Z",
        "html_url": "https://github.com/virus-evolution/gofasta/releases/tag/v0.0.0",
        "release_id": 30296532,
        "tag": "v0.0.0",
        "tarball_url": "https://api.github.com/repos/virus-evolution/gofasta/tarball/v0.0.0",
        "type": "Release",
        "url": "https://api.github.com/repos/virus-evolution/gofasta/releases/30296532",
        "value": "https://api.github.com/repos/virus-evolution/gofasta/releases/30296532",
        "zipball_url": "https://api.github.com/repos/virus-evolution/gofasta/zipball/v0.0.0"
      },
      "technique": "GitHub_API"
    }
  ],
  "somef_missing_categories": [
    "citation",
    "run",
    "download",
    "requirements",
    "contact",
    "contributors",
    "documentation",
    "faq",
    "support",
    "identifier",
    "has_build_file",
    "executable_example"
  ],
  "somef_provenance": {
    "date": "2024-10-04 13:34:38",
    "somef_schema_version": "1.0.0",
    "somef_version": "0.9.5"
  },
  "stargazers_count": [
    {
      "confidence": 1,
      "result": {
        "type": "Number",
        "value": 34
      },
      "technique": "GitHub_API"
    }
  ],
  "type": [
    {
      "confidence": 0.82,
      "result": {
        "type": "String",
        "value": "commandline-application"
      },
      "technique": "software_type_heuristics"
    }
  ],
  "usage": [
    {
      "confidence": 1,
      "result": {
        "original_header": "Sam to fasta format conversion",
        "parent_header": [
          "gofasta",
          "Usage"
        ],
        "type": "Text_excerpt",
        "value": "[minimap2](https://github.com/lh3/minimap2) provides fast and reliable pairwise alignments between SARS-CoV-2 consensus genomes. gofasta provides utility functions to convert the sam format alignments it outputs into fasta format.\n\nPairwise alignments are less computationally demanding than multiple sequence alignment-proper and they offer an efficient approximation to it when sequences are closely related.\n\n<details><summary><b>Making a single alignment with multiple sequences</b></summary>\n</br>\n\nThis is the pipeline currently used by [Pangolin](https://github.com/cov-lineages/pangolin):\n\n```\nminimap2 -a -x asm20 --sam-hit-only --secondary=no --score-N=0 MN908947.fa unaligned.consensus.fasta -o aligned.sam\n\ngofasta sam toMultiAlign -s aligned.sam --start 266 --end 29674 --pad -o aligned.fasta\n```\n\n`MN908947.fa` is the reference genome for SARS-CoV-2 (here is its [Genbank accession](https://www.ncbi.nlm.nih.gov/nuccore/MN908947.3)), and `unaligned.consensus.fasta` contains all your consensus genomes (in one file). In this case we've clipped the alignment to just the coding sequence (`--start 266 --end 29674`) but replaced the trimmed regions with `N`s to retain the reference length in the output (`--pad`). <b>Insertions relative to the reference are discarded from the output file so everything is the same (== reference) length.</b>\n\n\nminimap2 and gofasta can both make use of multiple threads. Additionally, minimap2 writes to stdout by default and gofasta reads from stdin if we don't specify a file for `-s`, so we can avoid writing the intermediate sam to disk entirely. Both of these should speed things up:\n\n```\nminimap2 -t8 -a -x asm20 --score-N=0 MN908947.fa unaligned.consensus.fasta | gofasta sam toma -t2 > aligned.fasta\n```\n\nWe give minimap2 more threads here because it's doing more work. `toma` is just an alias for `toMultiAlign`.\n\n<i>But I don't want to have to write all this code every time I want to align something</i>. That's understandable. In which case you could define a shell function in your `~/.zshrc` or `~/.bashrc` file, something like:\n\n```\nfunction align() {\n  minimap2 -a -x asm20 --score-N=0 ~/path/to/MN908947.fa $1 | gofasta sam toma\n}\n```\n\nand then you can run `align unaligned.consensus.fasta > aligned.fasta` in your terminal.\n\n</details>\n\n<details><summary><b>Making pairwise alignments (including insertions)</b></summary>\n</br>\ngofasta will also convert the minimap2 alignment into pairwise alignments, writing one file per consensus genome, including insertions relative to the reference and writing the reference itself to the output files:\n\n```\nminimap2 -a -x asm20 --score-N=0 MN908947.fa unaligned.consensus.fasta |\\\n  gofasta sam toPairAlign -r MN908947.fa -o outputdir\n```\n\n`outputdir` is a directory which will be created if it does not already exist. Individual fasta files will be written to `outputdir/*fasta`. Filenames are derived from the fasta descriptions (with `/` replaced by `_`).\n\nJust as with `toMultiAlign`, you can clip the alignments to coordinates of your choosing. For example, if you are only interested in the Spike region:\n\n```\nminimap2 -a -x asm20 --score-N=0 MN908947.fa unaligned.consensus.fasta |\\\n  gofasta sam topa -r MN908947.fa --start 21563 --end 25384 -o outputdir\n```\n\n`--start` and `--end` are 1-based inclusive, and they are <i>in reference coordinates</i>. So you will get the region corresponding to the reference Spike regardless of insertions or deletions anywhere in your query genome.\n\nThere is no `--pad` option for `toPairAlign` because we don't expect all the sequences to be reference length.\n\n</details>\n"
      },
      "source": "https://raw.githubusercontent.com/virus-evolution/gofasta/master/README.md",
      "technique": "header_analysis"
    },
    {
      "confidence": 1,
      "result": {
        "original_header": "Searching for neighbours by genetic distance",
        "parent_header": [
          "gofasta",
          "Usage"
        ],
        "type": "Text_excerpt",
        "value": "gofasta provides two utilities to search for the closest genetic neighbours of a number of query sequences among a set of target sequences. In both cases the queries are loaded into memory and the targets are streamed from disk, so the target file can be arbitrarily large.\n\n<details><summary><b>Traditional distance measures</b></summary>\n</br>\n\nUse `gofasta closest` to find the closest neighbours by traditional genetic distance measures:\n\n```\n\u276f gofasta closest --help | sed -n '/Flags/,$p'\nFlags:\n  -t, --threads int       Number of CPUs to use (Default: all available CPUs)\n      --query string      Alignment of sequences to find neighbours for, in fasta format\n      --target string     Alignment of sequences to search for neighbours in, in fasta format\n  -m, --measure string    which distance measure to use (raw, snp or tn93) (default \"raw\")\n  -n, --number int        (Optional) the closest n sequences to each query will be returned\n  -d, --max-dist string   (Optional) return all sequences less than or equal to this distance away\n  -o, --outfile string    The output file to write (default \"stdout\")\n      --table             write a long-form table of the output\n  -h, --help              help for closest\n```\n The available distance measures are `raw` (the default) which is the number of nucleotide differences <i>per site</i> ; `snp`, which is the total number of nucleotide differences, and `tn93`, which is [Tamura and Nei's (1993) evolutionary distance](https://academic.oup.com/mbe/article/10/3/512/1016366).\n\nraw distance is calculated as: `l_d / (l_d + l_s)`, where `l_d` is the number of sites which are certainly different between two sequences and `l_s` is the number of sites which are certainly the same.\n\nsnp distance = `l_d`. For both the raw and snp distances, ambiguous IUPAC codes are treated as the set of bases that they represent.\n\ntn93 distance is calculated according to equation (7) in [the paper](https://academic.oup.com/mbe/article/10/3/512/1016366). Only `ATGC` bases are considered when calculating this measure.\n\nThe routine is parallelised across queries, so there is no point setting `-t` greater than the number of sequences in `--query`.\n\n</details>\n\n<details><summary><b>Directional snp-distance</b></summary>\n</br>\n\nUse `gofasta updown topranking` to find the closest neighbours by (directional) snp distance. This is the routine used by [Civet3](https://github.com/artic-network/civet):\n\n```\n\u276f gofasta updown topranking -h | sed -n '/Flags/,$p'\nFlags:\n  -q, --query string             File with sequences to find neighbours for. Either the CSV output of gofasta updown list, or an alignment in fasta format\n  -t, --target string            File of sequences to look for neighbours in. Either the CSV output of gofasta updown list, or an alignment in fasta format\n  -o, --outfile string           CSV-format file of closest neighbours to write (default \"stdout\")\n      --table                    write a long-form table of the output\n      --ignore string            Optional plain text file of IDs to ignore in the target file when searching for neighbours\n      --dist-all int             Maximum allowed SNP-distance between target and query sequence in any direction. Overrides the settings below\n      --dist-up int              Maximum allowed SNP-distance from query for sequences in the parent bin\n      --dist-down int            Maximum allowed SNP-distance from query for sequences in the child bin\n      --dist-side int            Maximum allowed SNP-distance from query for sequences in the sibling bin\n      --size-total int           Max number of neighbours to find (attempts to split equally between same/up/down/side). A hard limit\n      --size-up int              Max number of closest parent sequences to find, if size-total not specified. A soft limit unless --no-fill\n      --size-down int            Max number of closest child sequences to find, if size-total not specified. A soft limit unless --no-fill\n      --size-side int            Max number of closest sibling sequences to find, if size-total not specified. A soft limit unless --no-fill\n      --size-same int            Max number of identical sequences to find, if size-total not specified. A soft limit unless --no-fill\n      --threshold-pair float32   Up to this proportion of consequential sites is allowed to be ambiguous in either sequence for each pairwise comparison (default 0.1)\n      --threshold-target int     Target can have at most this number of ambiguities to be considered (default 10000)\n      --dist-push int            Push the --dist boundaries outwards so that bins have at least these many closest SNP-distances for which there are neighbours, where possible\n      --no-fill                  Don't make up for a shortfall in any of --size-up, -down, -side or -same by increasing the count for other bins\n  -h, --help                     help for topranking\n\nGlobal Flags:\n  -r, --reference string   Reference sequence, in fasta format, which is treated as the root of the imaginary tree\n```\n\nThis routine has the potential to be faster than traditional genetic distance measures. It uses patterns of derived mutations to make inferences about the likely phylogenetic relationships between closely related sequences. Briefly, sequences are compressed so that they are represented by only their ATGC nucleotide differences from a common reference sequence, which is treated like the root of an imaginary tree. SNPs can either be unique to the query sequence, unique to the target sequence, or present in the intersection of the two. SNPs present in the intersection are interpreted as representing shared ancestry between query and target, whereas an excess of SNPs in either the query or target set can be interpreted to give directionality relative to a root sequence. See [the Civet preprint](https://www.medrxiv.org/content/10.1101/2021.12.13.21267267v1) for a detailed explanation of the scheme (Figure 2 and Figure S1). \n\nThe input `--query` and `--target` files can either be alignments in fasta format, or they can be csv-format files produced by `gofasta updown list` (or one of each). Using the csv-format files should be faster to the extent that they are quicker to read from disk compared to alignments, which initially contain the information for every site.\n\nAn example of command-line use and more explanation is available by running `gofasta updown topranking --help`.\n\n</details>\n"
      },
      "source": "https://raw.githubusercontent.com/virus-evolution/gofasta/master/README.md",
      "technique": "header_analysis"
    },
    {
      "confidence": 1,
      "result": {
        "original_header": "Annotating mutations",
        "parent_header": [
          "gofasta",
          "Usage"
        ],
        "type": "Text_excerpt",
        "value": "Use `gofasta snps` to extract nucleotide changes relative to a reference sequence from a multiple sequence alignment, and `gofasta variants` and `gofasta sam variants` to extract amino acid, indel and nucleotide changes relative to an annotated reference sequence from alignments in fasta and sam format, respectively.\n\n<details><summary><b>Nucleotide changes</b></summary>\n</br>\n\n`gofasta snps` will list all the nucleotide changes in a multiple sequence alignment (`--query`) compared to a reference sequence which is provided in a separate file (`--reference`). The two files have to be the same width (i.e. aligned to the same thing).\n\n```\n\u276f gofasta snps -h | sed -n '/Flags/,$p'\nFlags:\n  -r, --reference string   Reference sequence, in fasta format\n  -q, --query string       Alignment of sequences to find snps in, in fasta format (default \"stdin\")\n  -o, --outfile string     Output to write (default \"stdout\")\n      --hard-gaps          Don't treat alignment gaps as missing data\n      --aggregate          Report the proportions of each change\n      --threshold float    If --aggregate, only report snps with a freq greater than or equal to this value\n  -h, --help               help for snps\n```\n\nThe basic usage creates a csv file with a header and a line for each sequence in `--query`. The first column is the sequence name, and the second column is a '|'-delimited list of nucleotide changes who format is: reference allele, 1-based position in alignment coordinates, query allele.\n\nIUPAC ambiguity codes are treated as the set of bases that they represent, and only certainly-different changes are reported. For example an output of `A101S` is possible, but `A101W` is not. Alignment gaps (`-`) are treated like `N`s (aNy base) unless you use `--hard-gaps`.\n```\n\u276f gofasta snps -r MN908947.fa -q aligned.fasta -o snps.csv\n\u276f\n\u276f head -n2 snps.csv\nquery,SNPs\nquery1,T670G|G4184A|C4321T|C9344T|A9424G|C9534T|C10198T|G10447A|C10449A|G12160A|C12880T|C14408T|C15714T|C17410T|C19955T|A20055G|T21570G|C21618T|G21987A|T22200G|G22578A|T22679C|C22686T|A22688G|A23403G|C23525T|T23599G|C23604A|C23854A|G23948T|T24469A|C25000T|C26060T|C26270T|G27382C|A27383T|T27384C|G27788T|C27807T|A28271T|C28311T|C28724T|G28881A|G28882A|G28883C|A29510C\n```\n\nIf you invoke `--aggregate`, the proportion of each change in the whole alignment is written.\n```\n\u276f gofasta snps -r MN908947.fa -q aligned.fasta --aggregate\nSNP,frequency\nC44T,0.250000000\nC241T,0.750000000\nT670G,0.916666667\nC1314T,0.083333333\nC1613A,0.083333333\nC1684T,0.083333333\nC2790T,0.833333333\nC3037T,0.833333333\n...\n```\n\n</details>\n\n<details><summary><b>Amino acid, indel and neutral nucleotide changes</b></summary>\n</br>\n\nIf you provide an annotation, gofasta can also annotate amino acid changes relative to a reference sequence. The annotation can be provided in [genbank flat file format](https://www.ncbi.nlm.nih.gov/Sitemap/samplerecord.html) or [gff version 3 format](https://github.com/The-Sequence-Ontology/Specifications/blob/master/gff3.md). Examples of both for SARS-CoV-2 are available under `resources/` in this repository.\n\nThe two relevant routines are `gofasta variants` (for annotating mutations in alignments in fasta format) and `gofasta sam variants` (for annotating mutations in alignments in sam format). They should give the same output for the same alignment and the same annotation. Multiple sequence alignments in fasta format don't need to be in reference coordinates for `gofasta variants`, but if they aren't, a sequence in the same space as the annotation must be present in the alignment. If the alignment is being read from stdin, this sequence must be the first sequence in the alignment, but doesn't have to be if the file is being read from disk. The reference sequence in fasta format needs to be provided to `gofasta sam variants` unless it is present in your annotation. As usual, run either command with the `-h` flag for example command lines and detailed help.\n\nFor a genbank format annotation, the annotation will be parsed such that the genome is split into protein-coding regions based on CDS features, and intergenic regions (everything that isn't in CDS). Mutations are then annotated with `ins` (insertion), `del` (deletion), `aa` (amino acid change) or `nuc` (a nucleotide change that isn't in a codon that is represented by an amino acid change) - for the last one these can be in intergenic sequence, or they can be synonymous changes in CDS.\n\ngff format annotation gives you more flexibility for naming amino acid changes. Currently, the annotation will be parsed such that the genome is split into protein-coding regions based on feature lines whose `type` (in column 3) is either `CDS` or `mature_protein_region_of_CDS`, and intergenic regions (everything else). For the purposes of annotating amino acids, `CDS` or `mature_protein_region_of_CDS` feature lines that have a `Name=something` tag,value pair in the attributes column (column 9) will be represented in the output. Thus you can define regions as protein-coding using a `CDS` feature line (for example orf1a in SARS-CoV-2) but annotate amino acid changes in its constituent protein products using `mature_protein_region_of_CDS` feature lines with `Name=` attributes. [See the example](https://github.com/virus-evolution/gofasta/blob/master/resources/sarscov2-reduced.gff)\n\nExamples of the output formats:\n\n\tins:2028:3 - a 3-base insertion immediately after (1-based) position 2028 in reference coordinates\n\tdel:11288:9 - a 9-base deletion whose first missing nucleotide is at (1-based) position 11288 in reference coordinates\n\taa:S:D614G - the amino acid at (1-based) residue 614 in the S gene is a D in the reference and a G in this sequence\n\taa:nsp12:P323L - the amino acid at (1-based) residue 323 in the rdrp gene is a P in the reference and an L in this sequence\n\tnuc:C3037T - the nucleotide at (1-based) position 3037 in reference coordinates is a C in the reference and a T in this sequence\n\nAs with `gofasta snps` the default mode writes a csv with one line per query sequence, and each sequence's mutations in the second column. Use `--aggregate` to get the overall frequencies of mutations in the alignment(s).\n\nSo, for example, you can find the frequencies of all the amino acid changes at residue 681 in the Spike gene, and the nucleotide changes underlying them, from the sample of SARS-CoV-2 sequences in `aligned.fasta` like:\n\n```\n\u276f gofasta variants --msa aligned.fasta --annotation MN908947.gb --aggregate --append-snps | grep \"^aa:S:P681\"\naa:S:P681H(nuc:C23604A),0.004000000\naa:S:P681R(nuc:C23604G),0.983000000\n```\n\nor find which sequences have `P681H`:\n```\n\u276f gofasta variants --msa aligned.fasta --annotation MN908947.gb | grep \"S:P681H\" | cut -d, -f1\nCOGUK/PHEC-XXXX107/PHEC\nCOGUK/PHEC-XXXX003/PHEC\nCOGUK/PHEC-XXXX996/PHEC\nCOGUK/PHEC-XXXX544/PHEC\n```\n\n</details>\n"
      },
      "source": "https://raw.githubusercontent.com/virus-evolution/gofasta/master/README.md",
      "technique": "header_analysis"
    }
  ]
}