{
  "application_domain": [
    {
      "confidence": 29.39,
      "result": {
        "type": "String",
        "value": "Computer Vision"
      },
      "technique": "supervised_classification"
    }
  ],
  "citation": [
    {
      "confidence": 1,
      "result": {
        "format": "bibtex",
        "type": "File_dump",
        "value": "citHeader(\"To cite BANKSY in publications use:\")\n\ncitEntry(\n  entry    = \"Article\",\n  title    = \"BANKSY: A Spatial Omics Algorithm that Unifies Cell Typing and Tissue Domain Segmentation\",\n  author   = personList(\n                as.person(\"Vipul Singhal\"),\n                as.person(\"Nigel Chou\"),\n                as.person(\"Joseph Lee\"),\n                as.person(\"Jinyue Liu\"),\n                as.person(\"Wan Kee Chock\"),\n                as.person(\"Li Lin\"),\n                as.person(\"Yun-Ching Chang\"),\n                as.person(\"Erica Teo\"),\n                as.person(\"Hwee Kuan Lee\"),\n                as.person(\"Kok Hao Chen\"),\n                as.person(\"Shyam Prabhakar\")),\n  journal  = \"bioRxiv\",\n  year     = 2022,\n  url      = \"https://www.biorxiv.org/content/10.1101/2022.04.14.488259\",\n  textVersion = paste(\n    \"Singhal, V., Chou, N., et al.\",\n    \"BANKSY: A Spatial Omics Algorithm that Unifies Cell Typing and Tissue Domain Segmentation\",\n    \"Preprint at bioRxiv https://doi.org/10.1101/2022.04.14.488259 (2022)\"\n  )\n)\n"
      },
      "source": "https://raw.githubusercontent.com/prabhakarlab/Banksy/bioc/inst/CITATION",
      "technique": "file_exploration"
    }
  ],
  "code_repository": [
    {
      "confidence": 1,
      "result": {
        "type": "Url",
        "value": "https://github.com/prabhakarlab/Banksy"
      },
      "technique": "GitHub_API"
    }
  ],
  "date_created": [
    {
      "confidence": 1,
      "result": {
        "type": "Date",
        "value": "2021-05-23T21:13:04Z"
      },
      "technique": "GitHub_API"
    }
  ],
  "date_updated": [
    {
      "confidence": 1,
      "result": {
        "type": "Date",
        "value": "2024-09-29T13:07:15Z"
      },
      "technique": "GitHub_API"
    }
  ],
  "description": [
    {
      "confidence": 1,
      "result": {
        "type": "String",
        "value": "BANKSY: spatial clustering"
      },
      "technique": "GitHub_API"
    },
    {
      "confidence": 0.9530374491272589,
      "result": {
        "original_header": "Overview",
        "type": "Text_excerpt",
        "value": "BANKSY is a method for clustering spatial omics data by augmenting the\nfeatures of each cell with both an average of the features of its\nspatial neighbors along with neighborhood feature gradients. By\nincorporating neighborhood information for clustering, BANKSY is able to \n- improve cell-type assignment in noisy data\n- distinguish subtly different cell-types stratified by microenvironment\n- identify spatial domains sharing the same microenvironment \nBANKSY is applicable to a wide array of spatial technologies (e.g.\u00a010x\nVisium, Slide-seq, MERFISH, CosMX, CODEX) and scales well to large\ndatasets. For more details, check out: \n- the [paper](https://www.nature.com/articles/s41588-024-01664-3),\n- the [peer review\n  file](https://static-content.springer.com/esm/art%3A10.1038%2Fs41588-024-01664-3/MediaObjects/41588_2024_1664_MOESM3_ESM.pdf),\n- a\n  [tweetorial](https://x.com/shyam_lab/status/1762648072360792479?s=20)\n  on BANKSY,\n- a set of [vignettes](https://prabhakarlab.github.io/Banksy) showing\n  basic usage,\n- usage compatibility with Seurat\n  ([here](https://github.com/satijalab/seurat-wrappers/blob/master/docs/banksy.md)\n  and\n  [here](https://satijalab.org/seurat/articles/visiumhd_analysis_vignette#identifying-spatially-defined-tissue-domains)),\n- a [Python version](https://github.com/prabhakarlab/Banksy_py) of this\n  package,\n- a [Zenodo archive](https://zenodo.org/records/10258795) containing\n  scripts to reproduce the analyses in the paper, and the corresponding\n  [GitHub Pages](https://github.com/jleechung/banksy-zenodo) (and\n  [here](https://github.com/prabhakarlab/Banksy_py/tree/Banksy_manuscript)\n  for analyses done in Python).\n \n"
      },
      "source": "https://raw.githubusercontent.com/prabhakarlab/Banksy/bioc/README.Rmd",
      "technique": "supervised_classification"
    }
  ],
  "documentation": [
    {
      "confidence": 1,
      "result": {
        "type": "Url",
        "value": "https://github.com/prabhakarlab/Banksy/tree/bioc/docs"
      },
      "technique": "file_exploration"
    },
    {
      "confidence": 1,
      "result": {
        "format": "wiki",
        "type": "Url",
        "value": "https://github.com/prabhakarlab/Banksy/wiki"
      },
      "source": "https://raw.githubusercontent.com/prabhakarlab/Banksy/bioc/README.Rmd",
      "technique": "regular_expression"
    }
  ],
  "download_url": [
    {
      "confidence": 1,
      "result": {
        "type": "Url",
        "value": "https://github.com/prabhakarlab/Banksy/releases"
      },
      "technique": "GitHub_API"
    }
  ],
  "forks_count": [
    {
      "confidence": 1,
      "result": {
        "type": "Number",
        "value": 12
      },
      "technique": "GitHub_API"
    }
  ],
  "forks_url": [
    {
      "confidence": 1,
      "result": {
        "type": "Url",
        "value": "https://api.github.com/repos/prabhakarlab/Banksy/forks"
      },
      "technique": "GitHub_API"
    }
  ],
  "full_name": [
    {
      "confidence": 1,
      "result": {
        "type": "String",
        "value": "prabhakarlab/Banksy"
      },
      "technique": "GitHub_API"
    }
  ],
  "full_title": [
    {
      "confidence": 1,
      "result": {
        "type": "String",
        "value": ""
      },
      "source": "https://raw.githubusercontent.com/prabhakarlab/Banksy/bioc/README.Rmd",
      "technique": "regular_expression"
    }
  ],
  "images": [
    {
      "confidence": 1,
      "result": {
        "type": "Url",
        "value": "https://raw.githubusercontent.com/prabhakarlab/Banksy/bioc/man/figures/README-unnamed-chunk-13-1.png"
      },
      "source": "https://raw.githubusercontent.com/prabhakarlab/Banksy/bioc/README.Rmd",
      "technique": "regular_expression"
    },
    {
      "confidence": 1,
      "result": {
        "type": "Url",
        "value": "https://raw.githubusercontent.com/prabhakarlab/Banksy/bioc/man/figures/README-unnamed-chunk-14-1.png"
      },
      "source": "https://raw.githubusercontent.com/prabhakarlab/Banksy/bioc/README.Rmd",
      "technique": "regular_expression"
    },
    {
      "confidence": 1,
      "result": {
        "type": "Url",
        "value": "https://raw.githubusercontent.com/prabhakarlab/Banksy/bioc/man/figures/README-unnamed-chunk-15-1.png"
      },
      "source": "https://raw.githubusercontent.com/prabhakarlab/Banksy/bioc/README.Rmd",
      "technique": "regular_expression"
    }
  ],
  "installation": [
    {
      "confidence": 1,
      "result": {
        "original_header": "Installation",
        "type": "Text_excerpt",
        "value": "The *Banksy* package can be installed via Bioconductor. This currently\nrequires R `>= 4.4.0`.\n\n``` r\nBiocManager::install('Banksy')\n```\n\nTo install directly from GitHub instead, use\n\n``` r\nremotes::install_github(\"prabhakarlab/Banksy\")\n```\n\nTo use the legacy version of *Banksy* utilising the `BanksyObject`\nclass, use\n\n``` r\nremotes::install_github(\"prabhakarlab/Banksy@legacy\")\n```\n\n*Banksy* is also interoperable with\n[*Seurat*](https://satijalab.org/seurat/) via\n[*SeuratWrappers*](https://github.com/satijalab/seurat-wrappers).\nDocumentation on how to run BANKSY on Seurat objects can be found\n[here](https://github.com/satijalab/seurat-wrappers/blob/master/docs/banksy.md).\nFor installation of *SeuratWrappers* with BANKSY version `>= 0.1.6`, run\n\n``` r\nremotes::install_github('satijalab/seurat-wrappers')\n```\n"
      },
      "source": "https://raw.githubusercontent.com/prabhakarlab/Banksy/bioc/README.Rmd",
      "technique": "header_analysis"
    }
  ],
  "issue_tracker": [
    {
      "confidence": 1,
      "result": {
        "type": "Url",
        "value": "https://api.github.com/repos/prabhakarlab/Banksy/issues"
      },
      "technique": "GitHub_API"
    }
  ],
  "keywords": [
    {
      "confidence": 1,
      "result": {
        "type": "String",
        "value": "clustering-algorithm, single-cell-omics, spatial-omics"
      },
      "technique": "GitHub_API"
    }
  ],
  "license": [
    {
      "confidence": 1,
      "result": {
        "name": "Other",
        "spdx_id": "NOASSERTION",
        "type": "License",
        "url": null,
        "value": null
      },
      "technique": "GitHub_API"
    },
    {
      "confidence": 1,
      "result": {
        "type": "File_dump",
        "value": "\nUSER LICENSE for the software suite BANKSY\n\nTLDR (see below for details). \nAcademic usage: MIT License\nCommercial Usage: Restrictions applicable, see below. \n\nAuthorship and Copyright (c) \n2022; Vipul Singhal, Joseph Lee\n\nReferences of associated scientific publications\n1) Singhal, V., Chou, N., Lee, J. et al. BANKSY unifies cell typing and tissue domain segmentation for scalable spatial omics data analysis. Nat Genet 56, 431\u2013441 (2024). https://doi.org/10.1038/s41588-024-01664-3\n\n***\n\nVipul Singhal\nvipul_singhal@gis.a-star.edu.sg\nGenome Institute of Singapore, 60 Biopolis Street, Singapore 138672\n\nJoseph Lee\njoseph.lee@u.nus.edu\nGenome Institute of Singapore, 60 Biopolis Street, Singapore 138672\n\n***\n\nLicense conditions\n\n1. Definitions\n\n\u201cAuthor\u201d refers to the person(s) that hold the authors\u2019 rights or to an organization that has been entitled by them or their employer during the work on the software suite to protect the respective rights and to issue user licenses. \n\n\u201cSoftware\u201d includes all program or database files as well as associated documentation files together with this license document. \n\nThis license refers to the software suite in the title of this document with all its author\u2019s versions. This includes the newest one and any preceding version - be it in \u201csource code form\u201d (the preferred form of the work for making modifications to it) or \u201cobject form\u201d (any compiled/executable version of it). This license covers both the whole software as well as any part of it. It is applicable to the standalone versions of this software as well as its incorporation as integral part into other software packages. \n\n\u201cUser\u201d is the licensee of this software. \n\n2. Copyright notice\n\nAll rights are reserved, whether the whole or part of the software is concerned. The software may not be used or distributed without specific, prior written permission of the author beyond the exceptions described in this license. \n\nThis especially concerns respecting the authors\u2019 rights. The user will always refer to the authors, their publications and this software package when communicating about this software, any of its modifications or about results obtained with this software. \n\nThe copyright messages (if any) will not be modified or suppressed. The software package will always remain associated with this license agreement.\n\n3. Academic (non-commercial) usage: MIT License\n\nCopyright (c) <2022> <Vipul Singhal, Joseph Lee>\n\nPermission is hereby granted, free of charge, to any person obtaining a copy of this software and associated documentation files (the \"Software\"), to deal in the Software without restriction, including without limitation the rights to use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies of the Software, and to permit persons to whom the Software is furnished to do so, subject to the following conditions:\n\nThe above copyright notice and this permission notice shall be included in all copies or substantial portions of the Software.\n\n4. Commercial usage\n\nThe usage of this software in commercial activities is not allowed without a prior written commercial licence agreement issued by the author. \n\nAny software package that contains this software or parts of it can only be commercialized with a license agreement issued by the author. \n\n5. Warranty and liability\n\nTHE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. \nIN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY CLAIM, ANY SPECIAL, INCIDENTAL, INDIRECT OR CONSEQUENTIAL DAMAGES OF ANY KIND, OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING OUT OF OR IN CONNECTION WITH THE USE, PERFORMANCE OF THIS SOFTWARE OR ANY OTHER DEALINGS WITH IT, WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER OR NOT ADVISED OF THE POSSIBILITY OF DAMAGE, AND ON ANY THEORY OF LIABILITY. \n"
      },
      "source": "https://raw.githubusercontent.com/prabhakarlab/Banksy/bioc/LICENSE",
      "technique": "file_exploration"
    }
  ],
  "name": [
    {
      "confidence": 1,
      "result": {
        "type": "String",
        "value": "Banksy"
      },
      "technique": "GitHub_API"
    }
  ],
  "owner": [
    {
      "confidence": 1,
      "result": {
        "type": "User",
        "value": "prabhakarlab"
      },
      "technique": "GitHub_API"
    }
  ],
  "programming_languages": [
    {
      "confidence": 1,
      "result": {
        "name": "R",
        "size": 73670,
        "type": "Programming_language",
        "value": "R"
      },
      "technique": "GitHub_API"
    }
  ],
  "readme_url": [
    {
      "confidence": 1,
      "result": {
        "type": "Url",
        "value": "https://raw.githubusercontent.com/prabhakarlab/Banksy/bioc/README.Rmd"
      },
      "technique": "file_exploration"
    },
    {
      "confidence": 1,
      "result": {
        "type": "Url",
        "value": "https://raw.githubusercontent.com/prabhakarlab/Banksy/bioc/README.md"
      },
      "technique": "file_exploration"
    }
  ],
  "releases": [
    {
      "confidence": 1,
      "result": {
        "author": {
          "name": "jleechung",
          "type": "User"
        },
        "date_created": "2024-02-29T12:22:45Z",
        "date_published": "2024-02-29T12:24:13Z",
        "description": "- Fixed compatibility with SeuratWrappers and bioc versions",
        "html_url": "https://github.com/prabhakarlab/Banksy/releases/tag/v0.1.6",
        "name": "v0.1.6",
        "release_id": 144181709,
        "tag": "v0.1.6",
        "tarball_url": "https://api.github.com/repos/prabhakarlab/Banksy/tarball/v0.1.6",
        "type": "Release",
        "url": "https://api.github.com/repos/prabhakarlab/Banksy/releases/144181709",
        "value": "https://api.github.com/repos/prabhakarlab/Banksy/releases/144181709",
        "zipball_url": "https://api.github.com/repos/prabhakarlab/Banksy/zipball/v0.1.6"
      },
      "technique": "GitHub_API"
    },
    {
      "confidence": 1,
      "result": {
        "author": {
          "name": "jleechung",
          "type": "User"
        },
        "date_created": "2023-09-27T22:16:38Z",
        "date_published": "2023-10-03T22:35:54Z",
        "description": "\r\n- Cluster label smoothing\r\n- Parallelism for clustering using foreach\r\n- Filtering out samples with NAs in their features on initialisation \r\n- Seed setting for clustering\r\n- Version dependency on leidenAlg (>1.1.0) for compatibility with igraph\r\n- Neighborhood-sampling (see arguments `sample_size` and `sample_renorm` for function `ComputeBanksy`)\r\n- Replacing `M` with `compute_agf` and `use_agf` as arguments for specifying which harmonics to compute",
        "html_url": "https://github.com/prabhakarlab/Banksy/releases/tag/v0.1.5",
        "name": "v0.1.5",
        "release_id": 123586800,
        "tag": "v0.1.5",
        "tarball_url": "https://api.github.com/repos/prabhakarlab/Banksy/tarball/v0.1.5",
        "type": "Release",
        "url": "https://api.github.com/repos/prabhakarlab/Banksy/releases/123586800",
        "value": "https://api.github.com/repos/prabhakarlab/Banksy/releases/123586800",
        "zipball_url": "https://api.github.com/repos/prabhakarlab/Banksy/zipball/v0.1.5"
      },
      "technique": "GitHub_API"
    },
    {
      "confidence": 1,
      "result": {
        "author": {
          "name": "jleechung",
          "type": "User"
        },
        "date_created": "2023-07-04T09:16:00Z",
        "date_published": "2023-07-25T09:40:41Z",
        "description": "This release implements azimuthal Gabor filters as additional features of a cell's neighborhood.\r\n\r\n- Azimuthal Gabor filters implemented in `ComputeBanksy`, with the number of harmonics determined by the `M` argument. To obtain similar results as version 0.1.3, use `M=0`\r\n- Default size factor for `NormalizeBanksy` is set to the median total count\r\n- `RunPCA` and `RunUMAP` renamed to `RunBanksyPCA` and `RunBanksyUMAP` respectively to avoid namespace collisions with other packages\r\n- The following argument names have been modified for style:\r\n  - `NormalizeBanksy`: `normFactor` to `norm_factor`\r\n  - `NormalizeBanksy`: `logNorm` to `log_norm`\r\n  - `ComputeBanksy`: `spatialMode` to `spatial_mode`\r\n  - `ComputeBanksy`: `kspatial` to `k_spatial` ",
        "html_url": "https://github.com/prabhakarlab/Banksy/releases/tag/v0.1.4",
        "name": "v0.1.4",
        "release_id": 113462528,
        "tag": "v0.1.4",
        "tarball_url": "https://api.github.com/repos/prabhakarlab/Banksy/tarball/v0.1.4",
        "type": "Release",
        "url": "https://api.github.com/repos/prabhakarlab/Banksy/releases/113462528",
        "value": "https://api.github.com/repos/prabhakarlab/Banksy/releases/113462528",
        "zipball_url": "https://api.github.com/repos/prabhakarlab/Banksy/zipball/v0.1.4"
      },
      "technique": "GitHub_API"
    },
    {
      "confidence": 1,
      "result": {
        "author": {
          "name": "jleechung",
          "type": "User"
        },
        "date_created": "2023-06-06T08:31:27Z",
        "date_published": "2023-06-06T08:33:20Z",
        "description": "Implements minor fixes and updated documentation from release v.0.1.3.",
        "html_url": "https://github.com/prabhakarlab/Banksy/releases/tag/v0.1.3.33",
        "name": "v.0.1.3.33",
        "release_id": 107473922,
        "tag": "v0.1.3.33",
        "tarball_url": "https://api.github.com/repos/prabhakarlab/Banksy/tarball/v0.1.3.33",
        "type": "Release",
        "url": "https://api.github.com/repos/prabhakarlab/Banksy/releases/107473922",
        "value": "https://api.github.com/repos/prabhakarlab/Banksy/releases/107473922",
        "zipball_url": "https://api.github.com/repos/prabhakarlab/Banksy/zipball/v0.1.3.33"
      },
      "technique": "GitHub_API"
    },
    {
      "confidence": 1,
      "result": {
        "author": {
          "name": "jleechung",
          "type": "User"
        },
        "date_created": "2022-04-19T18:35:29Z",
        "date_published": "2022-04-21T11:25:18Z",
        "description": "First public release.\r\n\r\nChanges from v0.0.9:\r\n\r\n- Passing Bioc and R CMD checks\r\n- Implemented: asBanksyObject for interop. with SingleCellExperiment\r\n- Implemented: RunPCA and RunUMAP\r\n- Implemented: plotReduction for generalised plotting\r\n- Implemented: plotARI and getARI for ARI computation and plotting\r\n- Changed: ConnectClusters returns BanksyObject\r\n- Changed: BanksyObject slot `dim.reduction` to `reduction`",
        "html_url": "https://github.com/prabhakarlab/Banksy/releases/tag/v0.1.3",
        "name": "v.0.1.3",
        "release_id": 64948178,
        "tag": "v0.1.3",
        "tarball_url": "https://api.github.com/repos/prabhakarlab/Banksy/tarball/v0.1.3",
        "type": "Release",
        "url": "https://api.github.com/repos/prabhakarlab/Banksy/releases/64948178",
        "value": "https://api.github.com/repos/prabhakarlab/Banksy/releases/64948178",
        "zipball_url": "https://api.github.com/repos/prabhakarlab/Banksy/zipball/v0.1.3"
      },
      "technique": "GitHub_API"
    },
    {
      "confidence": 1,
      "result": {
        "author": {
          "name": "jleechung",
          "type": "User"
        },
        "date_created": "2022-02-13T10:01:46Z",
        "date_published": "2022-02-13T10:17:08Z",
        "description": "Legacy version of BANKSY.\r\n\r\nMain differences between v0.0.9 and v0.1.x:\r\n\r\n- BanksyObject: dimensionality reduction slot name `dim.reduction` (changed to `reduction` in v0.1.x)\r\n- BanksyObject: no `clust.names` method\r\n- Dimensionality reduction steps (PCA / UMAP) included in ClusterBanksy now removed as separate functions in v0.1.x\r\n- Plotting is generalised in v0.1.x (plotReduction instead of plotUMAP / plotPCA)\r\n- ConnectClusters implementation improved in v0.1.x and returns only BanksyObject in v0.1.x (instead of list in v.0.0.9)\r\n- ARI computation and plotting is included in v0.1.x (getARI / plotARI)\r\n- Data moved from `inst/extdata` (v0.0.9) to `/data` (v.0.1.x) ",
        "html_url": "https://github.com/prabhakarlab/Banksy/releases/tag/v0.0.9",
        "name": "v0.0.9",
        "release_id": 59429181,
        "tag": "v0.0.9",
        "tarball_url": "https://api.github.com/repos/prabhakarlab/Banksy/tarball/v0.0.9",
        "type": "Release",
        "url": "https://api.github.com/repos/prabhakarlab/Banksy/releases/59429181",
        "value": "https://api.github.com/repos/prabhakarlab/Banksy/releases/59429181",
        "zipball_url": "https://api.github.com/repos/prabhakarlab/Banksy/zipball/v0.0.9"
      },
      "technique": "GitHub_API"
    }
  ],
  "somef_missing_categories": [
    "acknowledgement",
    "run",
    "download",
    "requirements",
    "contact",
    "contributors",
    "faq",
    "support",
    "identifier",
    "has_build_file",
    "executable_example"
  ],
  "somef_provenance": {
    "date": "2024-10-03 23:12:25",
    "somef_schema_version": "1.0.0",
    "somef_version": "0.9.5"
  },
  "stargazers_count": [
    {
      "confidence": 1,
      "result": {
        "type": "Number",
        "value": 65
      },
      "technique": "GitHub_API"
    }
  ],
  "usage": [
    {
      "confidence": 1,
      "result": {
        "original_header": "Quick start",
        "type": "Text_excerpt",
        "value": "Load *BANKSY*. We\u2019ll also load *SpatialExperiment* and\n*SummarizedExperiment* for containing and manipulating the data,\n*scuttle* for normalization and quality control, and *scater*, *ggplot2*\nand *cowplot* for visualisation.\n\n``` r\nlibrary(Banksy)\n\nlibrary(SummarizedExperiment)\nlibrary(SpatialExperiment)\nlibrary(scuttle)\n\nlibrary(scater)\nlibrary(cowplot)\nlibrary(ggplot2)\n```\n\nHere, we\u2019ll run *BANKSY* on mouse hippocampus data.\n\n``` r\ndata(hippocampus)\ngcm <- hippocampus$expression\nlocs <- as.matrix(hippocampus$locations)\n```\n\nInitialize a SpatialExperiment object and perform basic quality control\nand normalization.\n\n``` r\nse <- SpatialExperiment(assay = list(counts = gcm), spatialCoords = locs)\n\n# QC based on total counts\nqcstats <- perCellQCMetrics(se)\nthres <- quantile(qcstats$total, c(0.05, 0.98))\nkeep <- (qcstats$total > thres[1]) & (qcstats$total < thres[2])\nse <- se[, keep]\n\n# Normalization to mean library size\nse <- computeLibraryFactors(se)\naname <- \"normcounts\"\nassay(se, aname) <- normalizeCounts(se, log = FALSE)\n```\n\nCompute the neighborhood matrices for *BANKSY*. Setting\n`compute_agf=TRUE` computes both the weighted neighborhood mean\n($\\mathcal{M}$) and the azimuthal Gabor filter ($\\mathcal{G}$). The\nnumber of spatial neighbors used to compute $\\mathcal{M}$ and\n$\\mathcal{G}$ are `k_geom[1]=15` and `k_geom[2]=30` respectively. We run\n*BANKSY* at `lambda=0` corresponding to non-spatial clustering, and\n`lambda=0.2` corresponding to *BANKSY* for cell-typing.\n\n> **An important note about choosing the `lambda` parameter for the\n> older [Visium v1 / v2 55um\n> datasets](https://doi.org/10.1038/s41593-020-00787-0) or the original\n> [ST 100um technology](https://doi.org/10.1038/s41596-018-0045-2):**\n>\n> For most modern high resolution technologies like Xenium, Visium HD,\n> StereoSeq, MERFISH, STARmap PLUS, SeqFISH+, SlideSeq v2, and CosMx\n> (and others), we recommend the usual defults for `lambda`: For cell\n> typing, use `lambda = 0.2` (as shown below, or in [this\n> vignette](https://prabhakarlab.github.io/Banksy/articles/parameter-selection.html))\n> and for [domain\n> segmentation](https://prabhakarlab.github.io/Banksy/articles/domain-segment.html),\n> use `lambda = 0.8`. These technologies are either imaging based,\n> having true single-cell resolution (e.g., MERFISH), or are sequencing\n> based, having barcoded spots on the scale of single-cells (e.g.,\n> [Visium\n> HD](https://www.10xgenomics.com/products/visium-hd-spatial-gene-expression)).\n> We find that the usual defaults work well at this measurement\n> resolution.\n>\n> However, for the older **Visium v1/v2** or **ST** technologies, with\n> their much lower resolution spots (55um and 100um diameter,\n> respectively), we find that `lambda = 0.2` seems to work best for\n> domain segmentation. This could be because each spot already measures\n> the average transcriptome of several cells in a neighbourhood. It\n> seems that `lambda = 0.2` shares enough information between these\n> neighbourhoods to lead to good domain segmentation performance. For\n> example, in the [human DLPFC\n> vignette](https://prabhakarlab.github.io/Banksy/articles/multi-sample.html),\n> we use `lambda = 0.2` on a Visium v1/v2 dataset. Also note that in\n> these lower resolution technologies, each spot can have multiple cells\n> of different types, and as such *cell-typing* is not defined for them.\n\n``` r\nlambda <- c(0, 0.2)\nk_geom <- c(15, 30)\n\nse <- Banksy::computeBanksy(se, assay_name = aname, compute_agf = TRUE, k_geom = k_geom)\n#> Computing neighbors...\n#> Spatial mode is kNN_median\n#> Parameters: k_geom=15\n#> Done\n#> Computing neighbors...\n#> Spatial mode is kNN_median\n#> Parameters: k_geom=30\n#> Done\n#> Computing harmonic m = 0\n#> Using 15 neighbors\n#> Done\n#> Computing harmonic m = 1\n#> Using 30 neighbors\n#> Centering\n#> Done\n```\n\nNext, run PCA on the BANKSY matrix and perform clustering. Setting\n`use_agf=TRUE` uses both $\\mathcal{M}$ and $\\mathcal{G}$ to construct\nthe BANKSY matrix.\n\n``` r\nset.seed(1000)\nse <- Banksy::runBanksyPCA(se, use_agf = TRUE, lambda = lambda)\nse <- Banksy::runBanksyUMAP(se, use_agf = TRUE, lambda = lambda)\nse <- Banksy::clusterBanksy(se, use_agf = TRUE, lambda = lambda, resolution = 1.2)\n```\n\nDifferent clustering runs can be relabeled to minimise their differences\nwith `connectClusters`:\n\n``` r\nse <- Banksy::connectClusters(se)\n#> clust_M1_lam0.2_k50_res1.2 --> clust_M1_lam0_k50_res1.2\n```\n\nVisualise the clustering output for non-spatial clustering (`lambda=0`)\nand BANKSY clustering (`lambda=0.2`).\n\n``` r\ncnames <- colnames(colData(se))\ncnames <- cnames[grep(\"^clust\", cnames)]\ncolData(se) <- cbind(colData(se), spatialCoords(se))\n\nplot_nsp <- plotColData(se,\n    x = \"sdimx\", y = \"sdimy\",\n    point_size = 0.6, colour_by = cnames[1]\n)\nplot_bank <- plotColData(se,\n    x = \"sdimx\", y = \"sdimy\",\n    point_size = 0.6, colour_by = cnames[2]\n)\n\n\nplot_grid(plot_nsp + coord_equal(), plot_bank + coord_equal(), ncol = 2)\n```\n\n<img src=\"man/figures/README-unnamed-chunk-13-1.png\" width=\"100%\" />\n\nFor clarity, we can visualise each of the clusters separately:\n\n``` r\nplot_grid(\n    plot_nsp + facet_wrap(~colour_by),\n    plot_bank + facet_wrap(~colour_by),\n    ncol = 2\n)\n```\n\n<img src=\"man/figures/README-unnamed-chunk-14-1.png\" width=\"100%\" />\n\nVisualize UMAPs of the non-spatial and BANKSY embedding:\n\n``` r\nrdnames <- reducedDimNames(se)\n\numap_nsp <- plotReducedDim(se,\n    dimred = grep(\"UMAP.*lam0$\", rdnames, value = TRUE),\n    colour_by = cnames[1]\n)\numap_bank <- plotReducedDim(se,\n    dimred = grep(\"UMAP.*lam0.2$\", rdnames, value = TRUE),\n    colour_by = cnames[2]\n)\nplot_grid(\n    umap_nsp,\n    umap_bank,\n    ncol = 2\n)\n```\n\n<img src=\"man/figures/README-unnamed-chunk-15-1.png\" width=\"100%\" />\n\n<details>\n<summary>\nRuntime for analysis\n</summary>\n\n    #> Time difference of 35.28841 secs\n\n</details>\n<details>\n<summary>\nSession information\n</summary>\n\n``` r\nsessionInfo()\n#> R version 4.3.2 (2023-10-31)\n#> Platform: aarch64-apple-darwin20 (64-bit)\n#> Running under: macOS Sonoma 14.2.1\n#> \n#> Matrix products: default\n#> BLAS:   /Library/Frameworks/R.framework/Versions/4.3-arm64/Resources/lib/libRblas.0.dylib \n#> LAPACK: /Library/Frameworks/R.framework/Versions/4.3-arm64/Resources/lib/libRlapack.dylib;  LAPACK version 3.11.0\n#> \n#> locale:\n#> [1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8\n#> \n#> time zone: America/Detroit\n#> tzcode source: internal\n#> \n#> attached base packages:\n#> [1] stats4    stats     graphics  grDevices utils     datasets  methods  \n#> [8] base     \n#> \n#> other attached packages:\n#>  [1] cowplot_1.1.3               scater_1.30.1              \n#>  [3] ggplot2_3.4.4               scuttle_1.12.0             \n#>  [5] SpatialExperiment_1.12.0    SingleCellExperiment_1.24.0\n#>  [7] SummarizedExperiment_1.32.0 Biobase_2.62.0             \n#>  [9] GenomicRanges_1.54.1        GenomeInfoDb_1.38.6        \n#> [11] IRanges_2.36.0              S4Vectors_0.40.2           \n#> [13] BiocGenerics_0.48.1         MatrixGenerics_1.14.0      \n#> [15] matrixStats_1.2.0           Banksy_0.99.12             \n#> \n#> loaded via a namespace (and not attached):\n#>  [1] tidyselect_1.2.0          viridisLite_0.4.2        \n#>  [3] farver_2.1.1              dplyr_1.1.4              \n#>  [5] vipor_0.4.7               viridis_0.6.5            \n#>  [7] bitops_1.0-7              fastmap_1.1.1            \n#>  [9] RCurl_1.98-1.14           digest_0.6.34            \n#> [11] rsvd_1.0.5                lifecycle_1.0.4          \n#> [13] magrittr_2.0.3            dbscan_1.1-12            \n#> [15] compiler_4.3.2            rlang_1.1.3              \n#> [17] tools_4.3.2               igraph_2.0.1.1           \n#> [19] utf8_1.2.4                yaml_2.3.8               \n#> [21] data.table_1.15.0         knitr_1.45               \n#> [23] labeling_0.4.3            S4Arrays_1.2.0           \n#> [25] mclust_6.0.1              DelayedArray_0.28.0      \n#> [27] abind_1.4-5               BiocParallel_1.36.0      \n#> [29] withr_3.0.0               grid_4.3.2               \n#> [31] fansi_1.0.6               beachmat_2.18.0          \n#> [33] colorspace_2.1-0          aricode_1.0.3            \n#> [35] scales_1.3.0              cli_3.6.2                \n#> [37] rmarkdown_2.25            crayon_1.5.2             \n#> [39] leidenAlg_1.1.2           generics_0.1.3           \n#> [41] rstudioapi_0.15.0         rjson_0.2.21             \n#> [43] DelayedMatrixStats_1.24.0 ggbeeswarm_0.7.2         \n#> [45] RcppHungarian_0.3         zlibbioc_1.48.0          \n#> [47] parallel_4.3.2            XVector_0.42.0           \n#> [49] vctrs_0.6.5               Matrix_1.6-5             \n#> [51] BiocSingular_1.18.0       BiocNeighbors_1.20.2     \n#> [53] ggrepel_0.9.5             irlba_2.3.5.1            \n#> [55] beeswarm_0.4.0            magick_2.8.2             \n#> [57] glue_1.7.0                codetools_0.2-19         \n#> [59] uwot_0.1.16               RcppAnnoy_0.0.22         \n#> [61] gtable_0.3.4              ScaledMatrix_1.10.0      \n#> [63] munsell_0.5.0             tibble_3.2.1             \n#> [65] pillar_1.9.0              htmltools_0.5.7          \n#> [67] GenomeInfoDbData_1.2.11   R6_2.5.1                 \n#> [69] sparseMatrixStats_1.14.0  evaluate_0.23            \n#> [71] sccore_1.0.4              lattice_0.22-5           \n#> [73] highr_0.10                Rcpp_1.0.12              \n#> [75] gridExtra_2.3             SparseArray_1.2.4        \n#> [77] xfun_0.42                 pkgconfig_2.0.3\n```\n\n</details>\n"
      },
      "source": "https://raw.githubusercontent.com/prabhakarlab/Banksy/bioc/README.Rmd",
      "technique": "header_analysis"
    }
  ]
}