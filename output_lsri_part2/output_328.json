{
  "citation": [
    {
      "confidence": 1,
      "result": {
        "original_header": "References",
        "parent_header": [
          "bayroot: a Bayesian approach to root-to-tip regression",
          "Usage"
        ],
        "type": "Text_excerpt",
        "value": "* Rambaut, A., Lam, T. T., Max Carvalho, L., & Pybus, O. G. (2016). Exploring the temporal structure of heterochronous sequences using TempEst (formerly Path-O-Gen). Virus evolution, 2(1), vew007.\n* Russell, C. A., Jones, T. C., Barr, I. G., Cox, N. J., Garten, R. J., Gregory, V., ... & Smith, D. J. (2008). The global circulation of seasonal influenza A (H3N2) viruses. Science, 320(5874), 340-346.\n"
      },
      "source": "https://raw.githubusercontent.com/PoonLab/bayroot/main/README.md",
      "technique": "header_analysis"
    }
  ],
  "code_repository": [
    {
      "confidence": 1,
      "result": {
        "type": "Url",
        "value": "https://github.com/PoonLab/bayroot"
      },
      "technique": "GitHub_API"
    }
  ],
  "date_created": [
    {
      "confidence": 1,
      "result": {
        "type": "Date",
        "value": "2021-10-28T04:31:22Z"
      },
      "technique": "GitHub_API"
    }
  ],
  "date_updated": [
    {
      "confidence": 1,
      "result": {
        "type": "Date",
        "value": "2024-02-10T14:47:17Z"
      },
      "technique": "GitHub_API"
    }
  ],
  "description": [
    {
      "confidence": 1,
      "result": {
        "type": "String",
        "value": "Bayesian root-to-tip regression for dating reservoir sequences"
      },
      "technique": "GitHub_API"
    },
    {
      "confidence": 1,
      "result": {
        "original_header": "Description",
        "parent_header": [
          "bayroot: a Bayesian approach to root-to-tip regression"
        ],
        "type": "Text_excerpt",
        "value": "Root-to-tip regression (RTT) makes use of the [molecular clock](https://en.wikipedia.org/wiki/Molecular_clock) assumption that the rate of evolution is roughly constant over time.  Starting with a phylogenetic tree relating genetic sequences that have been observed at different points in time, this method regresses the divergence of each sequence from an inferred common ancestor at the root of the tree against the time of sampling.  If the molecular clock assumption holds, then we expect to see a linear increase in divergence over time.  The standard approach to fitting this linear model is to minimize a cost function such as least squares or [R-squared](https://en.wikipedia.org/wiki/Coefficient_of_determination) (Rambaut *et al* 2016).\n\nA more complex approach to this problem is to use Bayesian methods to sample trees from the posterior distribution defined by the sequences, sampling dates, model of evolution, and prior belief.  However, there are applications where a full Bayesian treatment may be difficult to compute, such as for large numbers of sequences, or when many sequences have unknown sampling dates to be estimated.  Therefore we developed `bayroot` to provide a solution that is intermediate between these two extremes.\n\n"
      },
      "source": "https://raw.githubusercontent.com/PoonLab/bayroot/main/README.md",
      "technique": "header_analysis"
    },
    {
      "confidence": 0.9842168654327473,
      "result": {
        "original_header": "bayroot: a Bayesian approach to root-to-tip regression",
        "type": "Text_excerpt",
        "value": "`bayroot` is a simple R package that provides functions for a Bayesian approach to root-to-tip regression.\n \n"
      },
      "source": "https://raw.githubusercontent.com/PoonLab/bayroot/main/README.md",
      "technique": "supervised_classification"
    }
  ],
  "download_url": [
    {
      "confidence": 1,
      "result": {
        "type": "Url",
        "value": "https://github.com/PoonLab/bayroot/releases"
      },
      "technique": "GitHub_API"
    }
  ],
  "forks_count": [
    {
      "confidence": 1,
      "result": {
        "type": "Number",
        "value": 3
      },
      "technique": "GitHub_API"
    }
  ],
  "forks_url": [
    {
      "confidence": 1,
      "result": {
        "type": "Url",
        "value": "https://api.github.com/repos/PoonLab/bayroot/forks"
      },
      "technique": "GitHub_API"
    }
  ],
  "full_name": [
    {
      "confidence": 1,
      "result": {
        "type": "String",
        "value": "PoonLab/bayroot"
      },
      "technique": "GitHub_API"
    }
  ],
  "full_title": [
    {
      "confidence": 1,
      "result": {
        "type": "String",
        "value": "bayroot: a Bayesian approach to root-to-tip regression"
      },
      "source": "https://raw.githubusercontent.com/PoonLab/bayroot/main/README.md",
      "technique": "regular_expression"
    }
  ],
  "images": [
    {
      "confidence": 1,
      "result": {
        "type": "Url",
        "value": "https://user-images.githubusercontent.com/1109328/174401842-535dda29-2c62-42db-9cf0-de556dd9acd3.png"
      },
      "source": "https://raw.githubusercontent.com/PoonLab/bayroot/main/README.md",
      "technique": "regular_expression"
    },
    {
      "confidence": 1,
      "result": {
        "type": "Url",
        "value": "https://user-images.githubusercontent.com/1109328/174401648-b6691a29-65fc-4104-9b37-a7e75dd1bf04.png"
      },
      "source": "https://raw.githubusercontent.com/PoonLab/bayroot/main/README.md",
      "technique": "regular_expression"
    },
    {
      "confidence": 1,
      "result": {
        "type": "Url",
        "value": "https://user-images.githubusercontent.com/1109328/174401959-6c7d857e-6189-4574-bb64-c6887f6978ba.png"
      },
      "source": "https://raw.githubusercontent.com/PoonLab/bayroot/main/README.md",
      "technique": "regular_expression"
    },
    {
      "confidence": 1,
      "result": {
        "type": "Url",
        "value": "https://user-images.githubusercontent.com/1109328/174402219-072167a9-ee2d-4baa-938e-8214abf6db6d.png"
      },
      "source": "https://raw.githubusercontent.com/PoonLab/bayroot/main/README.md",
      "technique": "regular_expression"
    },
    {
      "confidence": 1,
      "result": {
        "type": "Url",
        "value": "https://user-images.githubusercontent.com/1109328/189016258-186c1117-5821-450e-ab12-e0f9cf98cf19.png"
      },
      "source": "https://raw.githubusercontent.com/PoonLab/bayroot/main/README.md",
      "technique": "regular_expression"
    },
    {
      "confidence": 1,
      "result": {
        "type": "Url",
        "value": "https://user-images.githubusercontent.com/1109328/189016331-01a1bfa8-c086-4b86-a455-60f1ad13aa11.png"
      },
      "source": "https://raw.githubusercontent.com/PoonLab/bayroot/main/README.md",
      "technique": "regular_expression"
    }
  ],
  "issue_tracker": [
    {
      "confidence": 1,
      "result": {
        "type": "Url",
        "value": "https://api.github.com/repos/PoonLab/bayroot/issues"
      },
      "technique": "GitHub_API"
    }
  ],
  "keywords": [
    {
      "confidence": 1,
      "result": {
        "type": "String",
        "value": ""
      },
      "technique": "GitHub_API"
    }
  ],
  "license": [
    {
      "confidence": 1,
      "result": {
        "name": "MIT License",
        "spdx_id": "MIT",
        "type": "License",
        "url": "https://api.github.com/licenses/mit",
        "value": "https://api.github.com/licenses/mit"
      },
      "technique": "GitHub_API"
    },
    {
      "confidence": 1,
      "result": {
        "type": "File_dump",
        "value": "MIT License\n\nCopyright (c) 2022 PoonLab\n\nPermission is hereby granted, free of charge, to any person obtaining a copy\nof this software and associated documentation files (the \"Software\"), to deal\nin the Software without restriction, including without limitation the rights\nto use, copy, modify, merge, publish, distribute, sublicense, and/or sell\ncopies of the Software, and to permit persons to whom the Software is\nfurnished to do so, subject to the following conditions:\n\nThe above copyright notice and this permission notice shall be included in all\ncopies or substantial portions of the Software.\n\nTHE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\nIMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\nFITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\nAUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\nLIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\nOUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE\nSOFTWARE.\n"
      },
      "source": "https://raw.githubusercontent.com/PoonLab/bayroot/main/LICENSE",
      "technique": "file_exploration"
    }
  ],
  "name": [
    {
      "confidence": 1,
      "result": {
        "type": "String",
        "value": "bayroot"
      },
      "technique": "GitHub_API"
    }
  ],
  "owner": [
    {
      "confidence": 1,
      "result": {
        "type": "Organization",
        "value": "PoonLab"
      },
      "technique": "GitHub_API"
    }
  ],
  "programming_languages": [
    {
      "confidence": 1,
      "result": {
        "name": "R",
        "size": 27295,
        "type": "Programming_language",
        "value": "R"
      },
      "technique": "GitHub_API"
    },
    {
      "confidence": 1,
      "result": {
        "name": "Python",
        "size": 4730,
        "type": "Programming_language",
        "value": "Python"
      },
      "technique": "GitHub_API"
    }
  ],
  "readme_url": [
    {
      "confidence": 1,
      "result": {
        "type": "Url",
        "value": "https://raw.githubusercontent.com/PoonLab/bayroot/main/README.md"
      },
      "technique": "file_exploration"
    }
  ],
  "requirements": [
    {
      "confidence": 1,
      "result": {
        "original_header": "Dependencies",
        "parent_header": [
          "bayroot: a Bayesian approach to root-to-tip regression"
        ],
        "type": "Text_excerpt",
        "value": "`bayroot` was developed in R version 3.6.2.  It requires the following packages:\n* [phytools](https://github.com/liamrevell/phytools) for the `reroot` function\n* [msm](https://cran.r-project.org/web/packages/msm/index.html) for the truncated normal distribution function (`rtnorm`)\n* [ggfree](https://github.com/ArtPoon/ggfree) for analyzing and plotting trees\n* [chemCal](https://cran.r-project.org/web/packages/chemCal/index.html) for `inverse.predict` function\n* [twt](https://github.com/PoonLab/twt) (*optional*, for simulating test data)\n\n"
      },
      "source": "https://raw.githubusercontent.com/PoonLab/bayroot/main/README.md",
      "technique": "header_analysis"
    }
  ],
  "somef_missing_categories": [
    "installation",
    "acknowledgement",
    "run",
    "download",
    "contact",
    "contributors",
    "documentation",
    "faq",
    "support",
    "identifier",
    "has_build_file",
    "executable_example"
  ],
  "somef_provenance": {
    "date": "2024-10-04 10:14:03",
    "somef_schema_version": "1.0.0",
    "somef_version": "0.9.5"
  },
  "stargazers_count": [
    {
      "confidence": 1,
      "result": {
        "type": "Number",
        "value": 5
      },
      "technique": "GitHub_API"
    }
  ],
  "usage": [
    {
      "confidence": 1,
      "result": {
        "original_header": "Fitting a root-to-tip regression",
        "parent_header": [
          "bayroot: a Bayesian approach to root-to-tip regression",
          "Usage"
        ],
        "type": "Text_excerpt",
        "value": "```R\n# load example tree (101 influenza HA sequences from 2001-2006) from Russell et al. 2008)\nphy <- read.tree(\"data/h3n2.nwk\")\n\n# first show root-to-tip regression using ape::rtt\ntip.dates <- get.dates(phy, format=\"%d-%b-%Y\")\nrooted <- rtt(phy, as.integer(tip.dates))\ndiv <- node.depth.edgelength(rooted)[1:Ntip(rooted)]\nplot(tip.dates, div, xlim=c(as.Date(\"1999-01-01\"), max(tip.dates)), \n     ylim=c(0, max(div)))\nabline(lm(div ~ tip.dates))\n```\n<img src=\"https://user-images.githubusercontent.com/1109328/174401842-535dda29-2c62-42db-9cf0-de556dd9acd3.png\" width=\"400px\"/>\n\n\n```R\n# now carry out Bayesian sampling, using the RTT tree to initialize the chain\nsettings <- list(seq.len=987, format=\"%d-%b-%Y\", \n                 mindate=as.Date(\"1995-01-01\"), maxdate=as.Date(\"2000-01-01\"),\n                 meanlog=-5, sdlog=2,\n                 root.delta=0.03, date.sd=60, rate.delta=0.002)\nparams <- list(phy=rooted, rate=0.01, origin=as.Date(\"1995-01-01\"))\nres <- bayroot(nstep=1e5, skip=100, params=params, settings=settings, echo=T)  # about 8 minutes\nplot(res, burnin=100)  # calls a generic S3 method\n```\n<img src=\"https://user-images.githubusercontent.com/1109328/174401648-b6691a29-65fc-4104-9b37-a7e75dd1bf04.png\" width=\"600px\"/>\n\n\n```R\n# since we can't make a trace log of trees, bayroot provides a plotting option for viewing a specific step in the chain sample\nplot(res, settings, step=1000)\n```\n<img src=\"https://user-images.githubusercontent.com/1109328/174401959-6c7d857e-6189-4574-bb64-c6887f6978ba.png\" width=\"600px\"/>\n\n```R\n# another way of looking at the MCMC results\nplot(tip.dates, div, xlim=c(as.Date(\"1999-01-01\"), max(tip.dates)), \n      ylim=c(0, max(div)), type='n')\nabline(fit)\nfor (i in seq(100, nrow(res$log), length.out=100)) {\n  row <- res$log[i,]\n  clock <- row$rate / settings$seq.len\n  segments(\n    x0=row$origin, x1=max(tip.dates), \n    y0=0, y1=clock*as.integer(max(tip.dates)-row$origin),\n    col=rgb(0,0,1,0.2)\n  )\n}\npoints(tip.dates, div, pch=21, cex=1, bg='white')\n```\n<img src=\"https://user-images.githubusercontent.com/1109328/174402219-072167a9-ee2d-4baa-938e-8214abf6db6d.png\" width=\"400px\"/>\n"
      },
      "source": "https://raw.githubusercontent.com/PoonLab/bayroot/main/README.md",
      "technique": "header_analysis"
    },
    {
      "confidence": 1,
      "result": {
        "original_header": "Estimating unknown tip dates",
        "parent_header": [
          "bayroot: a Bayesian approach to root-to-tip regression",
          "Usage"
        ],
        "type": "Text_excerpt",
        "value": "*bayroot* was actually developed for our study of the latent HIV reservoir.  HIV converts its RNA genome into DNA and then integrates that DNA into the host genome.  In a small number of host cells, that HIV DNA can remain dormant for years until the cell becomes \"reactivated\" and starts to produce new virus copies.  We are interested in reconstructing *when* copies of HIV in this latent reservoir became integrated.\n\nSince the HIV DNA basically stops evolving upon integration, this problem is equivalent to imputing missing dates on some tips of a time-scaled tree.  A Bayesian approach is well-suited to this problem!  We implemented a compartmental model in the R package [twt](https://github.com/PoonLab/twt) to simulate trees relating a mixture of actively evolving HIV RNA and integrated HIV DNA.  Let's reconstruct the integration dates for one of these simulations.\n\nFirst, we'll load the *bayroot* functions and a couple of packages, and then import the simulated data.\nWe wrote some utility functions that were designed to operate on files containing only one tree and integration times for one replicate, but we didn't want to upload hundreds of these files to the repository.  Instead we're going to extract one replicate and generate the expected file formats:\n```R\nsource(\"bayroot.R\")\nrequire(ape)\nrequire(lubridate)\n\n# 50 trees generated from a simulation of cell dynamics\ntrees <- read.tree(\"data/testdata-latent2.nwk\")\ntimes <- read.csv(\"data/testdata-latent2.csv\")\n\n# export one of the replicates to new files\nrep <- 1\ntf <- \"data/example.nwk\"\nwrite.tree(trees[[rep]], file=tf)\n\ncf <- \"data/example.csv\"\nint.times <- times$int.time[times$rep==rep]\nnames(int.times) <- times$sample[times$rep==rep]\nwrite.csv(as.data.frame(int.times), file=cf)\n```\n\nNext, we'll configure our analysis:\n```R\nphy <- read.tree(tf)\nsettings <- list(\n  seq.len=1233,  # AY772699\n  format=\"%Y-%m-%d\",\n  # we arbitrarily assigned 2000-01-01 as the actual origin date\n  mindate=as.Date(\"1999-12-01\"),  # one month before origin\n  maxdate=as.Date(\"2000-02-01\"),  # one month after origin\n  meanlog=-5, sdlog=2,  # hyperparameters for lognormal prior on rate\n  root.delta=0.01,  # proposal on root location\n  date.sd=10,  # days, origin proposal\n  rate.delta=0.01,  # proposal on clock rate\n  censored = phy$tip.label[grepl(\"^Latent\", phy$tip.label)]\n)\n```\n\nThis utility function will initialize the model parameters and then run a chain sample for 20,000 steps, only keeping every 20th step.\nIf you want to see the chain being updated in real time, you can add an argument `echo=TRUE` - note this will generate a lot of console output!\nOtherwise just wait a couple of minutes for the chain sample to complete.\n```R\nsource(\"scripts/validate.R\")  # loads package chemCal\nset.seed(1)  # make this reproducible\nres <- fit.bayroot(tf, cf, settings=settings, nstep=2e4, skip=20, \n                   max.date=as.Date(\"2001-04-01\"))\n```\nNote we set the maximum integration date to the above date because ART was initiated 15 months post-infection in this set of simulations.\n\nHere I'm displaying the contents of the list returned from `fit.bayroot`:\n```\n> summary(res)\n           Length Class   Mode   \nphy         5     phylo   list   \npred.dates 10     -none-  list   \ntip.dates  40     Date    numeric\ncensored   40     Date    numeric\nchain       2     bayroot list   \n```\n* `phy` is just the original tree\n* `pred.dates` is a list containing data frames of integration date estimates for every censored tip\n* `tip.dates` is a vector of sampling times associated with each tip as Date objects, including censored tips\n* `censored` replaces Date values in `tip.dates` with missing values (`NA`) for censored tips\n* `chain` is a custom [S3](http://adv-r.had.co.nz/S3.html) object of class `bayroot` that contains our chain samples of model parameters and rooted trees from the posterior distribution\n\nIf we call the generic `plot` method on the `bayroot` object, R will display a composite set of plots summarizing the posterior traces of our chain sample.  We'll discard the first 2,000 steps as burnin:\n```R\nplot(res$chain, burnin=100)\n```\n<img src=\"https://user-images.githubusercontent.com/1109328/189016258-186c1117-5821-450e-ab12-e0f9cf98cf19.png\" width=\"600px\"/>\n\n\nLet's compare our posterior sample of integration dates to standard root-to-tip regression using a couple of utility functions that we've provided in `scripts/validate.R`:\n```R\nrt <- root2tip(phy)\ntrue.vals <- get.true.values(rt, cf)\nest <- get.estimates(res, rt)\n```\nand generate a plot summarizing this comparison:\n```R\npar(mar=c(5,5,1,1))\nplot(rt, true.vals=true.vals, xlab=\"Time since infection\",\n     ylab=\"Divergence\", xlim=c(0, 20), ylim=c(0, max(rt$div)),\n     las=1, cex.axis=0.8)\npoints(est$est, est$div, pch=19, col=rgb(0,0,1,0.5), cex=0.8)\nsegments(x0=est$lo95, x1=est$hi95, y0=est$div, col=rgb(0,0,1,0.3), lwd=5)\nabline(v=15, lty=2)\nlegend(x=0, y=0.035, legend=c(\"RTT\", \"bayroot\", \"true date\"), cex=0.8,\n       col=c('red', 'blue', 'black'), pch=c(19, 19, 3), pt.lwd=2, bty='n')\n```\n<img src=\"https://user-images.githubusercontent.com/1109328/189016331-01a1bfa8-c086-4b86-a455-60f1ad13aa11.png\" width=\"500px\"/>\nNote the open circles represent RNA sequences used to calibrate the molecular clock.\n\n"
      },
      "source": "https://raw.githubusercontent.com/PoonLab/bayroot/main/README.md",
      "technique": "header_analysis"
    }
  ]
}